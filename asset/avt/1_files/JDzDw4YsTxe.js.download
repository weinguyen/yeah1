;/*FB_PKG_DELIM*/

__d("EBMinosWasmVerifySingleEpoch",["EBGetMinosWasm","EBMinosLogger","EBMinosWasm.pb","WACreateWasmFunction","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.getWasmModule;a=a.logger;var c=a.TAGS(["minos-verify-single-epoch"]);function e(a){a=a.valid;return d("WAResultOrError").makeResult({valid:a})}return async function(a){var f=a.epochPublicData;a=a.signature;var g=d("WACreateWasmFunction").createWasmFunction({InputSpec:d("EBMinosWasm.pb").MinosVerifySingleEpochInputSpec,ResultSpec:d("EBMinosWasm.pb").MinosVerifySingleEpochResultSpec,cli:"minos_cli",command:"minos-verify-single-epoch",getWasmModule:b,logger:c,validateResult:e});g=await g({epochPublicData:f,signature:a});return g}}b=a({getWasmModule:d("EBGetMinosWasm").getMinosWasm,logger:d("EBMinosLogger").minosLogger});g.verifySingleEpoch=b}),98);
__d("EBAPIMinosVerifySingleEpoch",["EBMinosLogger","EBMinosTypes","EBMinosWasmVerifySingleEpoch","WALongInt"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Unable to verify epoch - WASM error ",""]);h=function(){return a};return a}async function a(a){var b,c=(b=d("EBMinosTypes")).unsafeCastToEpochNumber(d("WALongInt").decimalStringToLongInt(new TextDecoder().decode(a.minosEpochAnonId))),e=b.unsafeCastToMailboxAuthPK(a.minosMailboxAuthPublicKey),f=b.unsafeCastToMailboxEncryptionPK(a.minosMailboxEncryptionPublicKey),g=b.unsafeCastToMailboxSigningPK(a.minosMailboxSigningPublicKey),i=b.unsafeCastToUserFbId(a.userId);b=b.unsafeCastToEpochSignature(a.selfEpochSignature);c={epochNumber:c,mailboxAuthPk:e,mailboxEncryptionPk:f,mailboxSigningPk:g,previousEpochHead:a.previousEpochHead!=null?d("EBMinosTypes").unsafeCastToEpochHead(a.previousEpochHead):void 0,userFbid:i};e=await d("EBMinosWasmVerifySingleEpoch").verifySingleEpoch({epochPublicData:c,signature:b});if(e.success)return e.value.valid;d("EBMinosLogger").minosLogger.ERROR(h(),e.error);return!1}g.minosVerifySingleEpoch=a}),98);
__d("IEBAPI",["MAWBridge"],(function(a,b,c,d,e,f,g){"use strict";c=1;function a(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWBridge").getBridge().sendAndReceive("backend","ebapi",{args:c,type:a})}}function b(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWBridge").getBridge().sendAndReceive("backend","minosEBAPI",{args:c,type:a})}}g.version=c;g.makeBridgedApi=a;g.makeMinosBridgedApi=b}),98);
__d("EBMinosBridgedAPI",["IEBAPI"],(function(a,b,c,d,e,f,g){"use strict";a={minosVerifySingleEpoch:d("IEBAPI").makeMinosBridgedApi("minosVerifySingleEpoch"),writeMinosMailboxKeysForRecipient:d("IEBAPI").makeMinosBridgedApi("writeMinosMailboxKeysForRecipient")};b=a;g["default"]=b}),98);
__d("EBMinosVerifySingleEpoch",["EBMinosBridgedAPI","I64"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a,b,e,f,g,i,j){a=await c("EBMinosBridgedAPI").minosVerifySingleEpoch({minosEpochAnonId:a,minosMailboxAuthPublicKey:g,minosMailboxEncryptionPublicKey:f,minosMailboxSigningPublicKey:e,previousEpochHead:i,selfEpochSignature:j,userId:(h||(h=d("I64"))).to_string(b)});return Promise.resolve([a])}g.minosVerifySingleEpoch=a}),98);
__d("EBWriteMinosMailboxKeysToCache",["EBMinosBridgedAPI","I64","WALongInt","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a,b,e,f,g,i,j,k,l,m){await c("EBMinosBridgedAPI").writeMinosMailboxKeysForRecipient({id:(h||(h=d("I64"))).to_string(a),minosEncryptionPublicKey:f,minosEpochAnonId:b,minosEpochHead:g,minosEpochHeadCreationTime:e!=null?d("WATimeUtils").castLongIntToUnixTime(d("WALongInt").decimalStringToLongInt((h||(h=d("I64"))).to_string(e))):void 0,minosEpochSignatureSelf:j,minosMailboxAuthPubKey:k,minosMailboxSigningPubKey:l,minosPreviousEpochHead:m,minosPublicKeyFBID:i!=null?(h||(h=d("I64"))).to_string(i):void 0});return Promise.resolve()}g.writeMinosMailboxKeysToCache=a}),98);