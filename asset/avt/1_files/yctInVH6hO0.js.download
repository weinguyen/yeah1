;/*FB_PKG_DELIM*/

__d("LSUpdateTypingIndicator",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.sequence([function(d){return b.i64.neq(a[3],void 0)?c[0]=a[3]:c[0]=b.i64.cast([0,5e3]),a[2]?(c[1]=b.i64.of_float(Date.now()),b.db.table(52).put({threadKey:a[0],senderId:a[1],expirationTimestampMs:b.i64.add(c[1],c[0])})):b.resolve()},function(c){return a[2]?b.resolve():b.forEach(b.filter(b.db.table(52).fetch([[[a[0],a[1]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(c.senderId,a[1])}),function(a){return a["delete"]()})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSTypingUpdateTypingIndicatorStoredProcedure";a.__tables__=["typing_indicator"];e.exports=a}),null);