;/*FB_PKG_DELIM*/

__d("BotFeedbackKind",[],(function(a,b,c,d,e,f){a=Object.freeze({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9,BOT_FEEDBACK_NEGATIVE_PERSONALIZED:10,BOT_FEEDBACK_NEGATIVE_CLARITY:11,BOT_FEEDBACK_NEGATIVE_DOESNT_LOOK_LIKE_THE_PERSON:12,BOT_FEEDBACK_NEGATIVE_HALLUCINATION_INTERNAL_ONLY:13,BOT_FEEDBACK_NEGATIVE:14});f["default"]=a}),66);
__d("DeletionType.react",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Global:0,Local:1});c=a;f["default"]=c}),66);
__d("ExecTimeResolverHooks",["ReactiveExecutorExecTimeResolverTransformer","react-compiler-runtime","react-relay/relay-hooks/loadQuery","react-relay/relay-hooks/useFragment","react-relay/relay-hooks/useLazyLoadQuery","relay-runtime"],(function(a,b,c,d,e,f,g){function a(a,c){var e,f=d("react-compiler-runtime").c(5);e=((e=a.operation)==null?void 0:e.use_exec_time_resolvers)===!1||((e=a.operation)==null?void 0:(e=e.exec_time_resolvers_enabled_provider)==null?void 0:e.get())===!1;var g;f[0]!==e||f[1]!==a?(g=e?a:b("ReactiveExecutorExecTimeResolverTransformer").getTransformedQueryForExecTimeMode(a),f[0]=e,f[1]=a,f[2]=g):g=f[2];a=g;f[3]!==e?(g=e?{}:{fetchPolicy:"store-and-network"},f[3]=e,f[4]=g):g=f[4];e=g;return b("react-relay/relay-hooks/useLazyLoadQuery")(a,c,e)}function c(a,c){var e=d("react-compiler-runtime").c(2),f;e[0]!==a?(f=b("ReactiveExecutorExecTimeResolverTransformer").getTransformedFragmentForExecTimeMode(a),e[0]=a,e[1]=f):f=e[1];return b("react-relay/relay-hooks/useFragment")(f,c)}function e(a,c,d,e,f){var g;g=((g=c.operation)==null?void 0:g.use_exec_time_resolvers)===!1||((g=c.operation)==null?void 0:(g=g.exec_time_resolvers_enabled_provider)==null?void 0:g.get())===!1;e=g?e:babelHelpers["extends"]({},e,{fetchPolicy:"store-and-network"});return b("react-relay/relay-hooks/loadQuery").loadQuery(a,g?c:b("ReactiveExecutorExecTimeResolverTransformer").getTransformedQueryForExecTimeMode(c),d,e,f)}g.graphql=d("relay-runtime").graphql;g.useLazyLoadClientQuery=a;g.useFragment=c;g.loadClientQuery=e}),98);
__d("FBPayHubTransactionDetailDialogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="29938039689142900"}),null);
__d("LSAppendDataTraceAddon.nop",["LSAppendDataTraceAddonStoredProcedure","LSFactory","MetaConfig","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,d,e,f,g,i,j){return!c("MetaConfig")._("62")?(h||(h=b("Promise"))).resolve():c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:f,dataTraceId:e,errorMessage:(d=i)!=null?d:"",syncChannel:g,tags:(a=j)!=null?a:""})};a.__nop_name__="LSAppendDataTraceAddonNop";g["default"]=a}),98);
__d("LSClearCommunityMembersRangeTable",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return a[1]!==void 0?c[0]=a[1]:c[0]="",b.i64.neq(a[0],void 0)?c[1]=!1:c[1]=!0,b.forEach(b.filter(b.db.table(189).fetch(),function(d){return(c[1]||b.i64.eq(d.source,a[0]))&&d.requestId===c[0]}),function(a){return a["delete"]()})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxClearCommunityMembersRangeTableStoredProcedure";a.__tables__=["community_members_ranges_v2__generated"];e.exports=a}),null);
__d("LSClearCommunityMembersTable",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return a[1]!==void 0?c[0]=a[1]:c[0]="",b.i64.neq(a[0],void 0)?c[1]=!1:c[1]=!0,b.i64.neq(a[2],void 0)?b.forEach(b.filter(b.db.table(170).fetch(),function(d){return(c[1]||b.i64.eq(d.source,a[0]))&&b.i64.eq(d.groupThreadId,a[2])&&d.requestId===c[0]}),function(a){return a["delete"]()}):b.forEach(b.filter(b.db.table(170).fetch(),function(d){return(c[1]||b.i64.eq(d.source,a[0]))&&d.requestId===c[0]}),function(a){return a["delete"]()})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxClearCommunityMembersTableStoredProcedure";a.__tables__=["community_members"];e.exports=a}),null);
__d("LSClearCommunityMembersAndRange",["LSClearCommunityMembersRangeTable","LSClearCommunityMembersTable"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[];return c.sequence([function(d){return c.sequence([function(d){return c.storedProcedure(b("LSClearCommunityMembersTable"),a[0],a[1],a[2])},function(d){return c.storedProcedure(b("LSClearCommunityMembersRangeTable"),a[0],a[1])}])},function(a){return c.resolve(d)}])}a.__sproc_name__="LSMailboxClearCommunityMembersAndRangeStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSClearCommunityMembersAndRangeStoredProcedure",["LSClearCommunityMembersAndRange","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){e===void 0&&(e={});a=a.storedProcedure(c("LSClearCommunityMembersAndRange"),e.source,e.requestId,e.threadId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSClearMessageSearchTable",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.db.table(69).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(c){return b.forEach(b.db.table(70).fetch([[[a[0]]]]),function(a){return a["delete"]()})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSSearchClearMessageSearchTableStoredProcedure";a.__tables__=["message_search_results","message_search_queries"];e.exports=a}),null);
__d("LSClearMessageSearchTableStoredProcedure",["LSClearMessageSearchTable","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSClearMessageSearchTable"),e.type_);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSCommunityThreadCreationStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({FAILURE:2,PENDING:0,SUCCESS:1});f["default"]=a}),66);
__d("LSCreateCommunitySubThread",["LSCreateOfflineThreadingID","LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[1]=a[0],a})},function(e){return d[2]=new c.Map(),d[2].set("client_mutation_id",d[1]),d[2].set("community_id",a[0]),d[2].set("parent_message_id",a[2]),d[2].set("parent_thread_id",a[1]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[7]=c.i64.of_float(Date.now()),d[3]=c.i64.add(d[7],c.i64.cast([0,0]))):d[3]=c.i64.cast([0,0]),d[4]=d[2].get("parent_thread_id"),d[5]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["create_community_sub_thread","_",c.i64.to_string(d[4])].join(""),c.i64.cast([0,665]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[3],c.i64.cast([0,0])).then(function(a){return a=a,d[6]=a[0],a})},function(a){return e[0]=d[6]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxCreateCommunitySubThreadStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSCreateCommunitySubThreadStoredProcedure",["LSCreateCommunitySubThread","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSCreateCommunitySubThread"),e.communityId,e.parentThreadId,e.parentMessageId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSDeleteReaction",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(8).fetch([[[a[0],a[1],a[2]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&c.messageId===a[1]&&b.i64.eq(c.actorId,a[2])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteReactionStoredProcedure";a.__tables__=["reactions"];e.exports=a}),null);
__d("LSInsertAnonymousTaskContext",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(311).add({taskId:a[0],projectName:a[1]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSAnonymousCredentialsInsertAnonymousTaskContextStoredProcedure";a.__tables__=["anonymous_task_context"];e.exports=a}),null);
__d("LSIssueNewTaskUsingSyncChannel",["LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[12]).then(function(a){return a=a,d[0]=a[0],a})},function(b){return c.db.table(306).add({taskId:d[0],syncChannel:a[10],requiresAuthentication:a[11]})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSCoreIssueNewTaskUsingSyncChannelStoredProcedure";a.__tables__=["lightspeed_task_context"];e.exports=a}),null);
__d("LSDispatchMediaReceiverFetchForWeb",["LSInsertAnonymousTaskContext","LSIssueNewTaskUsingSyncChannel","LSMailboxTaskCompletionApiOnTaskInsertion"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[0].set("message_id",a[1]),d[0].set("receiver_fetch_id",a[2]),d[0].set("should_fetch_accessibility_summary_text",a[3]),d[1]=d[0].get("message_id"),d[4]=["LSMediaReceiverFetchTransportAnonymizedMsgrWebE2EEMediaReceiverFetchSyncAction",".",d[1]].join(""),d[2]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTaskUsingSyncChannel"),d[4],c.i64.cast([0,1018]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,2]),!1,c.i64.cast([0,0])).then(function(a){return a=a,d[3]=a[0],a})},function(a){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskInsertion"),d[3])},function(a){return c.storedProcedure(b("LSInsertAnonymousTaskContext"),d[3],"LS_MediaReceiverFetch")}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMediaReceiverFetchTransportDispatchMediaReceiverFetchForWebStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSDispatchMediaReceiverFetchForWebStoredProcedure",["LSDispatchMediaReceiverFetchForWeb","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSDispatchMediaReceiverFetchForWeb"),e.threadKey,e.messageId,e.receiverFetchId,e.shouldFetchAccessibilitySummaryText);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSGenerateTraceId",["LSRequestId","MetaConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(c("MetaConfig")._("62"))return c("LSRequestId").generate();else return void 0}g["default"]=a}),98);
__d("LSGetAttachmentType",["LSIntEnum","MessagingAttachmentType","cometIsMimeTypeForMedia","genIsNonAnimatedWebPFile"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a){return a.type==="image/webp"?(h||(h=d("LSIntEnum"))).ofNumber(await c("genIsNonAnimatedWebPFile")(a)?c("MessagingAttachmentType").IMAGE:c("MessagingAttachmentType").VIDEO):i(a)}function i(a){a=a.type;if(d("cometIsMimeTypeForMedia").isMimeTypeForPhoto(a))return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE);else if(a==="audio/wav")return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO);else if(a==="image/gif")return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE);else if(d("cometIsMimeTypeForMedia").isMimeTypeForVideo(a))return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO);else return(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE)}g.LSGetAttachmentType=a;g.LSGetAttachmentTypeSyncButLessAccurate=i}),98);
__d("LSGetMessageAttributionParams",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.filter(b.db.table(31).fetch(),function(b){return b.offlineThreadingId===a[0]}).next().then(function(a,b){var d=a.done;a=a.value;return d?(d=[void 0,void 0,void 0],c[0]=d[0],c[1]=d[1],c[2]=d[2],d):(b=a.item,d=[b.threadAttributionSource,b.platformRef,b.platformToken],c[0]=d[0],c[1]=d[1],c[2]=d[2],d)})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMediaSendGetMessageAttributionParamsStoredProcedure";a.__tables__=["messages_optimistic_context"];e.exports=a}),null);
__d("LSInsertPhase2PendingTask",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return c.db.table(12).fetch([[[a[0]]],"optimistic"]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=void 0:(b=a.item,d[0]=b.threadKey)})},function(e){return c.i64.neq(d[0],void 0)?c.sequence([function(e){return c.storedProcedure(b("LSIssueNewTask"),[c.i64.to_string(d[0]),"_multi_media"].join(""),c.i64.cast([0,4]),a[0],void 0,void 0,a[1],c.i64.cast([0,0]),c.i64.cast([0,29]),void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return d[2]=void 0}]):c.resolve(d[2]=c.i64.cast([0,1002]))},function(a){return e[0]=d[2]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMediaSendInsertPhase2PendingTaskStoredProcedure";a.__tables__=["messages"];e.exports=a}),null);
__d("LSInsertRollCallContribution",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.sequence([function(c){return b.forEach(b.filter(b.db.table(255).fetch([[[a[0],a[1],a[2],a[3]]],"optimistic"]),function(c){return b.i64.eq(c.rollCallContributionId,a[0])&&b.i64.eq(c.rollCallId,a[1])&&c.messageId===a[2]&&b.i64.eq(c.messageTimestampMs,a[3])&&b.i64.lt(c.authorityLevel,a[23])}),function(a){return a["delete"]()})},function(c){return b.db.table(255).add({rollCallContributionId:a[0],rollCallId:a[1],messageId:a[2],messageTimestampMs:a[3],threadKey:a[4],primaryMediaUrl:a[5],primaryMediaUrlFallback:a[6],primaryMediaExpiryMs:a[7],primaryMediaWidth:a[8],primaryMediaHeight:a[9],primaryMediaMimeType:a[10],previewMediaUrl:a[11],previewMediaUrlFallback:a[12],previewMediaExpiryMs:a[13],previewMediaWidth:a[14],previewMediaHeight:a[15],previewMediaMimeType:a[16],authorityLevel:a[23],contributorId:a[17],offlineThreadingId:a[18],blurOverride:a[19],contributionSource:a[20],contributionType:a[21],content:a[22]})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxInsertRollCallContributionStoredProcedure";a.__tables__=["roll_call_contributions_v2"];e.exports=a}),null);
__d("LSUpsertCommunityMemberRanges",["LSArrayGetObjectAt"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.createArray(),d[3]=(d[0].push(c.i64.cast([0,0])),d[0]),a[2]===!0?c.resolve(d[1]=!0):c.sequence([function(e){return d[3]=!1,d[4]=c.i64.of_int32(a[1].length),c.i64.gt(d[4],c.i64.cast([0,0]))?c.loopAsync(d[4],function(e){return d[5]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[1],d[5]).then(function(a){return a=a,d[6]=a[0],d[7]=a[1],a})},function(a){return d[3]=d[3]||c.i64.eq(c.i64.cast([0,1]),d[6])}])}):c.resolve()},function(a){return d[1]=d[3]}])},function(b){return a[9]!==void 0?d[2]=a[9]:d[2]="",c.db.table(189).put({communityId:a[0],isAdmin:d[1],minName:"",source:a[7],requestId:d[2],maxName:a[6],isLoadingBefore:!1,isLoadingAfter:a[4],hasMoreBefore:!1,hasMoreAfter:a[3],nextPageCursor:a[5]})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxUpsertCommunityMemberRangesStoredProcedure";a.__tables__=["community_members_ranges_v2__generated"];e.exports=a}),null);
__d("LSIssueCommunityMemberListFetch",["LSIssueNewTaskWithExtraOperations","LSUpsertCommunityMemberRanges"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.createArray(),d[4]=(d[0].push(c.i64.cast([0,0])),d[0]),d[1]=c.createArray(),c.storedProcedure(b("LSUpsertCommunityMemberRanges"),a[0],a[1],a[2],!1,!0,"",a[5],a[6],a[9],a[11])},function(e){return d[2]=new c.Map(),d[2].set("community_id",a[0]),d[2].set("roles",a[1]),d[2].set("fetch_admins_only",a[2]),d[2].set("cursor",a[4]),d[2].set("source",a[6]),d[2].set("thread_key",a[7]),d[2].set("search_text",a[8]),d[2].set("thread_roles",a[9]),d[2].set("group_thread_id",a[10]),d[2].set("request_id",a[11]),d[3]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),"fetch_community_member_list",c.i64.cast([0,355]),d[3],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueCommunityMemberListFetchStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSIssueCommunityMemberListFetchStoredProcedure",["LSIssueCommunityMemberListFetch","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueCommunityMemberListFetch"),e.communityId,e.roles,e.fetchAdminsOnly,e.fetchFriendMembersOnly,e.nextPageCursor,e.maxName,e.source,e.threadKey,e.searchText,e.threadRoles,e.groupThreadId,e.requestId,e.maxTimestampMs);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSIssueSendAttachmentMessageTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSPredefineTraceForTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_int32(a[5].length),c.i64.gt(d[0],c.i64.cast([0,0]))?c.loopAsync(d[0],function(e){return d[7]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[5],d[7]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(b){return c.forEach(c.filter(c.db.table(16).fetch([[[a[1],a[3]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===a[3]&&c.i64.eq(b.attachmentIndex,d[7])&&c.i64.eq(b.authorityLevel,c.i64.cast([0,20]))}),function(a){var b=a.update;a.item;return b({attachmentFbid:c.i64.to_string(d[8])})})}])}):c.resolve()},function(b){return a[9]?d[1]=c.i64.cast([0,9]):d[1]=c.i64.cast([0,3]),c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[2]=c.i64.cast([0,1]):(b=a.item,d[8]=b.syncGroup,c.i64.neq(d[8],void 0)?d[7]=d[8]:d[7]=c.i64.cast([0,1]),d[2]=d[7])})},function(e){return c.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),d[2],void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[4]=a[0],a})},function(e){return a[12]!==void 0?c.sequence([function(e){return c.storedProcedure(b("LSPredefineTraceForTask"),a[12],d[4],c.i64.to_string(c.i64.cast([0,46])),a[3])},function(d){return c.storedProcedure(b("LSAppendDataTraceAddon"),a[12],c.i64.cast([0,20]),c.i64.cast([0,1]),void 0,void 0)}]):c.resolve()},function(b){return d[5]=new c.Map(),d[6]=c.createArray(),c.db.table(31).add({taskId:d[4],threadKey:a[1],offlineThreadingId:a[3],threadAttributionSource:a[6],platformRef:a[10],platformToken:a[11],replySourceId:a[7],replySourceType:a[8],sendType:d[1],markThreadRead:!1})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueSendAttachmentMessageTaskStoredProcedure";a.__tables__=["attachments","threads","messages_optimistic_context"];e.exports=a}),null);
__d("LSLocalApplyOptimisticCommunityChatSubThread",["LSArrayGetObjectAt","LSCreateOfflineThreadingID","LSGetViewerFBID","LSLocalize","LSUpdateMessageSubThreadKey"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.cast([0,16408]),d[1]=c.i64.cast([0,0]),d[2]=c.i64.cast([0,268437504]),d[3]=c.i64.cast([0,0]),d[4]=c.i64.cast([0,0]),d[5]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[5]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,261320435]),void 0).then(function(a){return d[7]=a})},function(e){return c.filter(c.db.table(12).fetch([[[a[2]]],"messageId"]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===a[2]}).next().then(function(e,f){var g=e.done;e=e.value;return g?d[8]=d[7]:(f=e.item,c.sequence([function(e){return d[23]=f.text,d[23]!==void 0?c.resolve(d[22]=d[23]):c.sequence([function(b){return c.filter(c.db.table(12).fetch([[[a[2]]],"messageId"]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===a[2]}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[24]=void 0:(c=b.item,d[24]=c.senderId)})},function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,1369731110]),void 0).then(function(a){return d[26]=a})},function(b){return c.i64.neq(d[24],void 0)?c.sequence([function(b){return c.db.table(216).fetch([[[d[24],a[0]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[31]=void 0:(c=b.item,d[31]=c.profileName)})},function(a){return c.filter(c.db.table(7).fetch([[[d[24]]]]),function(a){return c.i64.eq(a.id,d[24])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(b,c){var a=b.done;b=b.value;return a?d[33]=void 0:(c=b.item,d[37]=c.firstName,d[37]!==void 0?d[36]=d[37]:d[36]=c.name,d[33]=d[36])})},function(a){return d[31]!==void 0?d[35]=d[31]:(d[33]!==void 0?d[36]=d[33]:d[36]=d[26],d[35]=d[36]),d[27]=d[35]}]):c.resolve(d[27]=d[26])},function(b){return c.db.table(16).fetch([[[a[1],a[2]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[28]=void 0:(c=b.item,d[28]=c.attachmentType)})},function(a){return c.i64.eq(d[28],c.i64.cast([0,5]))?c.sequence([function(a){return d[31]=c.createArray(),d[33]=(d[31].push(d[27]),d[31]),b("LSLocalize").localizeV2Async(c.i64.cast([0,216075330]),d[31]).then(function(a){return d[32]=a})},function(a){return d[30]=d[32]}]):c.sequence([function(a){return c.i64.eq(d[28],c.i64.cast([0,2]))?c.sequence([function(a){return d[32]=c.createArray(),d[34]=(d[32].push(d[27]),d[32]),b("LSLocalize").localizeV2Async(c.i64.cast([0,3093868587]),d[32]).then(function(a){return d[33]=a})},function(a){return d[31]=d[33]}]):c.sequence([function(a){return c.i64.eq(d[28],c.i64.cast([0,4]))?c.sequence([function(a){return d[33]=c.createArray(),d[35]=(d[33].push(d[27]),d[33]),b("LSLocalize").localizeV2Async(c.i64.cast([0,1965569930]),d[33]).then(function(a){return d[34]=a})},function(a){return d[32]=d[34]}]):c.sequence([function(a){return c.i64.eq(d[28],c.i64.cast([0,1]))?c.sequence([function(a){return d[34]=c.createArray(),d[36]=(d[34].push(d[27]),d[34]),b("LSLocalize").localizeV2Async(c.i64.cast([0,3981943156]),d[34]).then(function(a){return d[35]=a})},function(a){return d[33]=d[35]}]):c.sequence([function(a){return c.i64.eq(d[28],c.i64.cast([0,3]))?c.sequence([function(a){return d[35]=c.createArray(),d[37]=(d[35].push(d[27]),d[35]),b("LSLocalize").localizeV2Async(c.i64.cast([0,2071149394]),d[35]).then(function(a){return d[36]=a})},function(a){return d[34]=d[36]}]):c.sequence([function(a){return d[35]=c.createArray(),d[37]=(d[35].push(d[27]),d[35]),b("LSLocalize").localizeV2Async(c.i64.cast([0,2414298738]),d[35]).then(function(a){return d[36]=a})},function(a){return d[34]=d[36]}])},function(a){return d[33]=d[34]}])},function(a){return d[32]=d[33]}])},function(a){return d[31]=d[32]}])},function(a){return d[30]=d[31]}])},function(a){return d[22]=d[30]}])},function(a){return d[8]=d[22]}]))})},function(b){return d[10]=d[8],c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[void 0,void 0],d[11]=c[0],d[12]=c[1],c):(b=a.item,c=[b.themeFbid,b.customEmoji],d[11]=c[0],d[12]=c[1],c)})},function(a){return c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[14]=a[0],a})},function(a){return c.forEach(c.filter(c.db.table(9).fetch([[[d[6]]]]),function(a){return c.i64.eq(a.threadKey,d[6])&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:d[6],mailboxType:c.i64.cast([0,0]),threadType:c.i64.cast([0,26]),clientThreadKey:d[6],folderName:"community",parentThreadKey:a[1],lastActivityTimestampMs:c.i64.cast([0,0]),lastReadWatermarkTimestampMs:c.i64.cast([0,0]),snippetHasEmoji:!1,snippetSenderContactId:d[14],ongoingCallState:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),capabilities:d[0],capabilities2:d[1],capabilities3:d[2],capabilities4:d[3],capabilities5:d[4],threadName:d[10],themeFbid:d[11],customEmoji:d[12]})},function(b){return c.filter(c.db.table(12).fetch([[[a[2]]],"messageId"]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===a[2]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[15]=void 0:(b=a.item,d[15]=b.senderId)})},function(a){return d[17]=c.createArray(),c.i64.neq(d[15],void 0)?d[22]=(d[17].push(d[15]),d[17]):0,c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.i64.neq(d[15],d[18])?c.sequence([function(a){return c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[23]=(d[17].push(d[22]),d[17])}]):c.resolve()},function(a){return d[19]=c.i64.of_int32(d[17].length),c.i64.gt(d[19],c.i64.cast([0,0]))?c.loopAsync(d[19],function(a){return d[22]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[17],d[22]).then(function(a){return a=a,d[23]=a[0],d[24]=a[1],a})},function(a){return c.forEach(c.filter(c.db.table(14).fetch([[[d[6],d[23]]]]),function(a){return c.i64.eq(a.threadKey,d[6])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(a.contactId,d[23])&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(14).add({threadKey:d[6],contactId:d[23],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),isModerator:!1})}])}):c.resolve()},function(e){return c.storedProcedure(b("LSUpdateMessageSubThreadKey"),a[2],d[6])},function(a){return c.resolve()},function(b){return d[20]=new c.Map(),d[20].set("client_mutation_id",d[6]),d[20].set("community_id",a[0]),d[20].set("parent_thread_id",a[1]),d[20].set("parent_message_id",a[2]),d[21]=c.toJSON(d[20]),c.db.table(312).put({threadKey:d[6],metadata:d[21]})},function(a){return e[0]=d[6]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticCommunityChatSubThreadStoredProcedure";a.__tables__=["messages","contextual_profile_v1","contacts","attachments","threads","participants","threads_optimistic_metadata"];e.exports=a}),null);
__d("LSLocalApplyOptimisticMessageV2",["LSCreateOfflineThreadingID","LSGetLocalizedReplySnippet","LSIssueNewError","LSLocalize","LSSetMessageDisplayedContentTypes","LSSetMessageViewFlags"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[1]=a[0],a})},function(e){return d[4]=c.i64.to_string(d[1]),d[3]=a[4]==null?a[3]:a[4],c.sequence([function(b){return d[5]=a[5].get("snippet_has_emoji"),c.islc(c.db.table(9).fetchDesc([[[]],"lastActivityTimestampMs"]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?d[6]=c.i64.cast([-1,4294967295]):(b=a.item,d[6]=b.lastActivityTimestampMs)})},function(e){return d[8]=c.i64.add(d[6],c.i64.cast([0,1])),d[10]=c.i64.gt(d[0],d[8])?d[0]:d[8],c.db.table(9).fetch([[[a[1]]]]).next().then(function(e,f){f=e.done;e=e.value;return f?c.sequence([function(b){return function(a){c.logger(a).info(a)}("localApplyOptimisticMessage insert optimistic thread"),c.i64.eq(a[2],c.i64.cast([0,1]))?c.sequence([function(b){return c.filter(c.db.table(7).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.id,a[1])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(a,b){var e=a.done;a=a.value;return e?d[16]=!1:(b=a.item,d[19]=b.capabilities2,c.i64.neq(d[19],void 0)?d[18]=d[19]:d[18]=c.i64.cast([0,0]),d[16]=c.i64.neq(c.i64.and_(d[18],c.i64.cast([0,4096])),c.i64.cast([0,0])))})},function(a){return d[11]=d[16]}]):c.resolve(d[11]=!1)},function(b){return d[11]?d[12]="e2ee_cutover":d[12]="inbox",d[11]?d[13]=c.i64.cast([-1,4294967279]):d[13]=c.i64.cast([0,0]),c.forEach(c.filter(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,40]))}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:a[1],mailboxType:c.i64.cast([0,0]),threadType:a[2],clientThreadKey:a[1],folderName:d[12],parentThreadKey:d[13],lastActivityTimestampMs:d[10],lastReadWatermarkTimestampMs:d[10],snippet:d[3],snippetHasEmoji:d[5]==null?!1:d[5],snippetSenderContactId:a[0],ongoingCallState:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,40])})},function(b){return c.i64.eq(a[2],c.i64.cast([0,13]))||c.i64.eq(a[2],c.i64.cast([0,7]))||c.i64.eq(a[2],c.i64.cast([0,1]))?c.sequence([function(b){return c.forEach(c.filter(c.db.table(14).fetch([[[a[1],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[1])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(14).add({threadKey:a[1],contactId:a[1],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:c.i64.cast([0,20]),isModerator:!1})}]):c.resolve()},function(a){return c.sortBy(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[14]=!1:(b=a.item,d[14]=b.errorShouldBeShown)})},function(a){return d[14]===!0?c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,2285622730]),void 0).then(function(a){return d[16]=a})},function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,1919524925]),void 0).then(function(a){return d[17]=a})},function(a){return c.storedProcedure(b("LSIssueNewError"),void 0,c.i64.cast([0,1545093]),d[16],d[17],void 0,void 0)}]):c.resolve()}]):(e.item,c.forEach(c.filter(c.db.table(9).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(b.threadType,a[2])}),function(b){var c=b.update;b.item;return c({lastActivityTimestampMs:d[10],lastReadWatermarkTimestampMs:d[10],snippet:d[3],snippetHasEmoji:d[5]==null?!1:d[5],snippetSenderContactId:a[0],snippetStringHash:void 0,snippetStringArgument1:void 0,snippetAttribution:void 0,snippetAttributionStringHash:void 0,additionalThreadContext:void 0})}))})}])},function(e){return c.sequence([function(b){return c.islc(c.db.table(12).fetchDesc([[[a[1],c.i64.cast([0,80])],[a[1],c.i64.cast([0,60])],[a[1],c.i64.cast([0,40])]],"messageDisplayOrderAuthority"]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[56]=c.i64.of_float(Date.now()),d[5]=d[56]):(b=a.item,d[5]=b.primarySortKey)})},function(e){return d[7]=a[5].get("reply_source_id"),d[8]=a[5].get("reply_source_type"),d[9]=a[5].get("reply_source_type_v2"),d[10]=a[5].get("reply_type"),d[7]!==void 0&&(c.i64.eq(d[8],c.i64.cast([0,1]))||c.i64.eq(d[9],c.i64.cast([0,1])))?c.sequence([function(e){return c.filter(c.db.table(12).fetch([[[d[7]==null?"":d[7]]],"messageId"]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===(d[7]==null?"":d[7])}).next().then(function(e,f){var g=e.done;e=e.value;return g?(g=[d[7],void 0,void 0,c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],d[56]=g[0],d[57]=g[1],d[58]=g[2],d[59]=g[3],d[60]=g[4],d[61]=g[5],d[62]=g[6],d[63]=g[7],d[64]=g[8],d[65]=g[9],d[66]=g[10],d[67]=g[11],d[68]=g[12],d[69]=g[13],d[70]=g[14],d[71]=g[15],g):(f=e.item,c.sequence([function(e){return d[77]=f.senderId,d[76]=f.stickerId,c.i64.neq(d[76],void 0)?(e=[d[76],c.i64.cast([0,4])],d[78]=e[0],d[79]=e[1],e):(e=[void 0,void 0],d[78]=e[0],d[79]=e[1],e),e=[d[78],d[79]],d[73]=e[0],d[74]=e[1],e,c.sequence([function(e){return c.storedProcedure(b("LSGetLocalizedReplySnippet"),a[1],a[0],d[77],d[10]==null?c.i64.cast([0,0]):d[10]).then(function(a){return a=a,d[78]=a[0],a})},function(a){return d[75]=c.i64.eq(d[9],c.i64.cast([0,1]))?d[78]:""}])},function(a){return a=[d[7],d[8],d[9],c.i64.cast([0,1]),d[75],d[77],f.text,d[73],d[74],void 0,void 0,void 0,void 0,void 0,void 0,d[10]],d[56]=a[0],d[57]=a[1],d[58]=a[2],d[59]=a[3],d[60]=a[4],d[61]=a[5],d[62]=a[6],d[63]=a[7],d[64]=a[8],d[65]=a[9],d[66]=a[10],d[67]=a[11],d[68]=a[12],d[69]=a[13],d[70]=a[14],d[71]=a[15],a}]))})},function(a){return a=[d[56],d[57],d[58],d[59],d[60],d[61],d[62],d[63],d[64],d[65],d[66],d[67],d[68],d[69],d[70],d[71]],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4],d[16]=a[5],d[17]=a[6],d[18]=a[7],d[19]=a[8],d[20]=a[9],d[21]=a[10],d[22]=a[11],d[23]=a[12],d[24]=a[13],d[25]=a[14],d[26]=a[15],a}]):c.resolve((d[7]===void 0||c.i64.eq(d[8],c.i64.cast([0,0]))||c.i64.eq(d[9],c.i64.cast([0,0]))?(e=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],d[56]=e[0],d[57]=e[1],d[58]=e[2],d[59]=e[3],d[60]=e[4],d[61]=e[5],d[62]=e[6],d[63]=e[7],d[64]=e[8],d[65]=e[9],d[66]=e[10],d[67]=e[11],d[68]=e[12],d[69]=e[13],d[70]=e[14],d[71]=e[15],e):(e=[d[7],d[8],d[9],c.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],d[56]=e[0],d[57]=e[1],d[58]=e[2],d[59]=e[3],d[60]=e[4],d[61]=e[5],d[62]=e[6],d[63]=e[7],d[64]=e[8],d[65]=e[9],d[66]=e[10],d[67]=e[11],d[68]=e[12],d[69]=e[13],d[70]=e[14],d[71]=e[15],e),e=[d[56],d[57],d[58],d[59],d[60],d[61],d[62],d[63],d[64],d[65],d[66],d[67],d[68],d[69],d[70],d[71]],d[11]=e[0],d[12]=e[1],d[13]=e[2],d[14]=e[3],d[15]=e[4],d[16]=e[5],d[17]=e[6],d[18]=e[7],d[19]=e[8],d[20]=e[9],d[21]=e[10],d[22]=e[11],d[23]=e[12],d[24]=e[13],d[25]=e[14],d[26]=e[15],e))},function(b){return d[27]=a[5].get("mention_data"),d[27]?d[28]=!1:d[28]=!0,d[28]?(b=[void 0,void 0,void 0,void 0],d[29]=b[0],d[30]=b[1],d[31]=b[2],d[32]=b[3],b):(d[56]=d[27].get("mention_offsets"),d[57]=d[27].get("mention_lengths"),d[58]=d[27].get("mention_ids"),d[59]=d[27].get("mention_types"),b=[d[56],d[57],d[58],d[59]],d[29]=b[0],d[30]=b[1],d[31]=b[2],d[32]=b[3],b),d[33]=a[5].get("magic_words_data"),d[33]?d[34]=!1:d[34]=!0,d[34]?(b=[void 0,void 0],d[35]=b[0],d[36]=b[1],b):(d[56]=d[33].get("magic_word_offsets"),d[57]=d[33].get("magic_word_lengths"),b=[d[56],d[57]],d[35]=b[0],d[36]=b[1],b),d[55]=c.i64.eq(d[10],c.i64.cast([0,1]))?d[17]:a[3],d[37]=a[5].get("sticker_id"),d[38]=a[5].get("sticker_alt_text"),d[39]=a[5].get("hot_emoji_size"),d[40]=a[5].get("iout"),d[41]=a[5].get("platform_XMD_encoded"),d[42]=a[5].get("is_forwarded"),d[43]=a[5].get("forward_score"),d[44]=a[5].get("power_up_style"),d[45]=a[5].get("local_data_id"),d[46]=a[5].get("command_type"),d[47]=a[5].get("reply_type"),d[48]=a[5].get("rich_text_format_type"),c.i64.eq(d[48],c.i64.cast([0,1]))?d[49]=c.i64.cast([0,3]):d[49]=c.i64.cast([0,0]),d[50]=a[5].get("ephemeral_duration_in_sec"),d[51]=a[5].get("is_forwarded"),d[51]?d[52]=c.i64.cast([0,3]):d[52]=d[13],d[53]=a[5].get("plugin_type"),c.i64.eq(d[53],c.i64.cast([0,40]))?d[54]="Instamadillo":d[54]="FBBroker",c.i64.eq(c.i64.cast([0,20]),c.i64.cast([0,20]))?c.db.table(12).add({threadKey:a[1],messageId:d[4],timestampMs:d[0],offlineThreadingId:d[4],primarySortKey:d[5],secondarySortKey:d[0],text:d[55],senderId:a[0],stickerId:d[37],hotEmojiSize:d[39],platformXmdEncoded:d[41],isForwarded:d[42],forwardScore:d[43],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),localDataId:d[45],replyType:d[26],messageRenderingType:d[49],ephemeralDurationInSec:d[50],metadataDataclass:a[6],replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[52],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],mentionOffsets:d[29],mentionLengths:d[30],mentionIds:d[31],mentionTypes:d[32],transportKey:d[54]}):c.sequence([function(a){return c.db.table(12).fetch([[[d[4]]],"optimistic"]).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[d[5],d[0],d[45]],d[56]=c[0],d[57]=c[1],d[58]=c[2],c):(b=a.item,c=[b.primarySortKey,b.secondarySortKey,b.localDataId],d[56]=c[0],d[57]=c[1],d[58]=c[2],c)})},function(a){return c.forEach(c.filter(c.db.table(12).fetch([[[d[4]]],"optimistic"]),function(a){return a.offlineThreadingId===d[4]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(12).add({threadKey:a[1],messageId:d[4],timestampMs:d[0],offlineThreadingId:d[4],primarySortKey:d[56],secondarySortKey:d[57],text:d[55],senderId:a[0],stickerId:d[37],hotEmojiSize:d[39],platformXmdEncoded:d[41],isForwarded:d[42],forwardScore:d[43],isAdminMessage:!1,sendStatus:c.i64.cast([0,1]),sendStatusV2:c.i64.cast([0,1]),authorityLevel:c.i64.cast([0,20]),localDataId:d[58],replyType:d[26],messageRenderingType:d[49],ephemeralDurationInSec:d[50],metadataDataclass:a[6],replySourceId:d[11],replySourceType:d[12],replySourceTypeV2:d[52],replyStatus:d[14],replySnippet:d[15],replyToUserId:d[16],replyMessageText:d[17],replyAttachmentId:d[18],replyAttachmentType:d[19],replyMediaUrl:d[20],replyMediaUrlFallback:d[21],replyMediaPreviewWidth:d[22],replyMediaPreviewHeight:d[23],replyMediaUrlMimeType:d[24],mentionOffsets:d[29],mentionLengths:d[30],mentionIds:d[31],mentionTypes:d[32],transportKey:d[54]})}])}])},function(e){return d[5]=c.createArray(),d[6]=(d[5].push("LSMailboxLocalApplyOptimisticMessageV2StoredProcedure"),d[5]),d[7]=(d[5].push("localApplyOptimisticMessage"),d[5]),d[8]=(d[5].push(a[1]),d[5]),d[9]=(d[5].push(d[4]),d[5]),d[10]=c.toJSON(d[5]),function(a){c.logger(a).info(a)}(d[10]),d[2]=a[5].get("calculate_denormalizations"),(d[2]==null?!0:d[2])?c.sequence([function(e){return c.storedProcedure(b("LSSetMessageViewFlags"),a[1],d[4],d[0],c.i64.eq(a[2],c.i64.cast([0,1])))},function(e){return d[5]=a[5].get("sticker_id"),c.storedProcedure(b("LSSetMessageDisplayedContentTypes"),a[1],d[4],d[0],a[3],!1,c.i64.neq(d[5],void 0))}]):c.resolve()},function(a){return a=[d[4],d[0]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticMessageV2StoredProcedure";a.__tables__=["threads","contacts","participants","user_visible_network_connectivity_error","messages"];e.exports=a}),null);
__d("LSLocalApplyOptimisticRollCallContribution",["LSArrayGetObjectAt","LSGetFirstAvailableAttachmentCTAID","LSGetViewerFBID","LSInsertAttachmentItem","LSInsertRollCallContribution","LSLocalize"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return a[1]!==void 0?c.sequence([function(b){return c.db.table(250).fetch([[[c.i64.from_string(a[1]),a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(function(a){c.logger(a).mustfix(a)}("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] couldn't find roll call in table roll_calls"),e=["Roll Call",c.i64.cast([0,0])],d[0]=e[0],d[1]=e[1],e):(b=a.item,e=[b.rollCallPrompt,b.expiryTimestampSec],d[0]=e[0],d[1]=e[1],e)})},function(b){return c.islc(c.sortBy(c.filter(c.db.table(255).fetch(),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(b.rollCallId,c.i64.from_string(a[1]))}),[["messageTimestampMs","DESC"]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var c=a.done;a=a.value;return c?d[3]=void 0:(b=a.item,d[3]=b.messageId)})},function(b){return d[3]!==void 0?c.sequence([function(b){return d[7]=c.createArray(),c.forEach(c.islc(c.sortBy(c.db.table(18).fetch([[[a[0],d[3]]],"fk_attachments"]),[["attachmentIndex","ASC"]]),0,c.i64.to_float(c.i64.cast([0,2]))),function(a){a=a.item;return d[8]=new c.Map(),d[8].set("attachment_index",a.attachmentIndex),d[8].set("preview_url",a.previewUrl),d[8].set("preview_url_expiration_timestamp_ms",a.previewUrlExpirationTimestampMs),d[8].set("preview_url_mime_type",a.previewUrlMimeType),d[8].set("preview_width",a.previewWidth),d[8].set("preview_height",a.previewHeight),d[8].set("default_cta_id",a.defaultCtaId),d[8].set("playable_url",a.playableUrl),d[9]=(d[7].push(d[8]),d[7])})},function(a){return d[5]=d[7]}]):c.resolve((d[7]=c.createArray(),d[5]=d[7]))},function(e){return c.i64.neq(a[6],void 0)?d[6]=a[6]:d[6]=c.i64.cast([0,0]),c.i64.eq(d[6],c.i64.cast([0,0]))?(d[7]=c.i64.of_int32(a[2].length),c.i64.eq(d[7],c.i64.cast([0,1]))?c.sequence([function(e){return a[5]!==void 0?d[8]=c.i64.from_string(a[5]):d[8]=c.i64.cast([0,0]),b("LSLocalize").localizeV2Async(c.i64.cast([0,3989800917]),void 0).then(function(a){return d[9]=a})},function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[2],c.i64.cast([0,0])).then(function(a){return a=a,d[10]=a[0],d[11]=a[1],a})},function(a){return c.storedProcedure(b("LSGetFirstAvailableAttachmentCTAID")).then(function(a){return a=a,d[12]=a[0],a})},function(b){return d[13]=d[10].get("offline_attachment_id"),d[14]=d[10].get("attachment_index"),c.filter(c.db.table(16).fetch([[[a[0],a[3],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===a[3]&&b.attachmentFbid===a[1]&&c.i64.gt(b.authorityLevel,c.i64.cast([0,20]))}).next().then(function(b){var e=b.done;b.value;return e?c.db.table(16).put({threadKey:a[0],messageId:a[3],attachmentFbid:a[1],timestampMs:a[4],offlineAttachmentId:d[13],attachmentType:c.i64.cast([0,7]),filesize:c.i64.cast([0,0]),attachmentCta1Id:d[12],attachmentIndex:d[14],hasMedia:!1,hasXma:!0,isSharable:!1,xmaLayoutType:c.i64.cast([0,10]),cta1Title:d[9],cta1Type:"xma_disabled_cta",defaultCtaTitle:d[9],defaultCtaType:"xma_disabled_cta",defaultCtaId:d[12],titleText:d[0],authorityLevel:c.i64.cast([0,20]),countdownTimestampMs:c.i64.mul(d[1],c.i64.cast([0,1e3])),maxTitleNumOfLines:c.i64.cast([0,4])}):0})},function(a){return d[15]=d[10].get("preview_url"),d[26]=d[15]==null?"":d[15],d[16]=d[10].get("preview_url_mime_type"),d[27]=d[16]==null?"":d[16],d[17]=d[10].get("preview_height"),d[23]=d[17]==null?c.i64.cast([0,0]):d[17],d[18]=d[10].get("preview_width"),d[22]=d[18]==null?c.i64.cast([0,0]):d[18],d[19]=d[10].get("playable_url"),d[25]=d[19]==null?"":d[19],d[20]=d[10].get("playable_url_mime_type"),c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[21]=a[0],a})},function(e){return c.storedProcedure(b("LSInsertRollCallContribution"),c.i64.cast([0,0]),c.i64.from_string(a[1]),a[3],a[4],a[0],d[25],"",c.i64.cast([0,0]),d[22],d[23],d[20]==null?"":d[20],d[26],"",c.i64.cast([0,0]),d[22],d[23],d[27],d[21],a[3],!1,d[8],a[6],void 0,c.i64.cast([0,20]))},function(b){return c.forEach(c.db.table(250).fetch([[[c.i64.from_string(a[1]),a[0]]]]),function(a){var b=a.update;a.item;return b({isBlurred:!1,viewerHasContributed:!0})})},function(e){return d[24]=d[10].get("attachment_index"),c.storedProcedure(b("LSInsertAttachmentItem"),a[1],d[24],a[0],c.i64.cast([0,0]),a[3],void 0,c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,d[25],void 0,void 0,void 0,void 0,d[26],d[26],c.i64.cast([0,0]),d[27],d[22],d[23],void 0,d[12],d[9],"xma_disabled_cta",void 0,void 0,void 0,!1,"full",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)},function(e){return d[28]=c.i64.of_int32(d[5].length),c.i64.gt(d[28],c.i64.cast([0,0]))?c.loopAsync(d[28],function(e){return d[29]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[5],d[29]).then(function(a){return a=a,d[30]=a[0],d[31]=a[1],a})},function(e){return d[32]=d[30].get("attachment_index"),d[33]=d[30].get("preview_url"),d[34]=d[30].get("preview_url_expiration_timestamp_ms"),d[35]=d[30].get("preview_url_mime_type"),d[36]=d[30].get("preview_width"),d[37]=d[30].get("preview_height"),d[38]=d[30].get("default_cta_id"),d[39]=d[30].get("playable_url"),c.storedProcedure(b("LSInsertAttachmentItem"),a[1],c.i64.add(d[32],c.i64.cast([0,1])),a[0],c.i64.cast([0,0]),a[3],void 0,c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,d[39],void 0,void 0,void 0,void 0,d[33],d[33],d[34],d[35],d[36],d[37],void 0,d[38],d[9],"xma_disabled_cta",void 0,void 0,void 0,!1,"full",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}])}):c.resolve()}]):c.resolve((d[8]=c.i64.of_int32(a[2].length),function(a){c.logger(a).mustfix(a)}(["[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] expected only 1 attachment for MEDIA contribution, but found ",c.i64.to_string(d[8])].join(""))))):c.resolve(c.i64.eq(d[6],c.i64.cast([0,1]))?a[7]!==void 0?0:function(a){c.logger(a).mustfix(a)}("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] expected non-null content for TEXT contribution, but found null"):c.i64.eq(d[6],c.i64.cast([0,2]))?function(a){c.logger(a).mustfix(a)}("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] LINK contributions are not yet supported"):0)}]):c.resolve(function(a){c.logger(a).mustfix(a)}("[LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure] param product_fbid is missing"))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticRollCallContributionStoredProcedure";a.__tables__=["roll_calls","roll_call_contributions_v2","attachment_items","attachments"];e.exports=a}),null);
__d("LSLocalApplyOptimisticSharedAlbumContribution",["LSArrayGetObjectAt","LSArrayRemoveObjectAt","LSCollapseAttachments","LSGetFirstAvailableAttachmentCTAID","LSInsertAttachmentItem","LSLocalize"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,2856734260]),void 0).then(function(a){return d[0]=a})},function(a){return c.storedProcedure(b("LSGetFirstAvailableAttachmentCTAID")).then(function(a){return a=a,d[1]=a[0],a})},function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[2],c.i64.cast([0,0])).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],a})},function(e){return d[4]=c.i64.random(),d[5]=c.i64.to_string(d[4]),a[1]!==void 0?c.sequence([function(b){return c.db.table(279).fetch([[[c.i64.from_string(a[1]),a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(function(a){c.logger(a).mustfix(a)}("[LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure] couldn't find album in table shared_albums"),d[6]=void 0):(b=a.item,d[6]=b.title)})},function(e){return d[6]!==void 0?c.sequence([function(b){return d[8]=d[2].get("offline_attachment_id"),d[9]=d[2].get("attachment_index"),c.filter(c.db.table(16).fetch([[[a[0],a[3],d[5]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===a[3]&&b.attachmentFbid===d[5]&&c.i64.gt(b.authorityLevel,c.i64.cast([0,20]))}).next().then(function(b){var e=b.done;b.value;return e?c.db.table(16).put({threadKey:a[0],messageId:a[3],attachmentFbid:d[5],timestampMs:a[4],offlineAttachmentId:d[8],attachmentType:c.i64.cast([0,7]),filesize:c.i64.cast([0,0]),attachmentCta1Id:d[1],attachmentIndex:d[9],hasMedia:!1,hasXma:!0,isSharable:!1,xmaLayoutType:c.i64.cast([0,10]),cta1Title:d[0],cta1Type:"xma_disabled_cta",defaultCtaTitle:d[0],defaultCtaType:"xma_shared_album_viewer",defaultCtaId:d[1],titleText:d[6],authorityLevel:c.i64.cast([0,20]),maxTitleNumOfLines:c.i64.cast([0,4]),collapsibleId:c.i64.from_string(a[1])}):0})},function(d){return c.storedProcedure(b("LSCollapseAttachments"),a[0],c.i64.from_string(a[1]))},function(e){return d[10]=c.i64.of_int32(a[2].length),c.i64.gt(d[10],c.i64.cast([0,0]))?c.loopAsync(d[10],function(e){return d[12]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[2],d[12]).then(function(a){return a=a,d[13]=a[0],d[14]=a[1],a})},function(b){return d[15]=d[13].get("preview_url"),d[23]=d[15]==null?"":d[15],d[16]=d[13].get("preview_height"),d[24]=d[16]==null?c.i64.cast([0,0]):d[16],d[17]=d[13].get("preview_width"),d[25]=d[17]==null?c.i64.cast([0,0]):d[17],d[18]=d[13].get("preview_url_mime_type"),d[19]=d[13].get("playable_url"),d[20]=d[13].get("playable_url_mime_type"),d[21]=d[13].get("preview_url_mime_type"),d[22]=d[13].get("offline_attachment_id"),d[22]!==void 0?c.sequence([function(b){return d[27]="",d[28]=c.i64.from_string(d[22]),d[29]=c.i64.from_string(a[1]),d[26]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(280).fetch([[[d[29],d[28],a[0],d[27]]]]),function(b){return c.i64.eq(b.sharedAlbumId,d[29])&&c.i64.eq(b.sharedAlbumContributionId,d[28])&&c.i64.eq(b.threadKey,a[0])&&b.messageId===d[27]&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(280).add({messageId:d[27],sharedAlbumContributionId:d[28],sharedAlbumId:d[29],threadKey:a[0],mediaUrl:d[19]==null?d[23]:d[19],mediaHeight:d[24],mediaWidth:d[25],mediaUrlFallback:"",urlExpiryMs:c.i64.cast([0,0]),creationTimestampMs:d[26],authorityLevel:c.i64.cast([0,20]),previewMediaUrl:d[23],previewMediaHeight:d[24],previewMediaWidth:d[25],previewMediaMimeType:d[18]==null?"":d[18]})}]):c.resolve(function(a){c.logger(a).mustfix(a)}("[LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure] param $attachment_otid is missing"))}])}):c.resolve()},function(e){return d[11]=c.createArray(),d[12]=(d[11].push(c.i64.cast([0,0])),d[11]),c.forEach(c.islc(c.sortBy(c.db.table(280).fetch([[[c.i64.from_string(a[1])]]]),[["creationTimestampMs","DESC"]]),0,c.i64.to_float(c.i64.cast([0,4]))),function(e){var f=e.item;return c.sequence([function(a){return d[15]=f.previewMediaUrl,c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[11],c.i64.cast([0,0])).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(e){return c.i64.eq(c.i64.cast([0,0]),d[12])?d[14]=d[6]:d[14]=void 0,c.storedProcedure(b("LSInsertAttachmentItem"),d[5],d[12],a[0],c.i64.cast([0,0]),a[3],void 0,c.i64.cast([0,0]),void 0,d[14],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,d[15],d[15],c.i64.cast([0,0]),f.previewMediaMimeType,f.mediaWidth,f.mediaHeight,void 0,d[1],void 0,"xma_shared_album_viewer",void 0,void 0,void 0,!1,"full",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)},function(a){return c.nativeTypeOperation("Array",b("LSArrayRemoveObjectAt"),d[11],c.i64.cast([0,0])).then(function(a){return a=a,d[16]=a[0],a})},function(a){return d[16]=(d[11].push(c.i64.add(d[12],c.i64.cast([0,1]))),d[11])}])})}]):c.resolve()}]):c.resolve(function(a){c.logger(a).mustfix(a)}("[LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure] param product_fbid is missing"))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticSharedAlbumContributionStoredProcedure";a.__tables__=["shared_albums","attachments","shared_album_contributions"];e.exports=a}),null);
__d("LSLocalApplyOptimisticMessageWithAttachmentsV2",["LSArrayGetObjectAt","LSLocalApplyOptimisticMessageV2","LSLocalApplyOptimisticRollCallContribution","LSLocalApplyOptimisticSharedAlbumContribution","LSSetMessageDisplayedContentTypes"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticMessageV2"),a[0],a[1],a[2],a[3],a[4],a[5],void 0).then(function(a){return a=a,d[0]=a[0],d[1]=a[1],a})},function(e){return d[2]=a[5].get("attachments"),d[3]=a[5].get("product_type"),d[3]==="roll_call"?(d[4]=a[5].get("product_fbid"),d[5]=a[5].get("product_attribution"),d[6]=a[5].get("contribution_type"),c.storedProcedure(b("LSLocalApplyOptimisticRollCallContribution"),a[1],d[4],d[2],d[0],d[1],d[5],d[6],a[3])):d[3]==="shared_albums"?(d[4]=a[5].get("product_fbid"),d[5]=a[5].get("product_attribution"),c.storedProcedure(b("LSLocalApplyOptimisticSharedAlbumContribution"),a[1],d[4],d[2],d[0],d[1],d[5])):(d[4]=c.i64.of_int32(d[2].length),c.i64.gt(d[4],c.i64.cast([0,0]))?c.loopAsync(d[4],function(e){return d[5]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[2],d[5]).then(function(a){return a=a,d[6]=a[0],d[7]=a[1],a})},function(b){return d[8]=d[6].get("attachment_fbid"),d[9]=d[6].get("offline_attachment_id"),d[10]=d[6].get("attachment_type"),d[11]=d[6].get("filename"),d[12]=d[6].get("filesize"),d[13]=d[6].get("attachment_index"),d[14]=d[6].get("has_media"),d[15]=d[6].get("has_xma"),d[16]=d[6].get("playable_url"),d[17]=d[6].get("playable_url_mime_type"),d[18]=d[6].get("playable_duration_ms"),d[19]=d[6].get("preview_url"),d[20]=d[6].get("preview_url_mime_type"),d[21]=d[6].get("mini_preview"),d[22]=d[6].get("preview_width"),d[23]=d[6].get("preview_height"),d[24]=d[6].get("xma_layout_type"),d[25]=d[6].get("xmas_template_type"),d[26]=d[6].get("cta1_title"),d[27]=d[6].get("cta1_type"),d[28]=d[6].get("attachment_cta1_id"),d[29]=d[6].get("cta2_title"),d[30]=d[6].get("cta2_type"),d[31]=d[6].get("attachment_cta2_id"),d[32]=d[6].get("cta3_title"),d[33]=d[6].get("cta3_type"),d[34]=d[6].get("attachment_cta3_id"),d[35]=d[6].get("image_url"),d[36]=d[6].get("action_url"),d[37]=d[6].get("title_text"),d[38]=d[6].get("subtitle_text"),d[39]=d[6].get("description_text"),d[40]=d[6].get("source_text"),d[41]=d[6].get("original_file_hash"),d[42]=d[6].get("sound_bite_client_sound_key"),d[43]=d[6].get("sound_bite_visual"),d[44]=d[6].get("ephemeral_media_state"),d[45]=d[6].get("waveform_data"),d[46]=d[6].get("avatar_audio_message_animated_url"),d[47]=d[6].get("avatar_audio_message_idle_url"),d[48]=d[6].get("avatar_audio_message_animated_b_url"),d[49]=d[6].get("avatar_audio_message_idle_b_url"),d[50]=d[6].get("avatar_audio_message_background_graphics_image_url"),d[51]=d[6].get("avatar_audio_message_pose_id"),d[52]=d[6].get("sampling_frequency_hz"),d[53]=d[6].get("should_autoplay_video"),d[54]=d[6].get("has_xma_favicon"),d[55]=d[6].get("favicon_url"),d[19]!==void 0?d[56]=d[19]:d[56]=d[16],c.filter(c.db.table(16).fetch([[[a[1],d[0],d[8]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===d[0]&&b.attachmentFbid===d[8]&&c.i64.gt(b.authorityLevel,c.i64.cast([0,20]))}).next().then(function(b){var e=b.done;b.value;return e?c.db.table(16).put({threadKey:a[1],messageId:d[0],attachmentFbid:d[8],timestampMs:d[1],offlineAttachmentId:d[9],attachmentType:d[10],filename:d[11],filesize:d[12],attachmentIndex:d[13],hasMedia:d[14],hasXma:d[15],isSharable:!1,playableUrl:d[16],playableUrlMimeType:d[17],playableDurationMs:d[18],previewUrl:d[56],previewUrlMimeType:d[20],miniPreview:d[21],previewWidth:d[22],previewHeight:d[23],xmaLayoutType:d[24],xmasTemplateType:d[25],cta1Title:d[26],cta1Type:d[27],attachmentCta1Id:d[28],cta2Title:d[29],cta2Type:d[30],attachmentCta2Id:d[31],cta3Title:d[32],cta3Type:d[33],attachmentCta3Id:d[34],imageUrl:d[35],actionUrl:d[36],titleText:d[37],subtitleText:d[38],descriptionText:d[39],sourceText:d[40],ephemeralMediaState:d[44],waveformData:d[45],samplingFrequencyHz:d[52],originalFileHash:d[41],authorityLevel:c.i64.cast([0,20]),shouldAutoplayVideo:d[53],hasXmaFavicon:d[54],faviconUrl:d[55]}):0})}])}):c.resolve())},function(e){return d[4]=c.i64.of_int32(d[2].length),c.i64.gt(d[4],c.i64.cast([0,0]))?(d[5]=a[5].get("sticker_id"),c.storedProcedure(b("LSSetMessageDisplayedContentTypes"),a[1],d[0],d[1],a[3],!1,c.i64.neq(d[5],void 0))):c.resolve()},function(a){return a=[d[0],d[1]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure";a.__tables__=["attachments"];e.exports=a}),null);
__d("LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure",["LSLocalApplyOptimisticMessageWithAttachmentsV2","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSLocalApplyOptimisticMessageWithAttachmentsV2"),e.senderId,e.threadKey,e.threadType,e.text,e.snippet,e.extraSendMessageParams);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSLocalCreateOptimisticCommunityChatSubThread",["LSLocalApplyOptimisticCommunityChatSubThread"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticCommunityChatSubThread"),a[0],a[1],a[2]).then(function(a){return a=a,d[0]=a[0],a})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxLocalCreateOptimisticCommunityChatSubThreadStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSLocalCreateOptimisticCommunityChatSubThreadStoredProcedure",["LSLocalCreateOptimisticCommunityChatSubThread","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSLocalCreateOptimisticCommunityChatSubThread"),e.communityId,e.parentThreadId,e.parentMessageId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSMarkSubJobCompletedV2",["LSArrayGetObjectAt"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return d[0]=c.createArray(),c.db.table(51).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?0:(b=a.item,d[3]=new c.Map(),d[3].set("offline_attachment_id",b.offlineAttachmentId),d[3].set("offline_threading_id",b.offlineThreadingId),d[3].set("in_message_index",b.inMessageIndex),d[3].set("attachment_type",b.attachmentType),d[3].set("should_transcode",b.shouldTranscode),d[3].set("use_double_phase",b.useDoublePhase),d[3].set("send_by_server",b.sendByServer),d[3].set("is_secure",b.isSecure),d[3].set("state",b.state),d[3].set("fbid",b.fbid),d[3].set("metadata",b.metadata),d[3].set("error",b.error),d[3].set("message_id",b.messageId),d[4]=(d[0].push(d[3]),d[0]))})},function(e){return d[2]=c.i64.of_int32(d[0].length),c.i64.neq(d[2],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[0],c.i64.cast([0,0])).then(function(a){return a=a,d[3]=a[0],d[4]=a[1],a})},function(b){return d[5]=d[3].get("state"),c.i64.neq(a[1],void 0)?a[2]!==void 0?(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.forEach(c.db.table(51).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({state:d[6],fbid:a[1],messageId:a[2],metadata:a[3]})})):(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.forEach(c.db.table(51).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({state:d[6],fbid:a[1],metadata:a[3]})})):c.i64.neq(a[4],void 0)?(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.forEach(c.db.table(51).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({state:d[6],error:a[4]})})):(c.i64.eq(d[5],c.i64.cast([-1,4294967293]))?(d[7]=c.i64.cast([-1,4294967295]),d[6]=d[7]):(c.i64.eq(d[5],c.i64.cast([0,1]))?d[7]=c.i64.cast([0,2]):(c.i64.eq(d[5],c.i64.cast([0,3]))?d[8]=c.i64.cast([0,4]):(c.i64.eq(d[5],c.i64.cast([0,5]))?d[9]=c.i64.cast([0,6]):(c.i64.eq(d[5],c.i64.cast([0,13]))?d[10]=c.i64.cast([0,14]):(c.i64.eq(d[5],c.i64.cast([0,7]))?d[11]=c.i64.cast([0,8]):(c.i64.eq(d[5],c.i64.cast([0,9]))?d[12]=c.i64.cast([0,10]):(c.i64.eq(d[5],c.i64.cast([0,11]))?d[13]=c.i64.cast([0,12]):d[13]=d[5],d[12]=d[13]),d[11]=d[12]),d[10]=d[11]),d[9]=d[10]),d[8]=d[9]),d[7]=d[8]),d[6]=d[7]),c.forEach(c.db.table(51).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({state:d[6]})}))}]):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMediaSendMarkSubJobCompletedV2StoredProcedure";a.__tables__=["media_send_jobs"];e.exports=a}),null);
__d("LSMarkSubJobCompletedV2StoredProcedure",["LSMarkSubJobCompletedV2","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSMarkSubJobCompletedV2"),e.offlineAttachmentId,e.fbid,e.messageId,e.metadata,e.error);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSMessageSendToSentQPLInteractionHelper.nop",["LSSynchronousPromise","QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f){f!=null&&c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),e,{instanceKey:parseInt(f,10)});return d("LSSynchronousPromise").maybeMakeSynchronousPromise()}a.__nop_name__="LSMessageSendToSentQPLInteractionHelper";g["default"]=a}),98);
__d("LSOptimisticContributeToTextPrompt",["LSLocalApplyOptimisticMessageV2","LSLocalApplyOptimisticRollCallContribution"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.createArray(),d[1]=new c.Map(),d[1].set("snippet_has_emoji",void 0),d[1].set("sticker_id",void 0),d[1].set("sticker_alt_text",void 0),d[1].set("hot_emoji_size",void 0),d[1].set("external_attachment_url",void 0),d[1].set("attribution_app_id",void 0),d[1].set("source",c.i64.cast([0,0])),d[1].set("platform_ref",void 0),d[1].set("platform_token",void 0),d[1].set("reply_source_id",void 0),d[1].set("reply_source_type",void 0),d[1].set("reply_source_type_v2",void 0),d[1].set("mention_data",void 0),d[1].set("mark_read",void 0),d[1].set("calculate_denormalizations",void 0),d[1].set("optimistic_attachment_preview",void 0),d[1].set("initiating_app_id",void 0),d[1].set("initiating_source",void 0),d[1].set("power_up_style",c.i64.cast([0,0])),d[1].set("data_trace_id",void 0),d[1].set("attachments",d[0]),d[1].set("should_copy_attachments",!1),d[1].set("magic_words_data",void 0),d[1].set("local_data_id",void 0),d[1].set("reply_type",void 0),d[1].set("dety_params",void 0),d[1].set("product_type","roll_call"),d[1].set("product_fbid",a[2]),d[1].set("product_attribution",a[3]),c.storedProcedure(b("LSLocalApplyOptimisticMessageV2"),a[1],a[0],c.i64.cast([0,18]),a[4],a[4],d[1],void 0).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],a})},function(e){return d[4]=c.createArray(),c.storedProcedure(b("LSLocalApplyOptimisticRollCallContribution"),a[0],a[2],d[4],d[2],d[3],a[3],c.i64.cast([0,1]),a[4])}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticContributeToTextPromptStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSOptimisticContributeToTextPromptStoredProcedure",["LSOptimisticContributeToTextPrompt","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticContributeToTextPrompt"),e.threadKey,e.senderId,e.promptId,e.productAttribution,e.text);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSOptimisticCreateRollCall",["LSCreateOfflineThreadingID","LSGetViewerFBID","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSCreateOfflineThreadingID"),d[0]).then(function(a){return a=a,d[1]=a[0],a})},function(b){return c.forEach(c.filter(c.db.table(250).fetch([[[d[1],a[0]]]]),function(b){return c.i64.eq(b.rollCallId,d[1])&&c.i64.eq(b.threadKey,a[0])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(b){return c.db.table(250).add({rollCallId:d[1],threadKey:a[0],rollCallPrompt:a[1],expiryTimestampSec:c.i64.cast([0,0]),isBlurred:!1,authorityLevel:c.i64.cast([0,20]),offlineThreadingId:d[1],canViewWithoutContributing:!1})},function(e){return d[2]=new c.Map(),d[2].set("thread_key",a[0]),d[2].set("prompt",a[1]),d[2].set("offline_threading_id",d[1]),d[2].set("prompt_type",a[2]),c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[3]=a[0],a})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[4]=!1:(b=a.item,c.sequence([function(a){return c.filter(c.db.table(14).fetch([[[b.threadKey,d[3]]]]),function(a){return c.i64.eq(a.threadKey,b.threadKey)&&c.i64.eq(c.i64.cast([0,0]),b.mailboxType)&&c.i64.eq(a.contactId,d[3])}).next().then(function(e,f){var a=e.done;e=e.value;return a?d[10]=!1:(f=e.item,c.i64.eq(b.threadType,c.i64.cast([0,152]))?(d[13]=f.threadRoles,c.i64.lt(c.i64.cast([0,7]),c.i64.cast([0,0]))||c.i64.gt(c.i64.cast([0,7]),c.i64.cast([0,7]))?d[14]=!1:d[14]=!c.i64.eq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,7]))),d[13]),c.i64.cast([0,0])),d[15]=b.capabilities,d[16]=b.capabilities2,d[17]=b.capabilities3,d[18]=b.capabilities4,d[19]=b.capabilities5,d[21]=c.i64.div(c.i64.cast([0,223]),c.i64.cast([0,64])),d[22]=c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.sub(c.i64.cast([0,223]),c.i64.mul(d[21],c.i64.cast([0,64]))))),c.i64.lt(c.i64.cast([0,223]),c.i64.cast([0,0]))||c.i64.gt(c.i64.cast([0,223]),c.i64.cast([0,281]))?d[20]=!1:(c.i64.eq(d[21],c.i64.cast([0,0]))?d[23]=!c.i64.eq(c.i64.and_(d[22],d[15]),c.i64.cast([0,0])):(c.i64.eq(d[21],c.i64.cast([0,1]))?d[24]=!c.i64.eq(c.i64.and_(d[22],d[16]),c.i64.cast([0,0])):(c.i64.eq(d[21],c.i64.cast([0,2]))?d[25]=!c.i64.eq(c.i64.and_(d[22],d[17]),c.i64.cast([0,0])):(c.i64.eq(d[21],c.i64.cast([0,3]))?d[26]=!c.i64.eq(c.i64.and_(d[22],d[18]),c.i64.cast([0,0])):(c.i64.eq(d[21],c.i64.cast([0,4]))?d[27]=!c.i64.eq(c.i64.and_(d[22],d[19]),c.i64.cast([0,0])):d[27]=!1,d[26]=d[27]),d[25]=d[26]),d[24]=d[25]),d[23]=d[24]),d[20]=d[23]),d[14]===d[20]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),c["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),d[12]=d[14]):d[12]=!1,d[10]=d[12])})},function(a){return d[4]=d[10]}]))})},function(b){return d[4]?d[2].set("perform_action_as_page",!0):0,c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[6]=c.i64.cast([0,1]):(b=a.item,d[11]=b.syncGroup,c.i64.neq(d[11],void 0)?d[10]=d[11]:d[10]=c.i64.cast([0,1]),d[6]=d[10])})},function(a){return d[2].set("sync_group",d[6]),d[8]=d[2].get("thread_key"),d[9]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[8]),c.i64.cast([0,607]),d[9],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return a=[d[1],d[0]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticCreateRollCallStoredProcedure";a.__tables__=["roll_calls","threads","participants"];e.exports=a}),null);
__d("LSOptimisticCreateRollCallStoredProcedure",["LSOptimisticCreateRollCall","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticCreateRollCall"),e.threadKey,e.prompt,e.promptType);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSUpdateOptimisticAttachmentPreview",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(16).fetch([[[a[0],a[1],a[2]]]]),function(c){return c.attachmentFbid===a[2]&&b.i64.eq(c.threadKey,a[0])&&c.messageId===a[1]&&b.i64.eq(c.authorityLevel,b.i64.cast([0,20]))}),function(b){var c=b.update;b.item;return c({playableUrl:a[3],playableUrlFallback:a[4],playableUrlExpirationTimestampMs:a[5],playableUrlMimeType:a[6],previewUrl:a[7],previewUrlFallback:a[8],previewUrlExpirationTimestampMs:a[9],previewUrlMimeType:a[10],previewWidth:a[11],previewHeight:a[12],imageUrl:void 0,imageUrlFallback:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlMimeType:void 0})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateOptimisticAttachmentPreviewStoredProcedure";a.__tables__=["attachments"];e.exports=a}),null);
__d("LSOptimisticSendAttachmentForward",["LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSUpdateOptimisticAttachmentPreview"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[1]=a[3]===""?void 0:a[3],d[1]!==void 0?c.sequence([function(b){return c.forEach(c.filter(c.db.table(16).fetch([[[a[1],d[1]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===d[1]&&c.i64.eq(b.authorityLevel,c.i64.cast([0,20]))}),function(b){var d=b.update;b.item;return d({attachmentFbid:c.i64.to_string(a[7])})})},function(a){return d[0]=d[1]}]):c.sequence([function(e){return c.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],a[4],a[5],a[6],void 0,void 0,void 0,void 0,c.i64.cast([0,3]),void 0,void 0,void 0,!0).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],a})},function(e){return c.filter(c.db.table(16).fetch(),function(b){return b.attachmentFbid===c.i64.to_string(a[7])}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],d[3],d[2],d[2],c.i64.to_string(a[7]),c.i64.cast([0,2]),void 0,void 0,!0,!1):(f=e.item,c.sequence([function(e){return c.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],d[3],d[2],d[2],c.i64.to_string(a[7]),f.attachmentType,f.filename,f.attributionAppId,!0,!1)},function(e){return c.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],d[2],c.i64.to_string(a[7]),f.playableUrl,f.playableUrlFallback,f.playableUrlExpirationTimestampMs,f.playableUrlMimeType,f.previewUrl,f.previewUrlFallback,f.previewUrlExpirationTimestampMs,f.previewUrlMimeType,f.previewWidth,f.previewHeight)}]))})},function(a){return d[0]=d[2]}])},function(e){return c.sequence([function(b){return d[2]=c.createArray(),d[6]=(d[2].push(a[7]),d[2]),c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[3]=c.i64.cast([0,1]):(b=a.item,d[7]=b.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[3]=d[6])})},function(e){return c.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),c.i64.to_string(a[1]),c.i64.cast([0,46]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),d[3],void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[5]=a[0],a})},function(b){return c.db.table(31).add({taskId:d[5],threadKey:a[1],offlineThreadingId:d[0],threadAttributionSource:a[8],sendType:c.i64.cast([0,4]),markThreadRead:!1,initiatingSource:a[9]})}])},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticSendAttachmentForwardStoredProcedure";a.__tables__=["attachments","threads","messages_optimistic_context"];e.exports=a}),null);
__d("LSOptimisticSendAttachmentForwardStoredProcedure",["LSOptimisticSendAttachmentForward","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticSendAttachmentForward"),e.senderId,e.threadKey,e.threadType,e.offlineThreadingId,e.text,e.snippet,e.snippetHasEmoji,e.forwardedAttachmentFbid,e.source,e.initiatingSource);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSOptimisticSendMessageForward",["LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSPredefineTraceForTask","LSUpdateOptimisticAttachmentPreview","gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return d.filter(d.db.table(12).fetch([[[a[3],a[4],a[5]]]]),function(b){return d.i64.eq(b.threadKey,a[3])&&d.i64.eq(d.i64.cast([0,0]),d.i64.cast([0,0]))&&d.i64.eq(b.timestampMs,a[4])&&b.messageId===a[5]&&d.i64.eq(b.authorityLevel,d.i64.cast([0,80]))}).next().then(function(f,g){var h=f.done;f=f.value;return h?(e[3]=d.createArray(),e[4]=(e[3].push("optimisticSendMessageForward msg not found"),e[3]),e[5]=(e[3].push(a[5]),e[3]),e[6]=d.toJSON(e[3]),function(a){d.logger(a).mustfix(a)}(e[6]),h=["",d.i64.cast([-1,4294967295])],e[0]=h[0],e[1]=h[1],h):(g=f.item,d.sequence([function(f){return e[11]=g.forwardScore,e[3]=g.text,c("gkx")("24141")?(d.i64.neq(e[11],void 0)?e[12]=d.i64.lt(e[11],d.i64.cast([0,127])):e[12]=!0,d.i64.eq(a[0],g.senderId)||!e[12]?e[13]=e[11]:(d.i64.neq(e[11],void 0)?e[14]=d.i64.add(e[11],d.i64.cast([0,1])):e[14]=d.i64.cast([0,1]),e[13]=e[14]),e[4]=e[13]):e[4]=e[11],d.storedProcedure(b("LSLocalApplyOptimisticMessage"),a[0],a[1],a[2],e[3],void 0,void 0,g.stickerId,g.hotEmojiSize,void 0,void 0,d.i64.cast([0,3]),void 0,e[4],void 0,!0).then(function(a){return a=a,e[5]=a[0],e[6]=a[1],a})},function(c){return d.forEach(d.db.table(16).fetch([[[g.threadKey,g.messageId]]]),function(c){var f=c.item;return d.sequence([function(c){return e[16]=f.attachmentFbid,e[12]=d.createArray(),e[13]=(e[12].push(e[16]),e[12]),e[14]=(e[12].push(e[5]),e[12]),e[15]=d.toJSON(e[12]),d.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],e[6],e[5],e[16],e[15],f.attachmentType,f.filename,void 0,f.hasMedia,f.hasXma)},function(c){return d.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],e[5],e[15],f.playableUrl,f.playableUrlFallback,f.playableUrlExpirationTimestampMs,f.playableUrlMimeType,f.previewUrl,f.previewUrlFallback,f.previewUrlExpirationTimestampMs,f.previewUrlMimeType,f.previewWidth,f.previewHeight)}])})},function(b){return d.db.table(9).fetch([[[a[1]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?e[7]=d.i64.cast([0,1]):(c=b.item,e[13]=c.syncGroup,d.i64.neq(e[13],void 0)?e[12]=e[13]:e[12]=d.i64.cast([0,1]),e[7]=e[12])})},function(c){return d.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),d.i64.to_string(a[1]),d.i64.cast([0,46]),"",void 0,void 0,d.i64.cast([0,0]),d.i64.cast([0,0]),e[7],void 0,d.i64.cast([0,0]),void 0,d.i64.cast([0,0])).then(function(a){return a=a,e[9]=a[0],a})},function(a){return void 0!==void 0?d.storedProcedure(b("LSPredefineTraceForTask"),void 0,e[9],d.i64.to_string(d.i64.cast([0,46])),e[5]):d.resolve()},function(b){return d.db.table(31).add({taskId:e[9],threadKey:a[1],offlineThreadingId:e[5],messageId:a[5],threadAttributionSource:a[6],sendType:d.i64.cast([0,5]),markThreadRead:!1,initiatingSource:a[7]})},function(b){return e[12]=new d.Map(),e[13]=e[12].set("optimisticSendMessageForward",a[1]),e[14]=e[12].set("fwdMsgID",a[5]),e[15]=d.toJSON(e[12]),e[10]=e[15],function(a){d.logger(a).info(a)}(e[10]),b=[e[5],e[9]],e[0]=b[0],e[1]=b[1],b}]))})},function(a){return f[0]=e[0]}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSMailboxOptimisticSendMessageForwardStoredProcedure";a.__tables__=["messages","attachments","threads","messages_optimistic_context"];d=a;g["default"]=d}),98);
__d("LSOptimisticSendMessageForwardStoredProcedure",["LSOptimisticSendMessageForward","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticSendMessageForward"),e.senderId,e.threadKey,e.threadType,e.forwardedMsgThreadKey,e.forwardedMsgTimestampMs,e.forwardedMsgId,e.source,e.initiatingSource);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSOptimisticSendMessageV2",["LSAppendDataTraceAddon.nop","LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessageV2","LSLogEventAnnotate.nop","LSMessageSendToSentQPLInteractionHelper.nop","LSOptimisticMarkThreadReadV2","LSPredefineTraceForTask","LSUpdateOptimisticAttachmentPreview","gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(c){return e[0]=a[6].get("qpl_instance_key"),d.storedProcedure(b("LSLocalApplyOptimisticMessageV2"),a[0],a[1],a[2],a[4],a[5],a[6],a[8]).then(function(a){return a=a,e[1]=a[0],e[2]=a[1],a})},function(f){return d.sequence([function(c){return e[5]=a[6].get("external_attachment_url"),e[40]=e[5]===""?void 0:e[5],e[40]!==void 0?d.sequence([function(c){return e[41]=a[6].get("attribution_app_id"),e[42]=a[6].get("optimistic_attachment_preview"),d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_insert_optimistic_gif_start",e[0])},function(c){return d.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],e[2],e[1],e[1],e[1],d.i64.cast([0,3]),e[40],e[41],!0,!1)},function(c){return e[42]?e[43]=!1:e[43]=!0,e[43]?d.resolve():(e[44]=e[42].get("playable_url"),e[45]=e[42].get("playable_url_fallback"),e[46]=e[42].get("playable_url_expiration_timestamp_ms"),e[47]=e[42].get("playable_url_mime_type"),e[48]=e[42].get("preview_url"),e[49]=e[42].get("preview_url_fallback"),e[50]=e[42].get("preview_url_expiration_timestamp_ms"),e[51]=e[42].get("preview_url_mime_type"),e[52]=e[42].get("preview_width"),e[53]=e[42].get("preview_height"),e[54]=e[42].get("image_url"),e[55]=e[42].get("image_url_fallback"),e[56]=e[42].get("image_url_expiration_timestamp_ms"),e[57]=e[42].get("image_url_mime_type"),d.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],e[1],e[1],e[44],e[45],e[46],e[47],e[48],e[49],e[50],e[51],e[52],e[53]))},function(a){return d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_insert_optimistic_gif_end",e[0])},function(a){return e[6]=d.i64.cast([0,7])}]):d.sequence([function(c){return e[41]=a[6].get("sticker_id"),d.i64.neq(e[41],void 0)?d.sequence([function(c){return d.i64.neq(e[41],d.i64.cast([53057,267535043]))&&d.i64.neq(e[41],d.i64.cast([85970,924785702]))&&d.i64.neq(e[41],d.i64.cast([85970,1004785694]))&&d.i64.neq(e[41],d.i64.cast([85970,1044785690]))?d.sequence([function(c){return e[45]=d.i64.to_string(e[41]),e[43]=a[6].get("optimistic_attachment_preview"),d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_insert_optimistic_sticker_start",e[0])},function(c){return d.storedProcedure(b("LSInsertOptimisticAttachment"),a[1],e[2],e[1],d.i64.to_string(e[41]),e[45],d.i64.cast([0,1]),void 0,void 0,!0,!1)},function(c){return e[43]?e[44]=!1:e[44]=!0,e[44]?d.resolve():(e[46]=e[43].get("playable_url"),e[47]=e[43].get("playable_url_fallback"),e[48]=e[43].get("playable_url_expiration_timestamp_ms"),e[49]=e[43].get("playable_url_mime_type"),e[50]=e[43].get("preview_url"),e[51]=e[43].get("preview_url_fallback"),e[52]=e[43].get("preview_url_expiration_timestamp_ms"),e[53]=e[43].get("preview_url_mime_type"),e[54]=e[43].get("preview_width"),e[55]=e[43].get("preview_height"),e[56]=e[43].get("image_url"),e[57]=e[43].get("image_url_fallback"),e[58]=e[43].get("image_url_expiration_timestamp_ms"),e[59]=e[43].get("image_url_mime_type"),d.storedProcedure(b("LSUpdateOptimisticAttachmentPreview"),a[1],e[1],e[45],e[46],e[47],e[48],e[49],e[50],e[51],e[52],e[53],e[54],e[55]))},function(a){return d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_insert_optimistic_sticker_end",e[0])}]):d.resolve()},function(a){return e[42]=d.i64.cast([0,2])}]):d.resolve(e[42]=d.i64.cast([0,1]))},function(a){return e[6]=e[42]}])},function(a){return d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_send_message_v2_task_start",e[0])},function(b){return e[7]=d.i64.cast([0,0]),d.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?e[8]=d.i64.cast([0,1]):(b=a.item,e[42]=b.syncGroup,d.i64.neq(e[42],void 0)?e[41]=e[42]:e[41]=d.i64.cast([0,1]),e[8]=e[41])})},function(c){return e[10]=a[6].get("plugin_type"),d.storedProcedure(b("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),d.i64.to_string(a[1]),d.i64.cast([0,46]),"",void 0,void 0,e[10]==null?d.i64.cast([0,0]):e[10],d.i64.cast([0,0]),e[8],void 0,d.i64.cast([0,0]),void 0,e[7]==null?d.i64.cast([0,0]):e[7]).then(function(a){return a=a,e[11]=a[0],a})},function(a){return d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_send_message_v2_task_end",e[0])},function(c){return e[12]=a[6].get("data_trace_id"),e[12]!==void 0?d.sequence([function(a){return d.storedProcedure(b("LSPredefineTraceForTask"),e[12],e[11],d.i64.to_string(d.i64.cast([0,46])),e[1])},function(c){return e[41]=a[6].get("source"),e[44]=d.i64.to_string(e[41]),e[44]!==void 0?e[42]=e[44]:e[42]=d.i64.to_string(d.i64.cast([0,0])),e[43]=",",d.nativeOperation(b("LSAppendDataTraceAddon.nop"),e[12],d.i64.cast([0,20]),d.i64.cast([0,1]),void 0,[e[42],e[43],d.i64.to_string(e[6]),e[43],d.i64.to_string(a[2])].join(""))}]):d.resolve()},function(b){return e[13]=a[6].get("blocked_by_otids"),e[14]=new d.Map(),e[15]=a[6].get("openEb"),e[16]=a[6].get("source"),e[17]=a[6].get("external_attachment_url"),e[18]=a[6].get("platform_ref"),e[19]=a[6].get("platform_token"),e[20]=a[6].get("reply_source_id"),e[21]=a[6].get("reply_source_attachment_id"),e[22]=a[6].get("reply_source_type"),e[23]=a[6].get("mark_read"),e[24]=a[6].get("initiating_app_id"),e[25]=a[6].get("initiating_source"),e[26]=a[6].get("navigation_chain"),e[27]=a[6].get("dety_params"),e[28]=a[6].get("skip_url_preview_gen"),e[29]=a[6].get("text_has_links"),e[30]=a[6].get("multitab_env"),e[31]=a[6].get("rich_text_format_type"),e[32]=a[6].get("plugin_type"),d.i64.eq(e[32],d.i64.cast([0,40]))?e[33]="Instamadillo":e[33]="FBBroker",d.db.table(31).add({taskId:e[11],threadKey:a[1],openEb:e[15],qplInstanceKey:e[0],offlineThreadingId:e[1],threadAttributionSource:e[16],externalAttachmentUrl:e[17],platformRef:e[18],platformToken:e[19],replySourceId:e[20],replySourceType:e[22],sendType:e[6],markThreadRead:e[23]==null?!1:e[23],initiatingSource:e[25],skipUrlPreviewGen:e[28],textHasLinks:e[29],dataclassParams:a[7],multitabEnv:e[30],richTextFormatType:e[31],transportKey:e[33]})},function(f){return c("gkx")("834")&&d.i64.eq(a[2],d.i64.cast([0,1]))?d.resolve(0):(e[41]=a[6].get("mark_read"),(e[41]==null?!1:e[41])?d.sequence([function(a){return d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_mark_thread_read_start",e[0])},function(c){return d.storedProcedure(b("LSOptimisticMarkThreadReadV2"),a[1],e[2])},function(a){return d.nativeOperation(b("LSMessageSendToSentQPLInteractionHelper.nop"),"sp_mark_thread_read_end",e[0])}]):d.resolve())},function(c){return e[34]=d.createArray(),e[35]=(e[34].push("optimisticSendMessageV2"),e[34]),e[36]=(e[34].push(a[1]),e[34]),e[37]=(e[34].push(e[1]),e[34]),e[38]=d.toJSON(e[34]),function(a){d.logger(a).info(a)}(e[38]),e[39]=new d.Map(),e[39].set("offline_threading_id",e[1]),e[39].set("task_id",e[11]),e[39].set("task_queue_name",d.i64.to_string(a[1])),e[39].set("task_label",d.i64.to_string(d.i64.cast([0,46]))),d.nativeOperation(b("LSLogEventAnnotate.nop"),d.i64.cast([0,16]),d.i64.cast([0,23]),d.i64.cast([0,0]),e[39])},function(a){return a=[e[1],e[11]],e[3]=a[0],e[4]=a[1],a}])},function(a){return f[0]=e[3]}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSMailboxOptimisticSendMessageV2StoredProcedure";a.__tables__=["threads","messages_optimistic_context"];d=a;g["default"]=d}),98);
__d("LSOptimisticSendMessageV2StoredProcedure",["LSOptimisticSendMessageV2","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticSendMessageV2"),e.senderId,e.threadKey,e.threadType,e.mailboxType,e.text,e.snippet,e.extraSendMessageParams,e.dataclassParams,e.metadataDataclass);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSOptimisticUpsertReaction",["LSArrayGetObjectAt","LSCancelTaskByQueueName","LSDeleteReaction","LSIssueNewTask","LSUpsertReaction"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[21]=b.syncGroup,c.i64.neq(d[21],void 0)?d[20]=d[21]:d[20]=c.i64.cast([0,1]),d[0]=d[20])})},function(e){return d[2]=new c.Map(),d[2].set("thread_key",a[0]),d[2].set("timestamp_ms",a[1]),d[2].set("message_id",a[2]),d[2].set("actor_id",a[3]),d[2].set("reaction",a[4]),d[2].set("reaction_style",void 0),d[2].set("sync_group",d[0]),d[3]=c.createArray(),d[4]=(d[3].push("reaction"),d[3]),d[5]=d[2].get("message_id"),d[6]=(d[3].push(d[5]),d[3]),d[7]=c.toJSON(d[3]),c.storedProcedure(b("LSCancelTaskByQueueName"),d[7],c.i64.cast([0,29]))},function(e){return a[4]===""?c.sequence([function(d){return c.storedProcedure(b("LSDeleteReaction"),a[0],a[2],a[3])},function(a){return d[8]=void 0}]):c.sequence([function(e){return a[4]==="\u2764\ufe0f"||a[4]==="\u2764\ufe0f"?d[20]="\u2764":d[20]=a[4],c.storedProcedure(b("LSUpsertReaction"),a[0],a[1],a[2],a[3],d[20],c.i64.cast([0,20]),void 0)},function(a){return d[8]=void 0}])},function(a){return void 0?d[9]=!1:d[9]=!0,d[9]?c.resolve(d[10]=void 0):c.sequence([function(a){return d[20]=new c.Map(),d[20].set("feature_tags",void 0),d[21]=new c.Map(),d[21].set("logging_metadata",d[20]),d[22]=new c.Map(),d[30]="product_params",d[23]=d[21].get(d[30]),d[23]?d[24]=!1:d[24]=!0,d[24]?0:(d[23]?d[33]=!1:d[33]=!0,d[33]?d[34]=void 0:(d[37]=new c.Map(),d[41]="product_type",d[38]=d[23].get(d[41]),d[38]!==void 0?d[37].set(d[41],d[38]):0,d[42]="product_extras",d[39]=d[23].get(d[42]),d[39]?d[40]=!1:d[40]=!0,d[40]?0:(d[39]?d[43]=!1:d[43]=!0,d[43]?d[44]=void 0:(d[47]=d[39].get("__typename"),d[47]==="XMSGStoryReplyExtras"?(d[49]=new c.Map(),d[52]="logging",d[50]=d[39].get(d[52]),d[50]?d[51]=!1:d[51]=!0,d[51]?0:(d[50]?d[53]=!1:d[53]=!0,d[53]?d[54]=void 0:(d[57]=new c.Map(),d[65]="story_author_fbid",d[58]=d[50].get(d[65]),d[58]!==void 0?d[57].set(d[65],d[58]):0,d[66]="camera_post_type",d[59]=d[50].get(d[66]),d[59]!==void 0?d[57].set(d[66],d[59]):0,d[67]="story_type",d[60]=d[50].get(d[67]),d[60]!==void 0?d[57].set(d[67],d[60]):0,d[68]="post_source",d[61]=d[50].get(d[68]),d[61]!==void 0?d[57].set(d[68],d[61]):0,d[69]="fb_post_type",d[62]=d[50].get(d[69]),d[62]!==void 0?d[57].set(d[69],d[62]):0,d[70]="conversation_starter_type",d[63]=d[50].get(d[70]),d[63]!==void 0?d[57].set(d[70],d[63]):0,d[71]="story_reply_type",d[64]=d[50].get(d[71]),d[64]!==void 0?d[57].set(d[71],d[64]):0,d[54]=d[57]),d[55]=d[54].keys(),d[56]=c.i64.of_int32(d[55].length),c.i64.neq(d[56],c.i64.cast([0,0]))?d[49].set(d[52],d[54]):0),d[48]=d[49]):(d[47]==="XMSGMarketplaceExtras"?(d[50]=new c.Map(),d[69]="listing_id",d[51]=d[39].get(d[69]),d[51]!==void 0?d[50].set(d[69],d[51]):0,d[70]="initial_clicked_component",d[52]=d[39].get(d[70]),d[52]!==void 0?d[50].set(d[70],d[52]):0,d[71]="initial_tracking",d[53]=d[39].get(d[71]),d[53]!==void 0?d[50].set(d[71],d[53]):0,d[72]="referral_surface",d[54]=d[39].get(d[72]),d[54]!==void 0?d[50].set(d[72],d[54]):0,d[73]="referral_story_type",d[55]=d[39].get(d[73]),d[55]!==void 0?d[50].set(d[73],d[55]):0,d[74]="referral_ui_component",d[56]=d[39].get(d[74]),d[56]!==void 0?d[50].set(d[74],d[56]):0,d[75]="surface",d[57]=d[39].get(d[75]),d[57]!==void 0?d[50].set(d[75],d[57]):0,d[76]="tracking",d[58]=d[39].get(d[76]),d[58]!==void 0?d[50].set(d[76],d[58]):0,d[77]="ui_component",d[59]=d[39].get(d[77]),d[59]!==void 0?d[50].set(d[77],d[59]):0,d[78]="ad_id",d[60]=d[39].get(d[78]),d[60]!==void 0?d[50].set(d[78],d[60]):0,d[79]="server_session_id",d[61]=d[39].get(d[79]),d[61]!==void 0?d[50].set(d[79],d[61]):0,d[80]="cf_page_id",d[62]=d[39].get(d[80]),d[62]!==void 0?d[50].set(d[80],d[62]):0,d[81]="live_shopping_video_id",d[63]=d[39].get(d[81]),d[63]!==void 0?d[50].set(d[81],d[63]):0,d[82]="logging_id",d[64]=d[39].get(d[82]),c.i64.neq(d[64],void 0)?d[50].set(d[82],d[64]):0,d[83]="photo_ids",d[65]=d[39].get(d[83]),d[65]?d[66]=!1:d[66]=!0,d[66]?0:d[50].set(d[83],d[65]),d[84]="is_customized_message",d[67]=d[39].get(d[84]),d[67]!==void 0?d[50].set(d[84],d[67]):0,d[85]="referral_code",d[68]=d[39].get(d[85]),d[68]!==void 0?d[50].set(d[85],d[68]):0,d[49]=d[50]):(d[47]==="XMSGClickToMessengerAdExtras"?(d[51]=new c.Map(),d[62]="encrypted_ads_token",d[52]=d[39].get(d[62]),d[52]!==void 0?d[51].set(d[62],d[52]):0,d[63]="product_type",d[53]=d[39].get(d[63]),d[53]!==void 0?d[51].set(d[63],d[53]):0,d[64]="post_id",d[54]=d[39].get(d[64]),d[54]!==void 0?d[51].set(d[64],d[54]):0,d[65]="ad_id",d[55]=d[39].get(d[65]),d[55]!==void 0?d[51].set(d[65],d[55]):0,d[66]="page_id",d[56]=d[39].get(d[66]),d[56]!==void 0?d[51].set(d[66],d[56]):0,d[67]="photo_id",d[57]=d[39].get(d[67]),d[57]!==void 0?d[51].set(d[67],d[57]):0,d[68]="photo_index",d[58]=d[39].get(d[68]),c.i64.neq(d[58],void 0)?d[51].set(d[68],d[58]):0,d[69]="fallback_url",d[59]=d[39].get(d[69]),d[59]!==void 0?d[51].set(d[69],d[59]):0,d[70]="product_id",d[60]=d[39].get(d[70]),d[60]!==void 0?d[51].set(d[70],d[60]):0,d[71]="user_id",d[61]=d[39].get(d[71]),d[61]!==void 0?d[51].set(d[71],d[61]):0,d[50]=d[51]):(d[47]==="XMSGZorroMessageExtras"?(d[52]=new c.Map(),d[54]="is_enabled",d[53]=d[39].get(d[54]),d[53]!==void 0?d[52].set(d[54],d[53]):0,d[51]=d[52]):(d[47]==="XMSGGenAISuggestedPromptExtras"?(d[53]=new c.Map(),d[56]="prompt_type",d[54]=d[39].get(d[56]),d[54]!==void 0?d[53].set(d[56],d[54]):0,d[57]="qpl_join_id",d[55]=d[39].get(d[57]),d[55]!==void 0?d[53].set(d[57],d[55]):0,d[52]=d[53]):(d[47]==="XMSGGenAIMultiModalExtras"?(d[54]=new c.Map(),d[58]="should_skip_genai_eval",d[55]=d[39].get(d[58]),d[55]!==void 0?d[54].set(d[58],d[55]):0,d[59]="associated_multimodal_message_id",d[56]=d[39].get(d[59]),d[56]!==void 0?d[54].set(d[59],d[56]):0,d[60]="qpl_join_id",d[57]=d[39].get(d[60]),d[57]!==void 0?d[54].set(d[60],d[57]):0,d[53]=d[54]):(d[47]==="XMSGGenAIFlashImagineExtras"?(d[55]=new c.Map(),d[58]="seed",d[56]=d[39].get(d[58]),c.i64.neq(d[56],void 0)?d[55].set(d[58],d[56]):0,d[59]="qpl_join_id",d[57]=d[39].get(d[59]),d[57]!==void 0?d[55].set(d[59],d[57]):0,d[54]=d[55]):(d[47]==="XMSGShareSheetExtras"?(d[56]=new c.Map(),d[58]="recipient_selection_session_id",d[57]=d[39].get(d[58]),d[57]!==void 0?d[56].set(d[58],d[57]):0,d[55]=d[56]):(d[47]==="XMSGGenAIAssistantAPIExtras"?(d[57]=new c.Map(),d[89]="referrer_session_id",d[58]=d[39].get(d[89]),d[58]!==void 0?d[57].set(d[89],d[58]):0,d[90]="thread_session_id",d[59]=d[39].get(d[90]),d[59]!==void 0?d[57].set(d[90],d[59]):0,d[91]="prompt_id",d[60]=d[39].get(d[91]),d[60]!==void 0?d[57].set(d[91],d[60]):0,d[92]="prompt_type",d[61]=d[39].get(d[92]),d[61]!==void 0?d[57].set(d[92],d[61]):0,d[93]="prompt_fit_topic",d[62]=d[39].get(d[93]),d[62]!==void 0?d[57].set(d[93],d[62]):0,d[94]="location_extras",d[63]=d[39].get(d[94]),d[63]?d[64]=!1:d[64]=!0,d[64]?0:(d[63]?d[113]=!1:d[113]=!0,d[113]?d[114]=void 0:(d[117]=new c.Map(),d[121]="has_previous_perm_prompt",d[118]=d[63].get(d[121]),d[118]!==void 0?d[117].set(d[121],d[118]):0,d[122]="latitude",d[119]=d[63].get(d[122]),d[119]!==void 0?d[117].set(d[122],d[119]):0,d[123]="longitude",d[120]=d[63].get(d[123]),d[120]!==void 0?d[117].set(d[123],d[120]):0,d[114]=d[117]),d[115]=d[114].keys(),d[116]=c.i64.of_int32(d[115].length),c.i64.neq(d[116],c.i64.cast([0,0]))?d[57].set(d[94],d[114]):0),d[95]="qpl_join_id",d[65]=d[39].get(d[95]),d[65]!==void 0?d[57].set(d[95],d[65]):0,d[96]="meta_ai_prompt_type",d[66]=d[39].get(d[96]),d[66]!==void 0?d[57].set(d[96],d[66]):0,d[97]="is_subsequent_send",d[67]=d[39].get(d[97]),d[67]!==void 0?d[57].set(d[97],d[67]):0,d[98]="context_injection_type",d[68]=d[39].get(d[98]),d[68]!==void 0?d[57].set(d[98],d[68]):0,d[99]="context_injection_timestamp_ms",d[69]=d[39].get(d[99]),d[69]!==void 0?d[57].set(d[99],d[69]):0,d[100]="meta_ai_response_to_persist",d[70]=d[39].get(d[100]),d[70]?d[71]=!1:d[71]=!0,d[71]?0:(d[70]?d[113]=!1:d[113]=!0,d[113]?d[114]=void 0:(d[117]=new c.Map(),d[124]="text",d[118]=d[70].get(d[124]),d[118]!==void 0?d[117].set(d[124],d[118]):0,d[125]="bot_response_id",d[119]=d[70].get(d[125]),d[119]!==void 0?d[117].set(d[125],d[119]):0,d[126]="bot_request_id",d[120]=d[70].get(d[126]),d[120]!==void 0?d[117].set(d[126],d[120]):0,d[127]="external_search_params",d[121]=d[70].get(d[127]),d[121]?d[122]=!1:d[122]=!0,d[122]?0:(d[121]?d[129]=!1:d[129]=!0,d[129]?d[130]=void 0:(d[133]=new c.Map(),d[141]="search_result_uri",d[134]=d[121].get(d[141]),d[134]?d[135]=!1:d[135]=!0,d[135]?0:(d[146]=c.i64.of_int32(d[134].length),c.i64.neq(d[146],c.i64.cast([0,0]))?d[133].set(d[141],d[134]):0),d[142]="search_query",d[136]=d[121].get(d[142]),d[136]!==void 0?d[133].set(d[142],d[136]):0,d[143]="attribution_link",d[137]=d[121].get(d[143]),d[137]!==void 0?d[133].set(d[143],d[137]):0,d[144]="search_engine",d[138]=d[121].get(d[144]),d[138]!==void 0?d[133].set(d[144],d[138]):0,d[145]="references_title",d[139]=d[121].get(d[145]),d[139]?d[140]=!1:d[140]=!0,d[140]?0:(d[146]=c.i64.of_int32(d[139].length),c.i64.neq(d[146],c.i64.cast([0,0]))?d[133].set(d[145],d[139]):0),d[130]=d[133]),d[131]=d[130].keys(),d[132]=c.i64.of_int32(d[131].length),c.i64.neq(d[132],c.i64.cast([0,0]))?d[117].set(d[127],d[130]):0),d[128]="followup_prompt_text",d[123]=d[70].get(d[128]),d[123]!==void 0?d[117].set(d[128],d[123]):0,d[114]=d[117]),d[115]=d[114].keys(),d[116]=c.i64.of_int32(d[115].length),c.i64.neq(d[116],c.i64.cast([0,0]))?d[57].set(d[100],d[114]):0),d[101]="gql_dark_test_qpl_join_id",d[72]=d[39].get(d[101]),d[72]!==void 0?d[57].set(d[101],d[72]):0,d[102]="gql_dark_test_client_start_time",d[73]=d[39].get(d[102]),d[73]!==void 0?d[57].set(d[102],d[73]):0,d[103]="prompt_context",d[74]=d[39].get(d[103]),d[74]?d[75]=!1:d[75]=!0,d[75]?0:(d[74]?d[113]=!1:d[113]=!0,d[113]?d[114]=void 0:(d[117]=new c.Map(),d[120]="context_token",d[118]=d[74].get(d[120]),d[118]!==void 0?d[117].set(d[120],d[118]):0,d[121]="context_token_type",d[119]=d[74].get(d[121]),c.i64.neq(d[119],void 0)?d[117].set(d[121],d[119]):0,d[114]=d[117]),d[115]=d[114].keys(),d[116]=c.i64.of_int32(d[115].length),c.i64.neq(d[116],c.i64.cast([0,0]))?d[57].set(d[103],d[114]):0),d[104]="imagine_flash_extras",d[76]=d[39].get(d[104]),d[76]?d[77]=!1:d[77]=!0,d[77]?0:(d[76]?d[113]=!1:d[113]=!0,d[113]?d[114]=void 0:(d[117]=new c.Map(),d[120]="seed",d[118]=d[76].get(d[120]),c.i64.neq(d[118],void 0)?d[117].set(d[120],d[118]):0,d[121]="qpl_join_id",d[119]=d[76].get(d[121]),d[119]!==void 0?d[117].set(d[121],d[119]):0,d[114]=d[117]),d[115]=d[114].keys(),d[116]=c.i64.of_int32(d[115].length),c.i64.neq(d[116],c.i64.cast([0,0]))?d[57].set(d[104],d[114]):0),d[105]="conversation_marker_id",d[78]=d[39].get(d[105]),d[78]!==void 0?d[57].set(d[105],d[78]):0,d[106]="multi_modal_extras",d[79]=d[39].get(d[106]),d[79]?d[80]=!1:d[80]=!0,d[80]?0:(d[79]?d[113]=!1:d[113]=!0,d[113]?d[114]=void 0:(d[117]=new c.Map(),d[121]="should_skip_genai_eval",d[118]=d[79].get(d[121]),d[118]!==void 0?d[117].set(d[121],d[118]):0,d[122]="associated_multimodal_message_id",d[119]=d[79].get(d[122]),d[119]!==void 0?d[117].set(d[122],d[119]):0,d[123]="qpl_join_id",d[120]=d[79].get(d[123]),d[120]!==void 0?d[117].set(d[123],d[120]):0,d[114]=d[117]),d[115]=d[114].keys(),d[116]=c.i64.of_int32(d[115].length),c.i64.neq(d[116],c.i64.cast([0,0]))?d[57].set(d[106],d[114]):0),d[107]="ads_extras",d[81]=d[39].get(d[107]),d[81]?d[82]=!1:d[82]=!0,d[82]?0:(d[81]?d[113]=!1:d[113]=!0,d[113]?d[114]=void 0:(d[117]=new c.Map(),d[121]="context",d[118]=d[81].get(d[121]),d[118]!==void 0?d[117].set(d[121],d[118]):0,d[122]="is_reply_to_ads_ai",d[119]=d[81].get(d[122]),d[119]!==void 0?d[117].set(d[122],d[119]):0,d[123]="is_message_processed_by_lightspeed",d[120]=d[81].get(d[123]),d[120]!==void 0?d[117].set(d[123],d[120]):0,d[114]=d[117]),d[115]=d[114].keys(),d[116]=c.i64.of_int32(d[115].length),c.i64.neq(d[116],c.i64.cast([0,0]))?d[57].set(d[107],d[114]):0),d[108]="suggested_prompt_extras",d[83]=d[39].get(d[108]),d[83]?d[84]=!1:d[84]=!0,d[84]?0:(d[83]?d[113]=!1:d[113]=!0,d[113]?d[114]=void 0:(d[117]=new c.Map(),d[120]="prompt_type",d[118]=d[83].get(d[120]),d[118]!==void 0?d[117].set(d[120],d[118]):0,d[121]="qpl_join_id",d[119]=d[83].get(d[121]),d[119]!==void 0?d[117].set(d[121],d[119]):0,d[114]=d[117]),d[115]=d[114].keys(),d[116]=c.i64.of_int32(d[115].length),c.i64.neq(d[116],c.i64.cast([0,0]))?d[57].set(d[108],d[114]):0),d[109]="disable_server_mqtt_typing_indicator",d[85]=d[39].get(d[109]),d[85]!==void 0?d[57].set(d[109],d[85]):0,d[110]="enable_web_scraping",d[86]=d[39].get(d[110]),d[86]!==void 0?d[57].set(d[110],d[86]):0,d[111]="client_prompt_timestamp",d[87]=d[39].get(d[111]),c.i64.neq(d[87],void 0)?(c.i64.neq(d[87],void 0)?d[113]=c.i64.to_string(d[87]):d[113]=void 0,d[57].set(d[111],d[113])):0,d[112]="is_client_ready_for_psi",d[88]=d[39].get(d[112]),d[88]!==void 0?d[57].set(d[112],d[88]):0,d[56]=d[57]):(d[47]==="XMSGProductHighlightExtras"?(d[58]=new c.Map(),d[61]="product_highlight_type",d[59]=d[39].get(d[61]),d[59]!==void 0?d[58].set(d[61],d[59]):0,d[62]="conversation_marker",d[60]=d[39].get(d[62]),d[60]!==void 0?d[58].set(d[62],d[60]):0,d[57]=d[58]):(d[47]==="XMSGMagicMessengerExtras"?(d[59]=new c.Map(),d[61]="is_magic_thread",d[60]=d[39].get(d[61]),d[60]!==void 0?d[59].set(d[61],d[60]):0,d[58]=d[59]):(d[47]==="XMSGAdsAIExtras"?(d[60]=new c.Map(),d[64]="context",d[61]=d[39].get(d[64]),d[61]!==void 0?d[60].set(d[64],d[61]):0,d[65]="is_reply_to_ads_ai",d[62]=d[39].get(d[65]),d[62]!==void 0?d[60].set(d[65],d[62]):0,d[66]="is_message_processed_by_lightspeed",d[63]=d[39].get(d[66]),d[63]!==void 0?d[60].set(d[66],d[63]):0,d[59]=d[60]):(d[47]==="XMSGBizappExtras"?(d[61]=new c.Map(),d[64]="message_source",d[62]=d[39].get(d[64]),d[62]!==void 0?d[61].set(d[64],d[62]):0,d[65]="message_trigger",d[63]=d[39].get(d[65]),d[63]!==void 0?d[61].set(d[65],d[63]):0,d[60]=d[61]):d[60]=d[39],d[59]=d[60]),d[58]=d[59]),d[57]=d[58]),d[56]=d[57]),d[55]=d[56]),d[54]=d[55]),d[53]=d[54]),d[52]=d[53]),d[51]=d[52]),d[50]=d[51]),d[49]=d[50]),d[48]=d[49]),d[48].set("__typename",d[47]),d[44]=d[48]),d[45]=d[44].keys(),d[46]=c.i64.of_int32(d[45].length),c.i64.neq(d[46],c.i64.cast([0,0]))?d[37].set(d[42],d[44]):0),d[34]=d[37]),d[35]=d[34].keys(),d[36]=c.i64.of_int32(d[35].length),c.i64.neq(d[36],c.i64.cast([0,0]))?d[22].set(d[30],d[34]):0),d[31]="logging_metadata",d[25]=d[21].get(d[31]),d[25]?d[26]=!1:d[26]=!0,d[26]?c.resolve():c.sequence([function(a){return d[25]?d[33]=!1:d[33]=!0,d[33]?c.resolve(d[34]=void 0):c.sequence([function(a){return d[37]=new c.Map(),d[42]="feature_tags",d[38]=d[25].get(d[42]),d[38]?d[39]=!1:d[39]=!0,d[39]?0:(d[44]=c.i64.of_int32(d[38].length),c.i64.neq(d[44],c.i64.cast([0,0]))?d[37].set(d[42],d[38]):0),d[43]="content_model",d[40]=d[25].get(d[43]),d[40]?d[41]=!1:d[41]=!0,d[41]?c.resolve():c.sequence([function(a){return d[40]?d[44]=!1:d[44]=!0,d[44]?c.resolve(d[45]=void 0):c.sequence([function(a){return d[48]=new c.Map(),d[59]="hashed_content",d[49]=d[40].get(d[59]),d[49]!==void 0?d[48].set(d[59],d[49]):0,d[60]="hashed_product_extras",d[50]=d[40].get(d[60]),d[50]!==void 0?d[48].set(d[60],d[50]):0,d[61]="client_metadata",d[51]=d[40].get(d[61]),d[51]?d[52]=!1:d[52]=!0,d[52]?0:(d[51]?d[65]=!1:d[65]=!0,d[65]?d[66]=void 0:(d[69]=d[51].get("__typename"),d[69]==="XMSGStoriesClientMetadata"?(d[71]=new c.Map(),d[73]="story_reply_type",d[72]=d[51].get(d[73]),d[72]!==void 0?d[71].set(d[73],d[72]):0,d[70]=d[71]):d[70]=d[51],d[70].set("__typename",d[69]),d[66]=d[70]),d[67]=d[66].keys(),d[68]=c.i64.of_int32(d[67].length),c.i64.neq(d[68],c.i64.cast([0,0]))?d[48].set(d[61],d[66]):0),d[62]="client_extras",d[53]=d[40].get(d[62]),d[53]?d[54]=!1:d[54]=!0,d[54]?0:(d[53]?d[65]=!1:d[65]=!0,d[65]?d[66]=void 0:(d[69]=d[53].get("__typename"),d[69]==="XMSGMarketplaceClientExtras"?(d[71]=new c.Map(),d[79]="initial_clicked_component",d[72]=d[53].get(d[79]),d[72]!==void 0?d[71].set(d[79],d[72]):0,d[80]="initial_tracking",d[73]=d[53].get(d[80]),d[73]!==void 0?d[71].set(d[80],d[73]):0,d[81]="referral_surface",d[74]=d[53].get(d[81]),d[74]!==void 0?d[71].set(d[81],d[74]):0,d[82]="referral_story_type",d[75]=d[53].get(d[82]),d[75]!==void 0?d[71].set(d[82],d[75]):0,d[83]="referral_ui_component",d[76]=d[53].get(d[83]),d[76]!==void 0?d[71].set(d[83],d[76]):0,d[84]="surface",d[77]=d[53].get(d[84]),d[77]!==void 0?d[71].set(d[84],d[77]):0,d[85]="ui_component",d[78]=d[53].get(d[85]),d[78]!==void 0?d[71].set(d[85],d[78]):0,d[70]=d[71]):d[70]=d[53],d[70].set("__typename",d[69]),d[66]=d[70]),d[67]=d[66].keys(),d[68]=c.i64.of_int32(d[67].length),c.i64.neq(d[68],c.i64.cast([0,0]))?d[48].set(d[62],d[66]):0),d[63]="containing_post",d[55]=d[40].get(d[63]),d[55]?d[56]=!1:d[56]=!0,d[56]?c.resolve():c.sequence([function(a){return d[55]?d[65]=!1:d[65]=!0,d[65]?c.resolve(d[66]=void 0):c.sequence([function(a){return d[69]=new c.Map(),d[77]="key_type",d[70]=d[55].get(d[77]),d[70]!==void 0?d[69].set(d[77],d[70]):0,d[78]="fb_post_type",d[71]=d[55].get(d[78]),d[71]?d[72]=!1:d[72]=!0,d[72]?0:(d[81]=c.i64.of_int32(d[71].length),c.i64.neq(d[81],c.i64.cast([0,0]))?d[69].set(d[78],d[71]):0),d[79]="photos",d[73]=d[55].get(d[79]),d[73]?d[74]=!1:d[74]=!0,d[74]?c.resolve():c.sequence([function(a){return d[73]?d[81]=!1:d[81]=!0,d[81]?c.resolve(d[82]=void 0):c.sequence([function(a){return d[84]=c.createArray(),d[85]=c.i64.of_int32(d[73].length),c.i64.gt(d[85],c.i64.cast([0,0]))?c.loopAsync(d[85],function(a){return d[86]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[73],d[86]).then(function(a){return a=a,d[87]=a[0],d[88]=a[1],a})},function(a){return d[89]=new c.Map(),d[91]="key_type",d[90]=d[87].get(d[91]),d[90]!==void 0?d[89].set(d[91],d[90]):0,d[92]=(d[84].push(d[89]),d[84])}])}):c.resolve()},function(a){return d[82]=d[84]}])},function(a){return d[83]=c.i64.of_int32(d[82].length),c.i64.neq(d[83],c.i64.cast([0,0]))?d[69].set(d[79],d[82]):0}])},function(a){return d[80]="videos",d[75]=d[55].get(d[80]),d[75]?d[76]=!1:d[76]=!0,d[76]?c.resolve():c.sequence([function(a){return d[75]?d[81]=!1:d[81]=!0,d[81]?c.resolve(d[82]=void 0):c.sequence([function(a){return d[84]=c.createArray(),d[85]=c.i64.of_int32(d[75].length),c.i64.gt(d[85],c.i64.cast([0,0]))?c.loopAsync(d[85],function(a){return d[86]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[75],d[86]).then(function(a){return a=a,d[87]=a[0],d[88]=a[1],a})},function(a){return d[89]=new c.Map(),d[91]="key_type",d[90]=d[87].get(d[91]),d[90]!==void 0?d[89].set(d[91],d[90]):0,d[92]=(d[84].push(d[89]),d[84])}])}):c.resolve()},function(a){return d[82]=d[84]}])},function(a){return d[83]=c.i64.of_int32(d[82].length),c.i64.neq(d[83],c.i64.cast([0,0]))?d[69].set(d[80],d[82]):0}])},function(a){return d[66]=d[69]}])},function(a){return d[67]=d[66].keys(),d[68]=c.i64.of_int32(d[67].length),c.i64.neq(d[68],c.i64.cast([0,0]))?d[48].set(d[63],d[66]):0}])},function(a){return d[64]="metadata",d[57]=d[40].get(d[64]),d[57]?d[58]=!1:d[58]=!0,d[58]?0:(d[57]?d[65]=!1:d[65]=!0,d[65]?d[66]=void 0:(d[69]=d[57].get("__typename"),d[69]==="XMSGGroupsContentLoggingMetadata"?(d[71]=new c.Map(),d[73]="num_members",d[72]=d[57].get(d[73]),c.i64.neq(d[72],void 0)?d[71].set(d[73],d[72]):0,d[70]=d[71]):(d[69]==="XMSGStoriesContentLoggingMetadata"?(d[72]=new c.Map(),d[77]="author",d[73]=d[57].get(d[77]),d[73]?d[74]=!1:d[74]=!0,d[74]?0:(d[73]?d[80]=!1:d[80]=!0,d[80]?d[81]=void 0:(d[84]=new c.Map(),d[87]="profile",d[85]=d[73].get(d[87]),d[85]?d[86]=!1:d[86]=!0,d[86]?0:(d[85]?d[88]=!1:d[88]=!0,d[88]?d[89]=void 0:(d[92]=new c.Map(),d[94]="id",d[93]=d[85].get(d[94]),d[93]!==void 0?d[92].set(d[94],d[93]):0,d[89]=d[92]),d[90]=d[89].keys(),d[91]=c.i64.of_int32(d[90].length),c.i64.neq(d[91],c.i64.cast([0,0]))?d[84].set(d[87],d[89]):0),d[81]=d[84]),d[82]=d[81].keys(),d[83]=c.i64.of_int32(d[82].length),c.i64.neq(d[83],c.i64.cast([0,0]))?d[72].set(d[77],d[81]):0),d[78]="post_source",d[75]=d[57].get(d[78]),d[75]!==void 0?d[72].set(d[78],d[75]):0,d[79]="story_type",d[76]=d[57].get(d[79]),d[76]!==void 0?d[72].set(d[79],d[76]):0,d[71]=d[72]):d[71]=d[57],d[70]=d[71]),d[70].set("__typename",d[69]),d[66]=d[70]),d[67]=d[66].keys(),d[68]=c.i64.of_int32(d[67].length),c.i64.neq(d[68],c.i64.cast([0,0]))?d[48].set(d[64],d[66]):0),d[45]=d[48]}])},function(a){return d[46]=d[45].keys(),d[47]=c.i64.of_int32(d[46].length),c.i64.neq(d[47],c.i64.cast([0,0]))?d[37].set(d[43],d[45]):0}])},function(a){return d[34]=d[37]}])},function(a){return d[35]=d[34].keys(),d[36]=c.i64.of_int32(d[35].length),c.i64.neq(d[36],c.i64.cast([0,0]))?d[22].set(d[31],d[34]):0}])},function(a){return d[32]="send_instance_metadata",d[27]=d[21].get(d[32]),d[27]?d[28]=!1:d[28]=!0,d[28]?0:(d[27]?d[33]=!1:d[33]=!0,d[33]?d[34]=void 0:(d[37]=new c.Map(),d[40]="send_instance_id",d[38]=d[27].get(d[40]),d[38]!==void 0?d[37].set(d[40],d[38]):0,d[41]="send_instance_group_size",d[39]=d[27].get(d[41]),c.i64.neq(d[39],void 0)?d[37].set(d[41],d[39]):0,d[34]=d[37]),d[35]=d[34].keys(),d[36]=c.i64.of_int32(d[35].length),c.i64.neq(d[36],c.i64.cast([0,0]))?d[22].set(d[32],d[34]):0),d[29]=c.toJSON(d[22]),d[10]=d[29]}])},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[11]=c.i64.cast([0,1]):(b=a.item,d[21]=b.syncGroup,c.i64.neq(d[21],void 0)?d[20]=d[21]:d[20]=c.i64.cast([0,1]),d[11]=d[20])})},function(e){return d[13]=new c.Map(),d[13].set("thread_key",a[0]),d[13].set("timestamp_ms",a[1]),d[13].set("message_id",a[2]),d[13].set("actor_id",a[3]),d[13].set("reaction",a[4]),d[13].set("reaction_style",void 0),d[13].set("sync_group",d[11]),d[13].set("send_attribution",a[5]),d[13].set("dataclass_params",d[10]),d[13].set("attachment_fbid",void 0),d[14]=c.createArray(),d[15]=(d[14].push("reaction"),d[14]),d[16]=d[13].get("message_id"),d[17]=(d[14].push(d[16]),d[14]),d[18]=c.toJSON(d[14]),d[19]=c.toJSON(d[13]),c.storedProcedure(b("LSIssueNewTask"),d[18],c.i64.cast([0,29]),d[19],void 0,void 0,a[6]==null?c.i64.cast([0,0]):a[6],c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticUpsertReactionStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSOptimisticUpsertReactionStoredProcedure",["LSOptimisticUpsertReaction","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticUpsertReaction"),e.threadKey,e.timestampMs,e.messageId,e.actorId,e.reaction,e.sendAttribution,e.pluginType);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSOptimisticUpsertReactionV2",["LSCancelTaskByQueueName","LSDeleteReaction","LSIssueNewTaskWithExtraOperations","LSUpdateOrInsertReactionV2","LSUpsertReaction"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return c.i64.eq(a[8],c.i64.cast([0,2]))?c.sequence([function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[16]=c.i64.cast([0,1]):(b=a.item,d[25]=b.syncGroup,c.i64.neq(d[25],void 0)?d[24]=d[25]:d[24]=c.i64.cast([0,1]),d[16]=d[24])})},function(e){return d[18]=new c.Map(),d[18].set("thread_id",a[1]),d[18].set("message_id",a[2]),d[18].set("message_timestamp",a[3]),d[18].set("actor_id",a[0]),d[18].set("reaction_fbid",a[4]),d[18].set("reaction_style",a[7]),d[18].set("operation",a[8]),d[18].set("viewer_is_reactor",a[6]),d[18].set("current_count",a[5]),d[18].set("reaction_literal",a[9]),d[18].set("sync_group",d[16]),d[19]=c.createArray(),d[20]=(d[19].push("reaction_v2"),d[19]),d[21]=d[18].get("message_id"),d[22]=(d[19].push(d[21]),d[19]),d[23]=c.toJSON(d[19]),c.storedProcedure(b("LSCancelTaskByQueueName"),d[23],c.i64.cast([0,604]))}]):c.resolve()},function(e){return[c.i64.cast([0,2]),c.i64.cast([0,3])].some(function(b){return c.i64.eq(a[8],b)})?d[0]=c.i64.add(a[5],c.i64.cast([-1,4294967295])):d[0]=c.i64.add(a[5],c.i64.cast([0,1])),[c.i64.cast([0,2]),c.i64.cast([0,3])].some(function(b){return c.i64.eq(a[8],b)})?d[1]=!1:d[1]=!0,d[2]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSUpdateOrInsertReactionV2"),a[1],a[2],a[4],a[9],d[0],c.i64.cast([0,20]),d[1],c.i64.cast([0,0]),d[2])},function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[3]=void 0:(b=a.item,d[3]=b.threadType)})},function(e){return c.i64.neq(d[3],c.i64.cast([0,23]))?[c.i64.cast([0,2]),c.i64.cast([0,3])].some(function(b){return c.i64.eq(a[8],b)})?c.i64.eq(a[8],c.i64.cast([0,2]))?c.storedProcedure(b("LSDeleteReaction"),a[1],a[2],a[0]):c.sequence([function(b){return c.filter(c.db.table(8).fetch([[[a[1],a[2],a[0]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===a[2]&&c.i64.eq(b.actorId,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[16]=void 0:(b=a.item,d[16]=b.reaction)})},function(e){return a[9]!==void 0?(a[9]==="\u2764\ufe0f"||a[9]==="\u2764\ufe0f"?d[18]="\u2764":d[18]=a[9],d[18]===d[16]?c.storedProcedure(b("LSDeleteReaction"),a[1],a[2],a[0]):c.resolve()):c.resolve()}]):a[9]!==void 0?(a[9]==="\u2764\ufe0f"||a[9]==="\u2764\ufe0f"?d[16]="\u2764":d[16]=a[9],d[17]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSUpsertReaction"),a[1],a[3],a[2],a[0],d[16],c.i64.cast([0,20]),d[17])):c.resolve():c.resolve()},function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[5]=c.i64.cast([0,1]):(b=a.item,d[17]=b.syncGroup,c.i64.neq(d[17],void 0)?d[16]=d[17]:d[16]=c.i64.cast([0,1]),d[5]=d[16])})},function(b){return d[7]=new c.Map(),d[7].set("thread_id",a[1]),d[7].set("message_id",a[2]),d[7].set("message_timestamp",a[3]),d[7].set("actor_id",a[0]),d[7].set("reaction_fbid",a[4]),d[7].set("reaction_style",a[7]),d[7].set("current_count",a[5]),d[7].set("viewer_is_reactor",a[6]),d[7].set("operation",a[8]),d[7].set("reaction_literal",a[9]),d[7].set("entry_point",void 0),d[7].set("sync_group",d[5]),c.db.table(9).fetch([[[a[1]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?d[8]=!1:(e=b.item,c.sequence([function(b){return c.filter(c.db.table(14).fetch([[[e.threadKey,a[0]]]]),function(b){return c.i64.eq(b.threadKey,e.threadKey)&&c.i64.eq(c.i64.cast([0,0]),e.mailboxType)&&c.i64.eq(b.contactId,a[0])}).next().then(function(b,f){var a=b.done;b=b.value;return a?d[16]=!1:(f=b.item,c.i64.eq(e.threadType,c.i64.cast([0,152]))?(d[19]=f.threadRoles,c.i64.lt(c.i64.cast([0,7]),c.i64.cast([0,0]))||c.i64.gt(c.i64.cast([0,7]),c.i64.cast([0,7]))?d[20]=!1:d[20]=!c.i64.eq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,7]))),d[19]),c.i64.cast([0,0])),d[21]=e.capabilities,d[22]=e.capabilities2,d[23]=e.capabilities3,d[24]=e.capabilities4,d[25]=e.capabilities5,d[27]=c.i64.div(c.i64.cast([0,223]),c.i64.cast([0,64])),d[28]=c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.sub(c.i64.cast([0,223]),c.i64.mul(d[27],c.i64.cast([0,64]))))),c.i64.lt(c.i64.cast([0,223]),c.i64.cast([0,0]))||c.i64.gt(c.i64.cast([0,223]),c.i64.cast([0,281]))?d[26]=!1:(c.i64.eq(d[27],c.i64.cast([0,0]))?d[29]=!c.i64.eq(c.i64.and_(d[28],d[21]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,1]))?d[30]=!c.i64.eq(c.i64.and_(d[28],d[22]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,2]))?d[31]=!c.i64.eq(c.i64.and_(d[28],d[23]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,3]))?d[32]=!c.i64.eq(c.i64.and_(d[28],d[24]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,4]))?d[33]=!c.i64.eq(c.i64.and_(d[28],d[25]),c.i64.cast([0,0])):d[33]=!1,d[32]=d[33]),d[31]=d[32]),d[30]=d[31]),d[29]=d[30]),d[26]=d[29]),d[20]===d[26]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),c["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),d[18]=d[20]):d[18]=!1,d[16]=d[18])})},function(a){return d[8]=d[16]}]))})},function(a){return d[8]?d[7].set("perform_action_as_page",!0):0,d[10]=c.createArray(),d[11]=(d[10].push("reaction_v2"),d[10]),d[12]=d[7].get("message_id"),d[13]=(d[10].push(d[12]),d[10]),d[14]=c.toJSON(d[10]),d[15]=c.toJSON(d[7]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),d[14],c.i64.cast([0,604]),d[15],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticUpsertReactionV2StoredProcedure";a.__tables__=["threads","reactions","participants"];e.exports=a}),null);
__d("LSOptimisticUpsertReactionV2StoredProcedure",["LSOptimisticUpsertReactionV2","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticUpsertReactionV2"),e.actorId,e.threadId,e.messageId,e.messageTimestamp,e.reactionFbid,e.currentCount,e.viewerIsReactor,e.reactionStyle,e.operation,e.reactionLiteral);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSRelayHooks",["ExecTimeResolverHooks"],(function(a,b,c,d,e,f){"use strict";Object.keys(importNamespace("ExecTimeResolverHooks")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("ExecTimeResolverHooks")[a]})}),null);
__d("LSRemoveMediaSendJobs",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMediaSendRemoveMediaSendJobsStoredProcedure";a.__tables__=["media_send_jobs"];e.exports=a}),null);
__d("LSRemoveMediaSendJobsStoredProcedure",["LSRemoveMediaSendJobs","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSRemoveMediaSendJobs"),e.offlineThreadingId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSSendPhase1MultiPhotoMessageV2",["LSArrayGetObjectAt","LSGetMessageAttributionParams","LSIssueSendAttachmentMessageTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.createArray(),d[1]=new c.Map(),d[2]=new c.Map(),d[3]=!1,d[4]=c.i64.cast([0,0]),c.forEach(c.sortBy(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[7]=a.fbid,d[4]=c.i64.add(d[4],c.i64.cast([0,1])),c.i64.neq(d[7],void 0)?d[8]=(d[0].push(d[7]),d[0]):0})},function(e){return d[5]=c.i64.of_int32(d[0].length),c.i64.neq(d[5],d[4])||c.i64.eq(d[4],c.i64.cast([0,0]))?c.resolve(d[6]=c.i64.cast([0,10002])):c.sequence([function(b){return c.db.table(12).fetch([[[a[0]]],"optimistic"]).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[void 0,void 0,void 0,void 0,void 0],d[7]=c[0],d[8]=c[1],d[9]=c[2],d[10]=c[3],d[11]=c[4],c):(b=a.item,c=[b.threadKey,b.senderId,b.text,b.replySourceId,b.replySourceTypeV2],d[7]=c[0],d[8]=c[1],d[9]=c[2],d[10]=c[3],d[11]=c[4],c)})},function(e){return c.i64.eq(d[7],void 0)||c.i64.eq(d[8],void 0)?c.resolve((c.i64.eq(d[7],void 0)?d[14]=c.i64.cast([0,10003]):d[14]=c.i64.cast([0,10004]),d[13]=d[14])):c.sequence([function(a){return c.db.table(9).fetch([[[d[7]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[14]=void 0:(b=a.item,d[14]=b.threadType)})},function(b){return c.filter(c.db.table(31).fetch(),function(b){return b.offlineThreadingId===a[0]}).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=[void 0,void 0,void 0,void 0,void 0,void 0,void 0],d[16]=c[0],d[17]=c[1],d[18]=c[2],d[19]=c[3],d[20]=c[4],d[21]=c[5],d[22]=c[6],c):(b=a.item,c=[b.platformRef,b.platformToken,b.initiatingSource,void 0,void 0,b.dataclassParams,void 0],d[16]=c[0],d[17]=c[1],d[18]=c[2],d[19]=c[3],d[20]=c[4],d[21]=c[5],d[22]=c[6],c)})},function(e){return c.i64.neq(d[14],void 0)?c.sequence([function(e){return d[25]=d[1].keys(),d[26]=c.i64.of_int32(d[25].length),c.i64.gt(d[26],c.i64.cast([0,0]))?c.loopAsync(d[26],function(e){return d[32]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[25],d[32]).then(function(a){return a=a,d[33]=a[0],d[34]=a[1],a})},function(e){return d[35]=d[2].get(d[33]),d[36]=c.i64.to_string(d[35]),d[36]!==void 0?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[25],d[32]).then(function(a){return a=a,d[37]=a[0],d[38]=a[1],a})},function(b){return d[39]=d[1].get(d[33]),c.forEach(c.filter(c.db.table(16).fetch([[[d[7],a[0],d[37]]]]),function(b){return c.i64.eq(b.threadKey,d[7])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&b.messageId===a[0]&&b.attachmentFbid===d[37]}),function(a){var b=a.update;a.item;return b({attachmentFbid:d[36],originalFileHash:d[39]})})}]):c.resolve()}])}):c.resolve()},function(e){return c.storedProcedure(b("LSGetMessageAttributionParams"),a[0]).then(function(a){return a=a,d[27]=a[0],d[28]=a[1],d[29]=a[2],a})},function(e){return c.i64.neq(d[27],void 0)?d[30]=d[27]:d[30]=c.i64.cast([0,0]),c.storedProcedure(b("LSIssueSendAttachmentMessageTask"),d[8],d[7],d[14],a[0],d[9],d[0],d[30],d[10],d[11],d[3],d[16],d[17],a[1])},function(a){return c.i64.ge(c.i64.cast([0,0]),c.i64.cast([0,0]))?d[31]=void 0:d[31]=c.i64.cast([0,10006]),d[24]=d[31]}]):c.resolve(d[24]=c.i64.cast([0,10005]))},function(a){return d[13]=d[24]}])},function(a){return d[6]=d[13]}])},function(a){return e[0]=d[6]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMediaSendSendPhase1MultiPhotoMessageV2StoredProcedure";a.__tables__=["media_send_jobs","messages","threads","messages_optimistic_context","attachments"];e.exports=a}),null);
__d("LSResumeMediaSendJob",["LSInsertPhase2PendingTask","LSSendPhase1MultiPhotoMessageV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=new c.Map(),d[1]=new c.Map(),d[1].set("main_job_succeeded",!1),d[1].set("resume_failed",!1),d[1].set("error",void 0),d[1].set("running_sub_job_states",d[0]),d[2]=new c.Map(),d[2].set("should_transcode",!1),d[2].set("use_double_phase",!1),d[2].set("send_by_server",!1),d[2].set("is_secure",!1),d[2].set("should_dedupe",!1),d[2].set("is_optimistic_upload",!1),c.sortBy(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["state","ASC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?0:(b=a.item,d[2].set("should_transcode",b.shouldTranscode),d[2].set("use_double_phase",b.useDoublePhase),d[2].set("send_by_server",b.sendByServer),d[2].set("is_secure",b.isSecure),d[2].set("is_optimistic_upload",!1))})},function(b){return d[4]=new c.Map(),c.forEach(c.sortBy(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[13]=a.offlineAttachmentId,d[11]=a.state,d[12]=a.error,c.i64.eq(d[11],c.i64.cast([-1,4294967293]))?d[10]=!0:(c.i64.eq(d[11],c.i64.cast([0,1]))?d[14]=!0:(c.i64.eq(d[11],c.i64.cast([0,3]))?d[15]=!0:(c.i64.eq(d[11],c.i64.cast([0,5]))?d[16]=!0:(c.i64.eq(d[11],c.i64.cast([0,13]))?d[17]=!0:(c.i64.eq(d[11],c.i64.cast([0,7]))?d[18]=!0:(c.i64.eq(d[11],c.i64.cast([0,9]))?d[19]=!0:(c.i64.eq(d[11],c.i64.cast([0,11]))?d[20]=!0:d[20]=!1,d[19]=d[20]),d[18]=d[19]),d[17]=d[18]),d[16]=d[17]),d[15]=d[16]),d[14]=d[15]),d[10]=d[14]),d[10]?c.resolve(c.i64.eq(d[11],c.i64.cast([0,5]))||c.i64.eq(d[11],c.i64.cast([0,11]))?0:d[4].set(d[13],d[11])):c.i64.neq(d[12],void 0)?c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[12]))):(c.i64.eq(d[11],c.i64.cast([-1,4294967295]))?d[14]=c.i64.cast([0,5]):(c.i64.eq(d[11],c.i64.cast([-1,4294967294]))?(d[16]=d[2].get("should_transcode"),d[15]=d[16]?c.i64.cast([0,1]):c.i64.cast([0,3])):(c.i64.eq(d[11],c.i64.cast([0,2]))?d[16]=c.i64.cast([0,3]):(c.i64.eq(d[11],c.i64.cast([0,4]))?(d[18]=d[2].get("send_by_server"),d[19]=d[2].get("use_double_phase"),d[17]=d[18]?d[19]?c.i64.cast([0,13]):void 0:c.i64.cast([0,5])):(c.i64.eq(d[11],c.i64.cast([0,6]))?(d[19]=d[2].get("use_double_phase"),d[18]=d[19]?c.i64.cast([0,13]):void 0):(c.i64.eq(d[11],c.i64.cast([0,14]))?(d[20]=d[2].get("use_double_phase"),d[21]=d[2].get("should_transcode"),d[19]=d[20]?d[21]?c.i64.cast([0,7]):c.i64.cast([0,9]):void 0):(c.i64.eq(d[11],c.i64.cast([0,8]))?d[20]=c.i64.cast([0,9]):(c.i64.eq(d[11],c.i64.cast([0,10]))?(d[22]=d[2].get("send_by_server"),d[21]=d[22]?void 0:c.i64.cast([0,11])):(c.i64.eq(d[11],c.i64.cast([0,12]))?d[22]=void 0:d[22]=void 0,d[21]=d[22]),d[20]=d[21]),d[19]=d[20]),d[18]=d[19]),d[17]=d[18]),d[16]=d[17]),d[15]=d[16]),d[14]=d[15]),c.i64.neq(d[14],void 0)?c.sequence([function(a){return c.forEach(c.db.table(51).fetch([[[d[13]]]]),function(a){var b=a.update;a.item;return b({state:d[14]})})},function(a){return c.i64.eq(d[14],c.i64.cast([0,5]))||c.i64.eq(d[14],c.i64.cast([0,11]))?0:d[4].set(d[13],d[14])}]):c.resolve())})},function(b){return c.sortBy(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["state","ASC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[5]=void 0:(b=a.item,d[5]=b.state)})},function(e){return c.i64.neq(d[5],void 0)?(d[10]=d[2].get("send_by_server"),d[11]=d[2].get("use_double_phase"),d[12]=d[2].get("use_double_phase"),(d[10]?d[11]?c.i64.eq(d[5],c.i64.cast([0,10])):c.i64.eq(d[5],c.i64.cast([0,4])):d[12]?c.i64.eq(d[5],c.i64.cast([0,12])):c.i64.eq(d[5],c.i64.cast([0,6])))?c.resolve(d[1].set("main_job_succeeded",!0)):c.i64.eq(d[5],c.i64.cast([0,5]))?c.sequence([function(b){return d[13]=void 0,c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[15]=a.error,c.i64.eq(d[15],void 0)?(c.i64.neq(a.fbid,void 0)?d[16]=void 0:d[16]=c.i64.cast([0,9]),d[14]=d[16]):d[14]=d[15],c.i64.neq(d[14],void 0)?d[13]=d[14]:0})},function(e){return c.i64.neq(d[13],void 0)?c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[13]))):(d[14]=d[2].get("is_optimistic_upload"),d[14]?(d[15]=d[2].get("send_by_server"),d[16]=d[2].get("use_double_phase"),d[17]=d[2].get("use_double_phase"),(d[15]?d[16]?c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,10])):c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,4])):d[17]?c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,12])):c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,6])))?c.resolve(d[1].set("main_job_succeeded",!0)):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([-1,4294967295]))?d[18]=c.i64.cast([0,5]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([-1,4294967294]))?(d[20]=d[2].get("should_transcode"),d[19]=d[20]?c.i64.cast([0,1]):c.i64.cast([0,3])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,2]))?d[20]=c.i64.cast([0,3]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,4]))?(d[22]=d[2].get("send_by_server"),d[23]=d[2].get("use_double_phase"),d[21]=d[22]?d[23]?c.i64.cast([0,13]):void 0:c.i64.cast([0,5])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,6]))?(d[23]=d[2].get("use_double_phase"),d[22]=d[23]?c.i64.cast([0,13]):void 0):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,14]))?(d[24]=d[2].get("use_double_phase"),d[25]=d[2].get("should_transcode"),d[23]=d[24]?d[25]?c.i64.cast([0,7]):c.i64.cast([0,9]):void 0):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,8]))?d[24]=c.i64.cast([0,9]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,10]))?(d[26]=d[2].get("send_by_server"),d[25]=d[26]?void 0:c.i64.cast([0,11])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,12]))?d[26]=void 0:d[26]=void 0,d[25]=d[26]),d[24]=d[25]),d[23]=d[24]),d[22]=d[23]),d[21]=d[22]),d[20]=d[21]),d[19]=d[20]),d[18]=d[19]),c.i64.neq(d[18],void 0)?c.sequence([function(b){return c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){var b=a.update;a.item;return b({state:d[18]})})},function(b){return c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[4].set(a.offlineAttachmentId,a.state)})}]):c.resolve())):c.sequence([function(e){return d[15]=d[2].get("is_secure"),d[15]?c.sequence([function(b){return d[17]=c.createArray(),d[18]=new c.Map(),d[19]=new c.Map(),d[20]=!1,d[21]=c.i64.cast([0,0]),c.forEach(c.sortBy(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[26]=a.fbid,d[21]=c.i64.add(d[21],c.i64.cast([0,1])),c.i64.neq(d[26],void 0)?d[27]=(d[17].push(d[26]),d[17]):0})},function(b){return d[22]=c.createArray(),c.forEach(c.sortBy(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),[["inMessageIndex","ASC"]]),function(a){a=a.item;return d[26]=a.metadata,d[26]!==void 0?d[27]=(d[22].push(d[26]),d[22]):0})},function(a){return d[23]=c.i64.of_int32(d[17].length),d[24]=c.i64.of_int32(d[22].length),c.i64.neq(d[23],d[21])||c.i64.neq(d[24],d[21])?d[25]=c.i64.cast([0,11]):(function(a){c.logger(a).debug(a)}("[TincanLS][LSSecureMailboxSendSecureMediaMessageStoredProcedure] Started"),function(a){c.logger(a).debug(a)}("[TincanLS][LSSecureMailboxSendSecureMediaMessageStoredProcedure] Completed"),d[25]=void 0),d[16]=d[25]}]):c.sequence([function(e){return c.storedProcedure(b("LSSendPhase1MultiPhotoMessageV2"),a[0],a[2]).then(function(a){return a=a,d[17]=a[0],a})},function(b){return c.i64.eq(d[17],void 0)?c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){var b=a.update;a.item;return b({state:c.i64.cast([0,6])})}):c.resolve()},function(a){return d[16]=d[17]}])},function(b){return c.i64.eq(d[16],void 0)?(d[17]=d[2].get("send_by_server"),d[18]=d[2].get("use_double_phase"),d[19]=d[2].get("use_double_phase"),(d[17]?d[18]?c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,10])):c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,4])):d[19]?c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,12])):c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,6])))?c.resolve(d[1].set("main_job_succeeded",!0)):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([-1,4294967295]))?d[20]=c.i64.cast([0,5]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([-1,4294967294]))?(d[22]=d[2].get("should_transcode"),d[21]=d[22]?c.i64.cast([0,1]):c.i64.cast([0,3])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,2]))?d[22]=c.i64.cast([0,3]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,4]))?(d[24]=d[2].get("send_by_server"),d[25]=d[2].get("use_double_phase"),d[23]=d[24]?d[25]?c.i64.cast([0,13]):void 0:c.i64.cast([0,5])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,6]))?(d[25]=d[2].get("use_double_phase"),d[24]=d[25]?c.i64.cast([0,13]):void 0):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,14]))?(d[26]=d[2].get("use_double_phase"),d[27]=d[2].get("should_transcode"),d[25]=d[26]?d[27]?c.i64.cast([0,7]):c.i64.cast([0,9]):void 0):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,8]))?d[26]=c.i64.cast([0,9]):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,10]))?(d[28]=d[2].get("send_by_server"),d[27]=d[28]?void 0:c.i64.cast([0,11])):(c.i64.eq(c.i64.cast([0,6]),c.i64.cast([0,12]))?d[28]=void 0:d[28]=void 0,d[27]=d[28]),d[26]=d[27]),d[25]=d[26]),d[24]=d[25]),d[23]=d[24]),d[22]=d[23]),d[21]=d[22]),d[20]=d[21]),c.i64.neq(d[20],void 0)?c.sequence([function(b){return c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){var b=a.update;a.item;return b({state:d[20]})})},function(b){return c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[4].set(a.offlineAttachmentId,a.state)})}]):c.resolve())):c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[16])))}]))}]):c.i64.eq(d[5],c.i64.cast([0,11]))?c.sequence([function(b){return d[13]=void 0,c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[14]=a.error,c.i64.neq(d[14],void 0)?d[13]=d[14]:0})},function(a){return c.i64.neq(d[13],void 0)?(d[1].set("resume_failed",!0),d[1].set("error",d[13])):d[1].set("main_job_succeeded",!0)}]):c.i64.eq(d[5],c.i64.cast([0,13]))?c.sequence([function(e){return c.storedProcedure(b("LSInsertPhase2PendingTask"),a[0],a[1]).then(function(a){return a=a,d[13]=a[0],a})},function(b){return c.i64.neq(d[13],void 0)?c.resolve((d[1].set("resume_failed",!0),d[1].set("error",d[13]))):c.sequence([function(b){return c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){var b=a.update;a.item;return b({state:c.i64.cast([0,14])})})},function(b){return d[1].set("main_job_succeeded",!0),c.forEach(c.filter(c.db.table(51).fetch(),function(b){return b.offlineThreadingId===a[0]}),function(a){a=a.item;return d[4].set(a.offlineAttachmentId,a.state)})}])}]):c.resolve(0)):c.resolve((d[1].set("resume_failed",!0),d[1].set("error",c.i64.cast([0,11]))))},function(a){return d[7]=d[1].get("main_job_succeeded"),d[8]=d[1].get("resume_failed"),d[9]=d[1].get("error"),a=[d[7],d[8],d[9],d[4]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMediaSendResumeMediaSendJobStoredProcedure";a.__tables__=["media_send_jobs"];e.exports=a}),null);
__d("LSResumeMediaSendJobStoredProcedure",["LSResumeMediaSendJob","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSResumeMediaSendJob"),e.jobId,e.pluginType,e.dataTraceId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSSubmitGenAIBotFeedback",["LSIssueNewTaskWithExtraOperations"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("bot_feedback_kind",a[0]),d[0].set("bot_response_id",a[2]),d[0].set("feedback_kind_type",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),"submit_gen_ai_bot_feedback",c.i64.cast([0,756]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))},function(b){return c.db.table(315).fetch([[[a[2]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[2]=c.i64.cast([0,0]):(b=a.item,d[2]=b.feedbackSubmissionStatus)})},function(b){return c.i64.eq(d[2],c.i64.cast([0,0]))?c.db.table(315).add({botResponseId:a[2],feedbackSubmissionStatus:c.i64.cast([0,1]),feedbackKindType:a[0]}):c.forEach(c.db.table(315).fetch([[[a[2]]]]),function(b){var d=b.update;b.item;return d({feedbackSubmissionStatus:c.i64.cast([0,1]),feedbackKindType:a[0]})})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxSubmitGenAIBotFeedbackStoredProcedure";a.__tables__=["ai_bot_feedback_submission_status"];e.exports=a}),null);
__d("LSSubmitGenAIBotFeedbackStoredProcedure",["LSSubmitGenAIBotFeedback","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSSubmitGenAIBotFeedback"),e.botFeedbackKind,e.feedbackKindType,e.botResponseId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSTaskType",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["BatchLookup","CreateThread","DeleteMessage","DeviceRegistration","DisableDevice","EnableDevice","MessageRangeQuery","PreKeyUpload","SendMessage","SendOrRemoveReaction","UnsendMessage","VerifyThreadChecksum"]);c=a;f["default"]=c}),66);
__d("LSTasks",["FBLogger","I64","LSIntEnum","LSJson","LSPendingTasksPluginType","LSTaskType"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){switch(a){case c("LSTaskType").BatchLookup:return"10003";case c("LSTaskType").CreateThread:return"10002";case c("LSTaskType").DeleteMessage:return"155";case c("LSTaskType").DeviceRegistration:return"10001";case c("LSTaskType").DisableDevice:return"10007";case c("LSTaskType").EnableDevice:return"10006";case c("LSTaskType").MessageRangeQuery:return"14";case c("LSTaskType").PreKeyUpload:return"10004";case c("LSTaskType").SendMessage:return"10005";case c("LSTaskType").SendOrRemoveReaction:return"29";case c("LSTaskType").UnsendMessage:return"33";case c("LSTaskType").VerifyThreadChecksum:throw c("FBLogger")("messenger_web").mustfixThrow("[LS] Not a supported task type")}}async function a(a,b,e,f){await a.pending_tasks.add({context:j(b),dataTraceId:void 0,enqueueTimestampMs:(h||(h=d("I64"))).of_float(Date.now()),failureCount:h.zero,firstExecutedTimestampMs:h.zero,httpUrlOverride:void 0,initTraceTimestampMs:void 0,minTimeToSyncTimestampMs:h.zero,pluginType:(i||(i=d("LSIntEnum"))).ofNumber(c("LSPendingTasksPluginType").LS_BROKER),priority:h.zero,queueName:e,syncGroupId:void 0,taskValue:d("LSJson").stringify(f),timeoutTimestampMs:void 0})}g.enqueue=a}),98);
__d("LsMessageSearchEndFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4190");b=d("FalcoLoggerInternal").create("ls_message_search_end",a);e=b;g["default"]=e}),98);
__d("LsMessageSearchMsgImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4191");b=d("FalcoLoggerInternal").create("ls_message_search_msg_impression",a);e=b;g["default"]=e}),98);
__d("LsMessageSearchMsgResultChosenFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4231");b=d("FalcoLoggerInternal").create("ls_message_search_msg_result_chosen",a);e=b;g["default"]=e}),98);
__d("LsMessageSearchSearchClickedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4464");b=d("FalcoLoggerInternal").create("ls_message_search_search_clicked",a);e=b;g["default"]=e}),98);
__d("LsMessageSearchStartFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4683");b=d("FalcoLoggerInternal").create("ls_message_search_start",a);e=b;g["default"]=e}),98);
__d("LsMessageSearchThreadImpressionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("6727");b=d("FalcoLoggerInternal").create("ls_message_search_thread_impression",a);e=b;g["default"]=e}),98);
__d("LsMessageSearchThreadListClickFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("6293");b=d("FalcoLoggerInternal").create("ls_message_search_thread_list_click",a);e=b;g["default"]=e}),98);
__d("MAWAudioUtils",["FBLogger","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var d=URL.createObjectURL(a);return new(h||(h=b("Promise")))(function(a,b){var e=new Audio();e.setAttribute("crossOrigin","anonymous");e.addEventListener("loadedmetadata",function(c){c=c.currentTarget;if(c instanceof HTMLAudioElement){c=c.duration;a(Math.ceil(c))}else b("EventTarget returned for event should be HTMLAudioElement")});e.src=d;e.onabort=function(){b(function(){throw c("FBLogger")("messenger_web").mustfixThrow("Error loading audio from provided URL")})};e.onerror=function(){b(function(){throw c("FBLogger")("messenger_web").mustfixThrow("Wrong blob type")})}})}g.getAudioDurationInSeconds=a}),98);
__d("MAWAudioPreProcess",["MAWAudioUtils","WABlobToArrayBuffer","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["start optimistic audio preprocess"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start audio preprocess"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["MAWAudioPreProcess"]);function b(a){j.LOG(i());return d("MAWAudioUtils").getAudioDurationInSeconds(a).then(async function(b){return{durations:b,file:a,isPtt:!0,plaintext:await d("WABlobToArrayBuffer").blobToArrayBuffer(a),type:"audio"}})}function c(b){var c=a.URL.createObjectURL(b);j.LOG(h());return d("MAWAudioUtils").getAudioDurationInSeconds(b).then(function(a){return Promise.resolve({durations:a,file:b,isPtt:!0,type:"audio",url:c})})}g.audioPreprocess=b;g.optimisticAudioPreprocess=c}),98);
__d("MAWDocumentPreProcess",["WABlobToArrayBuffer","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["start optimistic document preprocess"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start document preprocess"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["MAWDocumentPreProcess"]);async function b(a){j.DEV(i());return Promise.resolve({file:a,filename:a.name,plaintext:await d("WABlobToArrayBuffer").blobToArrayBuffer(a),type:"document"})}function c(b){j.DEV(h());var c=a.URL.createObjectURL(b);return Promise.resolve({file:b,filename:b.name,type:"document",url:c})}g.documentPreprocess=b;g.optimisticDocumentPreprocess=c}),98);
__d("MAWMediaReceiverFetchDoneCallbackMap",[],(function(a,b,c,d,e,f){"use strict";a=new Map();b=a;f["default"]=b}),66);
__d("MAWIssueReceiverFetchTask",["LSDispatchMediaReceiverFetchForWebStoredProcedure","LSFactory","MAWMediaDownloadStatus","MAWMediaReceiverFetchDoneCallbackMap","WAHashUtils","cr:17326","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,g,h,i){b("cr:17326")==null?i==null?void 0:i({tag:"UpdateMediaStatus",value:{details:"issue_receiver_fetch_task",key:d("WAHashUtils").stringToPlaintextHash(e),status:c("MAWMediaDownloadStatus").DOWNLOADING,type:"main"}}):c("promiseDone")(b("cr:17326").call(a,{details:"issue_receiver_fetch_task",key:d("WAHashUtils").stringToPlaintextHash(e),status:c("MAWMediaDownloadStatus").DOWNLOADING,type:"main"}));c("MAWMediaReceiverFetchDoneCallbackMap").set(e,function(a){b("cr:17326")==null&&(i==null?void 0:i({tag:"UpdateMediaStatus",value:{details:"issue_receiver_fetch_task_callback",key:d("WAHashUtils").stringToPlaintextHash(e),status:a==="success"?c("MAWMediaDownloadStatus").SUCCESS:c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,type:"main"}}))});return a.runInTransaction(function(a){return c("LSDispatchMediaReceiverFetchForWebStoredProcedure")(c("LSFactory")(a),{messageId:e,receiverFetchId:g,shouldFetchAccessibilitySummaryText:!0,threadKey:h})},"readwrite",void 0,void 0,f.id+":75")}g.issueReceiverFetchTask=a}),98);
__d("MAWMediaDownloadStatusUIStateType",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null)return!1;switch(a){case"non_retryable_error":case"non_retryable_error_with_preview":case"retryable_error":case"retryable_error_with_preview":return!0;default:return!1}}function b(a){if(a==null)return!1;switch(a){case"retryable_error":case"retryable_error_with_preview":return!0;default:return!1}}f.isErrorState=a;f.isRetryableErrorState=b}),66);
__d("MAWSendVideoToWorker",["MAWMediaWorkerResource","Promise","WALogger","WebWorker"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clean up media worker"]);i=function(){return a};return a}var j=k();function a(a){var c;return new(h||(h=b("Promise")))(function(b){c=j&&l(j)?k():j,c.setMessageHandler(function(a){b(a)}).execute(),c.postMessage(a)})["finally"](function(){c&&(d("WALogger").LOG(i()),c.terminate(),(!j||!j.isCurrentState("constructed"))&&(j=k()))})}function k(){return new(c("WebWorker"))(c("MAWMediaWorkerResource")).setAllowCrossPageTransition(!0)}function l(a){return a.isCurrentState("preparing")||a.isCurrentState("executing")}g.sendVideoMessageToWorker=a}),98);
__d("useShouldShowPlaybackErrorFallback",["MAWVideoAudioPlaybackErrorHandlerUtils","cr:5868","react-compiler-runtime","useEmptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h=(e=b("cr:5868"))!=null?e:c("useEmptyFunction");function a(a,b){var c=d("react-compiler-runtime").c(3);b=(b=h(a,b))!=null?b:{};b=b.validationResult;if(a==null)return!1;var e;c[0]!==a||c[1]!==b?(e=d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideo(a,b),c[0]=a,c[1]=b,c[2]=e):e=c[2];return e}g["default"]=a}),98);
__d("useShouldShowUnsupportedCodecFallback",["MAWVideoAudioPlaybackErrorHandlerUtils","cr:5868","react-compiler-runtime","useEmptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h=(e=b("cr:5868"))!=null?e:c("useEmptyFunction");function a(a,b){var c=d("react-compiler-runtime").c(3);b=(b=h(a,b))!=null?b:{};b=b.validationResult;if(a==null)return!1;var e;c[0]!==a||c[1]!==b?(e=d("MAWVideoAudioPlaybackErrorHandlerUtils").isUnsupportedVideo(a,b),c[0]=a,c[1]=b,c[2]=e):e=c[2];return e}g["default"]=a}),98);
__d("useMAWBulkMediaValidationResult",["I64","LSIntEnum","MAWBridgeSendAndReceive","MAWClientMediaStatusUtils","MAWDbMedia","MAWStateContext.react","MessagingAttachmentType","WAHashUtils","cr:17327","cr:17328","cr:17330","promiseDone","react","react-compiler-runtime","useAsyncReStore","useEmptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e=h||d("react");var k=e.useContext,l=e.useEffect;e.useMemo;var m=(f=b("cr:17327"))!=null?f:c("useEmptyFunction"),n=(e=b("cr:17328"))!=null?e:c("useEmptyFunction"),o=new Set();function p(a){var e=d("react-compiler-runtime").c(5),f=c("useAsyncReStore")(),g=k(d("MAWStateContext.react").MAWDispatchContext),h,m;e[0]!==a||e[1]!==f||e[2]!==g?(h=function(){a.forEach(function(a){var e=a.attachment;a=a.mediaRenderQpl;var h=(i||(i=d("I64"))).equal(e.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)),k=i.equal(e.attachmentType,j.ofNumber(c("MessagingAttachmentType").AUDIO)),l=e.attachmentFbid;if(!o.has(l)&&(h||k)){o.add(l);var m=isNaN(l);e=m?d("MAWBridgeSendAndReceive").sendAndReceive("backend","getMediaValidationResultByPlainTextHash",{plaintextHash:d("WAHashUtils").stringToPlaintextHash(l),qplInstanceKey:a==null?void 0:a.getInstanceKey()}):d("MAWBridgeSendAndReceive").sendAndReceive("backend","getMediaValidationResultByMediaId",{mediaId:d("MAWDbMedia").convertNumberToMediaId(parseInt(l,10)),qplInstanceKey:a==null?void 0:a.getInstanceKey()});c("promiseDone")(e.then(function(a){if(a!=null){var c=m?d("WAHashUtils").stringToPlaintextHash(l):d("MAWDbMedia").convertNumberToMediaId(parseInt(l,10));b("cr:17330")==null?g({tag:"SetMediaValidatedResult",value:{key:c,validatedResult:a}}):b("cr:17330").call(f,c.toString(),a)}}),q)}})},m=[a,f,g],e[0]=a,e[1]=f,e[2]=g,e[3]=h,e[4]=m):(h=e[3],m=e[4]);l(h,m)}function q(){}function a(a){var b=d("react-compiler-runtime").c(12),e=m(),f=n(a);p(a);var g,h;b[0]!==a||b[1]!==f||b[2]!==e?(g=function(){for(var b of a){var g=b.attachment,h=b.mediaRenderQpl,k=b.statusKey;g=(i||(i=d("I64"))).equal(g.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO));if(!g)continue;g=d("MAWClientMediaStatusUtils").getStatusDataFromLsdbOrContext({clientMediaStatus:f,mediaDownloadStatusState:e,statusKey:k});k=g.hasStatus;g=g.statusData;if(!k)continue;k=g==null?void 0:g.validationResult;if(k==null)continue;h==null?void 0:h.addAnnotations({"int":{audio_avg_bits_per_second:k.audioAvgBitsPerSecond,audio_number_of_channels:k.audioNumberOfChannels,audio_sampling_rate:k.audioSamplingRate,video_avg_bits_per_second:k.videoAvgBitsPerSecond,video_calculated_fps:k.videoCalculatedFps,video_duration:k.videoDuration,video_height:k.videoHeight,video_nominal_fps:k.videoNominalFps,video_width:k.videoWidth},string:{audio_stream_type:k.audioStreamType,validated_mime_type:k.validatedMimeType,video_stream_type:k.videoStreamType}})}},h=[a,f,e],b[0]=a,b[1]=f,b[2]=e,b[3]=g,b[4]=h):(g=b[3],h=b[4]);l(g,h);if(b[5]!==a||b[6]!==f||b[7]!==e){b[9]!==f||b[10]!==e?(g=function(a){var b=a.attachment;a=a.statusKey;b=(i||(i=d("I64"))).equal(b.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO));if(!b)return null;b=d("MAWClientMediaStatusUtils").getStatusDataFromLsdbOrContext({clientMediaStatus:f,mediaDownloadStatusState:e,statusKey:a});a=b.hasStatus;b=b.statusData;if(!a)return null;a=b==null?void 0:b.validationResult;return a==null?null:a},b[9]=f,b[10]=e,b[11]=g):g=b[11];h=a.map(g);b[5]=a;b[6]=f;b[7]=e;b[8]=h}else h=b[8];g=h;return g}g["default"]=a}),98);
__d("useMAWMediaValidationResultState",["react","react-compiler-runtime","useMAWBulkMediaValidationResult"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;function a(a,b,e){var f=d("react-compiler-runtime").c(4);if(f[0]!==a||f[1]!==e||f[2]!==b){var g;g=a!=null?[{attachment:a,mediaRenderQpl:b,statusKey:(g=e)!=null?g:a.attachmentFbid}]:[];f[0]=a;f[1]=e;f[2]=b;f[3]=g}else g=f[3];a=g;e=a;b=c("useMAWBulkMediaValidationResult")(e);return b.length>0?b[0]:null}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense",["cr:5970","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return(a=b("cr:5970")==null?void 0:b("cr:5970").getAttachmentBlob_CausesSuspense(a,c,d))!=null?a:""}g["default"]=a}),98);
__d("MAWVideoAudioPlaybackErrorHandlerUtils",["fbt","BaseMiddot.react","I64","LSIntEnum","MWXLink.react","MessagingAttachmentType","MessengerWebUXLoggerImpl","ReQL","ReQLSuspense","UserAgent","gkx","justknobx","react","react-compiler-runtime","useMAWMediaValidationResultState","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useReStore","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=l||c("react");function n(a){a=a.silent;return a===!0?c("gkx")("5198"):c("gkx")("5211")}function a(a){a=a.silent;return a===!0?c("gkx")("5235"):c("gkx")("5475")}function b(a,b,e){var f,g,j=d("react-compiler-runtime").c(22);f=(f=c("useShouldShowPlaybackErrorFallback")(a,null))!=null?f:!1;g=(g=c("useShouldShowUnsupportedCodecFallback")(a,null))!=null?g:!1;var l=d("MessengerWebUXLoggerImpl").useInteractionLogger(),n=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();if(f){j[0]===Symbol["for"]("react.memo_cache_sentinel")?(f={downloadButton:null,mediaStatusText:h._(/*BTDS*/"_j[\"\\u0110\\u1ecbnh d\\u1ea1ng file kh\\u00f4ng h\\u1ee3p l\\u1ec7\",\"f90fb65f92ad8ac33f140b8be3c9eed1\",1]"),retryButton:null},j[0]=f):f=j[0];return f}if(g){f=(i||(i=d("I64"))).equal(a.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO));g=i.equal(a.attachmentType,k.ofNumber(c("MessagingAttachmentType").AUDIO));if(f){j[1]!==a||j[2]!==n?(f=n(a,"MAWVideoAudioPlaybackErrorHandlerUtils"),j[1]=a,j[2]=n,j[3]=f):f=j[3];a=f;if(!Boolean(a)&&c("justknobx")._("4203")){j[4]===Symbol["for"]("react.memo_cache_sentinel")?(n={downloadButton:null,mediaStatusText:h._(/*BTDS*/"_j[\"\\u0110\\u1ecbnh d\\u1ea1ng file kh\\u00f4ng h\\u1ee3p l\\u1ec7\",\"f90fb65f92ad8ac33f140b8be3c9eed1\",1]"),retryButton:null},j[4]=n):n=j[4];return n}j[5]===Symbol["for"]("react.memo_cache_sentinel")?(f=m.jsx(c("BaseMiddot.react"),{}),j[5]=f):f=j[5];j[6]!==l?(n=function(){l==null?void 0:l({eventName:"click_unsupported_video_download_from_mustache"})},j[6]=l,j[7]=n):n=j[7];var o;j[8]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._(/*BTDS*/"T\u1ea3i xu\u1ed1ng \u0111\u1ec3 ph\u00e1t"),j[8]=o):o=j[8];j[9]!==a||j[10]!==n?(f=m.jsxs(m.Fragment,{children:[f,m.jsx(c("MWXLink.react"),{download:!0,href:a,onClick:n,children:o})]}),j[9]=a,j[10]=n,j[11]=f):f=j[11];o=f;j[12]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"Tr\u00ecnh duy\u1ec7t kh\u00f4ng h\u1ed7 tr\u1ee3 video n\u00e0y"),j[12]=a):a=j[12];j[13]!==o?(n={downloadButton:o,mediaStatusText:a,retryButton:null},j[13]=o,j[14]=n):n=j[14];return n}if(g){j[15]===Symbol["for"]("react.memo_cache_sentinel")?(f={downloadButton:null,mediaStatusText:h._(/*BTDS*/"Tr\u00ecnh duy\u1ec7t kh\u00f4ng h\u1ed7 tr\u1ee3 \u00e2m thanh n\u00e0y"),retryButton:null},j[15]=f):f=j[15];return f}}j[16]!==b||j[17]!==e?(a=b?m.jsxs(m.Fragment,{children:[m.jsx(c("BaseMiddot.react"),{}),m.jsx(c("MWXLink.react"),{onClick:e,children:h._(/*BTDS*/"Th\u1eed l\u1ea1i")})]}):null,j[16]=b,j[17]=e,j[18]=a):a=j[18];o=a;j[19]===Symbol["for"]("react.memo_cache_sentinel")?(n=h._(/*BTDS*/"Kh\u00f4ng th\u1ec3 t\u1ea3i xu\u1ed1ng"),j[19]=n):n=j[19];j[20]!==o?(g={downloadButton:null,mediaStatusText:n,retryButton:o},j[20]=o,j[21]=g):g=j[21];return g}function e(a){var b=d("react-compiler-runtime").c(7),e=(j||(j=c("useReStore")))(),g;b[0]!==e.tables.attachments||b[1]!==a.messageId||b[2]!==a.threadKey?(g=function(){return d("ReQL").fromTableAscending(e.tables.attachments).getKeyRange(a.threadKey,a.messageId)},b[0]=e.tables.attachments,b[1]=a.messageId,b[2]=a.threadKey,b[3]=g):g=b[3];var h;b[4]!==e||b[5]!==a?(h=[e,a],b[4]=e,b[5]=a,b[6]=h):h=b[6];b=d("ReQLSuspense").useFirst(g,h,f.id+":188");g=c("useMAWMediaValidationResultState")(b);if(b==null)return!1;h=(i||(i=d("I64"))).equal(b.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(i||(i=d("I64"))).equal(b.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO));if(!h)return!1;h=(b=g)!=null?b:{};g=h.validatedMimeType;return n({silent:!1})&&g==="invalid-mp4"?!0:!1}var o=Object.freeze({Chrome:["H263","Vvc","Av1"],Edge:["H263","Vvc","Av1"],Firefox:["H263","Vvc","Hevc","Av1"],Safari:["H263","Vvc","Vp9","Av1"]});function p(a){if(a==null)return!0;if(c("UserAgent").isBrowser("Chrome"))return o.Chrome.includes(a)===!1;else if(c("UserAgent").isBrowser("Firefox"))return o.Firefox.includes(a)===!1;else if(c("UserAgent").isBrowser("Edge"))return o.Edge.includes(a)===!1;else if(c("UserAgent").isBrowser("Safari"))return o.Safari.includes(a)===!1;return!0}function q(a,b){a=a.attachmentType;a=(i||(i=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(i||(i=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO));if(!a)return!1;a=n({silent:!1});if(!a)return!1;b=(a=b)!=null?a:{};a=b.validatedMimeType;b=b.videoStreamType;return p(b)===!1||a==="unsupported-video"}function r(a,b){a=a.attachmentType;a=(i||(i=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(i||(i=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO));if(!a)return!1;a=n({silent:!1});if(!a)return!1;b=(a=b)!=null?a:{};a=b.validatedMimeType;return a==="invalid-mp4"}g.isVideoFallbackExperiencesEnabled=n;g.isInvalidVideoSendBlockEnabled=a;g.useGetMetadataForMediaNotRendered=b;g.useIsInvalidVideoMessage=e;g.isUnsupportedVideo=q;g.isInvalidVideo=r}),226);
__d("MAWVideoUtils",["FBLogger","MAWImageUtils","Promise","generateVideoThumbnails"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var e=document.body;if(!e)return new(h||(h=b("Promise")))(function(a,b){return b("Unable to find DOM body, please use this util only in DOM environment.")});var f=document.createElement("video");return new(h||(h=b("Promise")))(function(d,g){f.setAttribute("style","display: none"),f.setAttribute("src",URL.createObjectURL(a)),f.addEventListener("loadedmetadata",function(a){a=a.currentTarget;if(a instanceof HTMLVideoElement){var e=a.duration,i=a.videoHeight;a=a.videoWidth;var j=c("generateVideoThumbnails")(f,a,i,1);d((h||(h=b("Promise"))).all([j,a,i,Math.ceil(e)]))}else g("EventTarget returned for event should be HTMLVideoElement")}),f.addEventListener("error",function(a){g("Unable to load video")}),e.appendChild(f)}).then(function(a){var b=a[0],c=a[1],g=a[2],h=a[3];e.removeChild(f);return d("MAWImageUtils").canvasToBlob(b.thumbnails[0].getCanvas(),d("MAWImageUtils").TYPE_JPEG,!0).then(function(a){return a.arrayBuffer().then(function(a){return{duration:h,height:g,jpegThumbnail:a,width:c}})})})["catch"](function(a){e.removeChild(f);throw c("FBLogger")("messenger_web").mustfixThrow(a)})}function e(a){var d=document.body;if(!d)return new(h||(h=b("Promise")))(function(a,b){return b("Unable to find DOM body, please use this util only in DOM environment.")});var e=document.createElement("video");return new(h||(h=b("Promise")))(function(b,c){e.setAttribute("style","display: none"),e.setAttribute("src",URL.createObjectURL(a)),e.addEventListener("loadedmetadata",function(a){a=a.currentTarget;if(a instanceof HTMLVideoElement){var d=a.duration,e=a.videoHeight;a=a.videoWidth;b({duration:Math.ceil(d),height:e,width:a})}else c("EventTarget returned for event should be HTMLVideoElement")}),e.addEventListener("error",function(a){c("Unable to load video")}),d.appendChild(e)})["catch"](function(a){d.removeChild(e);throw c("FBLogger")("messenger_web").mustfixThrow(a)})}g.getVideoThumbnailUrlAndSpec=a;g.getVideoThumbnailSpec=e}),98);
__d("MAWVideoPreProcess",["MAWMediaPreProcessQpl","MAWSendVideoToWorker","MAWVideoAudioPlaybackErrorHandlerUtils","MAWVideoUtils","MWFBLogger","MWPBumpEntityKey","WABlobToArrayBuffer","WAMediaWasmWorkerClient","WAResultOrError","cometIsMimeTypeForMedia"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got error! ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair rejected file (",")"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got parsing error! ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["trouble parsing file "," (fossil ",") ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["start process video through asm.js, file name: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["start process video through wasm, file name: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to preprocess video: ",""]);n=function(){return a};return a}var o=["video/x-ms-wmv","video/x-msvideo","video/avi","video/x-flv","video/ogg","video/mpeg"],p=d("MWFBLogger").MWMediaLogger.tags(["MAWVideoPreProcess"]),q=typeof self.BigInt==="function";function b(a,b){return r(a,b).then(function(b){if(!b.success&&d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideoSendBlockEnabled({silent:!1})){b.error;return Promise.reject(b.error)}b=(b=b.value)!=null?b:a;return Promise.all([b,d("MAWVideoUtils").getVideoThumbnailUrlAndSpec(b)]).then(async function(a){var b=a[0];a=a[1];return{file:b,plaintext:await d("WABlobToArrayBuffer").blobToArrayBuffer(b),thumbnailUrlAndSpec:a,type:"video"}})})}async function c(b){d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideoSendBlockEnabled({silent:!1})&&await r(b).then(function(a){if(!a.success){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.composer","invalid_video_send_block_with_type_"+b.type);a.error;return Promise.reject(a.error)}return});var c=await d("MAWVideoUtils").getVideoThumbnailSpec(b),e=a.URL.createObjectURL(b);return Promise.resolve({file:b,thumbnailSpec:c,type:"video",url:e})}function r(a,b){var c=q,e=d("MAWMediaPreProcessQpl").startMediaPreProcessQpl("video",a);e.addAnnotations({bool:{wamedia_wasm_enabled:c},int:{total_number_of_files:(b=b)!=null?b:1}});b=c?s(a,e):t(a);return b.then(function(a){if(!a.success)switch(a.error){case"invalid-media":e.endFail("invalid-media");return d("WAResultOrError").makeError("invalid-mp4");case"worker-connection-timeout":case"worker-connection-runtime-error":case"internal-error":case"decode-image-error":case"undefined-operation":case"runtime-error":throw a.error;default:a.error;throw a.error}e.endSuccess({int:{compressed_file_size:a.value.size}});return d("WAResultOrError").makeResult(a.value)}).catch(function(b){p.MUSTFIX(n(),b.toString());e.endFail("unable_to_process_video",{string:{preprocessError:b.toString()}});return d("WAResultOrError").makeResult(a)})}async function s(a,b){p.DEBUG(m(),a.name);var c=await a.arrayBuffer();b=await d("WAMediaWasmWorkerClient").mp4RepairMuxInWorker({eventFlow:b,input:new Uint8Array(c)});if(!b.success)return b;c=new File([b.value],a.name,{type:"video/mp4"});return d("WAResultOrError").makeResult(c)}function t(a){p.DEBUG(l(),a.name);return u(a).then(function(b){if(!b)return d("WAResultOrError").makeError("invalid-media");b=new File([b.file],a.name,{type:b.file.type});return d("WAResultOrError").makeResult(b)})}function u(a){return d("MAWSendVideoToWorker").sendVideoMessageToWorker({asGif:!1,file:a,type:"prep"}).then(function(a){var b=a.error,c=a.file,d=a.filename,e=a.result;a=a.type;switch(a){case"result":return e;case"parsingError":p.MUSTFIX(k(),c,d,String(b));c&&p.MUSTFIX(j(),String(b));p.MUSTFIX(i(),String(b));return void 0}}).catch(function(a){p.MUSTFIX(h(),String(a));return void 0})}function e(a){return!d("cometIsMimeTypeForMedia").isMimeTypeForVideo(a)?!1:!o.includes(a)}g.videoPreprocess=b;g.optimisticVideoPreprocess=c;g.processVideoThroughWasm=s;g.processVideoThroughAsmJs=t;g.isSupportedVideoFileType=e}),98);
__d("MAWMediaPreprocess",["MAWAudioPreProcess","MAWDocumentPreProcess","MAWImagePreProcess","MAWSupportedDocumentTypes","MAWVideoPreProcess","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["start optimistic mediaPreprocess, file name: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start mediaPreprocess, file name: ",""]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["MAWMediaPreprocess"]);function a(a,b,c){j.DEV(i(),a.name);return k(a,function(a){return d("MAWImagePreProcess").imagePreprocess(a,!1,b,c)},function(a){return d("MAWVideoPreProcess").videoPreprocess(a,b)},d("MAWAudioPreProcess").audioPreprocess,d("MAWDocumentPreProcess").documentPreprocess)}function b(a){j.DEV(h(),a.name);return k(a,d("MAWImagePreProcess").optimisticImagePreprocess,d("MAWVideoPreProcess").optimisticVideoPreprocess,d("MAWAudioPreProcess").optimisticAudioPreprocess,d("MAWDocumentPreProcess").optimisticDocumentPreprocess)}function k(a,b,c,e,f){if(a.size===0)return Promise.reject("Empty file");if(d("MAWImagePreProcess").isSupportedImageFileType(a.type))return b(a);if(d("MAWVideoPreProcess").isSupportedVideoFileType(a.type))return c(a);if(a.type.startsWith("audio/"))return e(a);return d("MAWSupportedDocumentTypes").isAllowedType(a.name)?f(a):Promise.reject("Unsupported file type")}g.mediaPreprocess=a;g.optimisticMediaPreprocess=b}),98);
__d("MWMediaManagerTypes",["MessagingAttachmentType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"animated_image":return c("MessagingAttachmentType").ANIMATED_IMAGE;case"image":return c("MessagingAttachmentType").IMAGE;case"video":return c("MessagingAttachmentType").VIDEO;case"audio":return c("MessagingAttachmentType").AUDIO;case"document":return c("MessagingAttachmentType").FILE;default:return null}}g.getMessagingAttachmentTypeFromMediaMetadataAttachmentType=a}),98);
__d("MAWMediaManagerUtils",["FBLogger","MAWBridgeFireAndForget","MAWMediaPreprocess","MAWMediaUtils","MAWMiActOnActThreadReady","MWMediaManagerTypes","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function a(a,b){var e=c("gkx")("9576")?b===!0:void 0;return Promise.all(a.map(async function(c){var f=c[0];c=c[1];var g=d("MAWMediaPreprocess").mediaPreprocess(f,a.length,b),i=await d("MAWMediaPreprocess").optimisticMediaPreprocess(f);h.set(c,{optimisticMedia:i,originalFile:f,processedMediaPromise:g});g=d("MWMediaManagerTypes").getMessagingAttachmentTypeFromMediaMetadataAttachmentType(i.type);f={attachmentType:(g=g)!=null?g:void 0,file:f,isHd:e,offlineAttachmentId:c,previewHeight:(f=(g=i.imageSpec)==null?void 0:g.height)!=null?f:void 0,previewWidth:(g=(c=i.imageSpec)==null?void 0:c.width)!=null?g:void 0};return Promise.resolve(f)}))}function b(a,b,e){c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(a.tables,b,"MAWMediaManagerUtils",async function(a,b){a=e.reduce(function(a,b){b=(b=h.get(b.offlineAttachmentId))==null?void 0:b.processedMediaPromise;b!=null&&a.push(b);return a},[]);a=await Promise.all(a);a.forEach(function(a){var e;switch(a.type){case"image":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:d("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile((e=a.thumbnailUrlAndSpec)==null?void 0:e.jpegThumbnail)});case"animated_image":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:c("gkx")("8554")?null:d("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile((e=a.thumbnailUrlAndSpec)==null?void 0:e.jpegThumbnail)});case"video":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:d("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile(a.thumbnailUrlAndSpec.jpegThumbnail)});case"audio":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:null});case"document":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:null});default:c("FBLogger")("messenger_web_media").mustfix("MAW Optimistic upload media: unknown media attachment file type: "+a.type)}});return Promise.resolve()}))}function e(a,b,e){c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(a.tables,b,"MAWMediaManagerUtils",function(a,b){e.forEach(function(a){return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a,jid:b,thumbnail:null})});return Promise.resolve()}))}g.MAWMediaManagerAttachmentsV2=h;g.preprocessV2=a;g.upload=b;g.uploadForXMA=e}),98);
__d("MAWMessageIntegrityCheckFlytrapResultCache",["CometLruCache","I64","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h;f=c("justknobx")._("3629");var i=d("CometLruCache").create(f);function a(a,b){if(a==null)return;i.set(a,b)}function b(a){return i.get(a)}function e(a,b){if(b.length===0)return null;var c=b[0].offlineThreadingId;b=b[b.length-1].offlineThreadingId;return(h||(h=d("I64"))).to_string(a)+"_"+c+"_"+b}g.cacheMessageIntegrityCheckResult=a;g.getMessageIntegrityCheckResult=b;g.generateMessageIntegrityCheckPageKey=e}),98);
__d("useIsSecureMessage",["LSMessagingThreadTypeUtil","ReQL","ReQLSuspense","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e,g=d("react-compiler-runtime").c(2);e=(e=d("ReQLSuspense").useFirst(function(){return b==null?d("ReQL").empty():d("ReQL").fromTableAscending(a.tables.threads,["threadType"]).getKeyRange(b.threadKey).map(h)},[a,b],f.id+":37"))!=null?e:c.fallbackThreadType;if(e==null){return(c=c.fallbackIsSecure)!=null?c:!1}g[0]!==e?(c=d("LSMessagingThreadTypeUtil").isArmadilloSecure(e),g[0]=e,g[1]=c):c=g[1];return c}function h(a){a=a.threadType;return a}g["default"]=a}),98);
__d("MessageReactionOperation",[],(function(a,b,c,d,e,f){a=Object.freeze({ADD:1,REMOVE:2,REMOVE_MULTI_REACT:3});f["default"]=a}),66);
__d("MessageReactionStyle",[],(function(a,b,c,d,e,f){a=Object.freeze({BASIC_SUPER_REACT_ANIMATION:1});f["default"]=a}),66);
__d("useMWLSDefaultThreadSourceAndResetAttribution",["LSThreadAttributionTypeUtil","react","react-compiler-runtime","useLSMessagingSource"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("useLSMessagingSource")(),e;a[0]!==b?(e=function(a){return d("LSThreadAttributionTypeUtil").getSourceAndResetAttribution(a,b)},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("useMWPSendOrUnsendReaction",["FBLogger","I64","Int64Hooks","LSFactory","LSIntEnum","LSOptimisticUpsertReactionStoredProcedure","LSOptimisticUpsertReactionV2StoredProcedure","MWPActor.react","MessageReactionOperation","MessageReactionStyle","ReQL","promiseDone","react-compiler-runtime","useIsMultiReactionEnabled","useIsReactionsV2Enabled","useMWLSDefaultThreadSourceAndResetAttribution","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,e,g,h,j){c("promiseDone")(a.runInTransaction(function(a){return c("LSOptimisticUpsertReactionV2StoredProcedure")(c("LSFactory")(a),{actorId:b,currentCount:h,messageId:e.messageId,messageTimestamp:e.timestampMs,operation:(i||(i=d("LSIntEnum"))).ofNumber(c("MessageReactionOperation").ADD),reactionFbid:g,reactionLiteral:j,reactionStyle:i.ofNumber(c("MessageReactionStyle").BASIC_SUPER_REACT_ANIMATION),threadId:e.threadKey,viewerIsReactor:!0})},"readwrite",void 0,void 0,f.id+":42"))}async function l(a,b,e,g,h,j,k){await a.runInTransaction(function(a){return c("LSOptimisticUpsertReactionV2StoredProcedure")(c("LSFactory")(a),{actorId:b,currentCount:g,messageId:e.messageId,messageTimestamp:e.timestampMs,operation:(i||(i=d("LSIntEnum"))).ofNumber(k?c("MessageReactionOperation").REMOVE_MULTI_REACT:c("MessageReactionOperation").REMOVE),reactionFbid:h,reactionLiteral:j,reactionStyle:i.ofNumber(c("MessageReactionStyle").BASIC_SUPER_REACT_ANIMATION),threadId:e.threadKey,viewerIsReactor:!1})},"readwrite",void 0,void 0,f.id+":72")}function m(a,b,e,f,g){c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.reactions_v2).getKeyRange(e.threadKey,e.messageId,f)).then(function(c){c!=null?k(a,b,e,f,c.count,g):k(a,b,e,f,(j||(j=d("I64"))).zero,g)}))}function a(a){var b=d("react-compiler-runtime").c(7),e=(h||(h=c("useReStore")))(),g=d("MWPActor.react").useActor(),i=c("useMWLSDefaultThreadSourceAndResetAttribution")(),k=d("useIsMultiReactionEnabled").useIsMultiReactEnabled(a.threadKey),n,o;b[0]!==g||b[1]!==e||b[2]!==i||b[3]!==k||b[4]!==a?(n=function(b){c("promiseDone")(async function(){var h=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.threads).getKeyRange(a.threadKey));h=h?d("useIsReactionsV2Enabled").isReactionsV2Enabled(h):!1;if(h){var n=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.reaction_v2_types).filter(function(a){return a.reactionLiteral===b||a.reactionLiteralVariant16===b}));if(n!=null){h=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.reactions_v2).getKeyRange(a.threadKey,a.messageId).filter(function(a){return(!k||(j||(j=d("I64"))).equal(a.reactionFbid,n.reactionFbid))&&a.viewerIsReactor}));if(h==null)return m(e,g,a,n.reactionFbid,b);var o=(j||(j=d("I64"))).equal(h.reactionFbid,n.reactionFbid);(!k||o)&&await l(e,g,a,h.count,h.reactionFbid,b,k);o||await m(e,g,a,n.reactionFbid,b)}else c("FBLogger")("messenger_web").warn("Reactions v2: trying to send reaction that is not in reaction_v2_types table");return}return e.runInTransaction(function(e){return c("LSOptimisticUpsertReactionStoredProcedure")(c("LSFactory")(e),{actorId:g,messageId:a.messageId,reaction:b,sendAttribution:i(a.threadKey),threadKey:a.threadKey,timestampMs:(j||(j=d("I64"))).of_float(Date.now())})},"readwrite",void 0,void 0,f.id+":227")}())},o=[e,a,k,g,i],b[0]=g,b[1]=e,b[2]=i,b[3]=k,b[4]=a,b[5]=n,b[6]=o):(n=b[5],o=b[6]);return d("Int64Hooks").useCallbackInt64(n,o)}g.default=a}),98);
__d("MAWPSendOrRemoveReaction.react",["I64","Int64Hooks","LSMessagingThreadAttributionType","MAWExternalId","MAWMessageSendReporterV2","MAWODSProxy","MWLSThread","MWPActor.react","WAOdsEnums","cr:9778","promiseDone","requireDeferred","sendToSentQPLLogger","useIsSecureMessage","useLSMessagingSource","useMWPSendOrUnsendReaction","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("MWLogMessageAction").__setRef("MAWPSendOrRemoveReaction.react");function a(a,e,f){var g,k=(i||(i=c("useReStore")))(),l=d("MWPActor.react").useActor(),m=(g=b("cr:9778")==null?void 0:b("cr:9778").useSendOrRemoveReaction(a.threadKey,(h||(h=d("I64"))).to_string(a.senderId)))!=null?g:null,n=c("useIsSecureMessage")(k,a,{fallbackIsSecure:e}),o=c("useMWPSendOrUnsendReaction")(a),p=c("useLSMessagingSource")(),q=d("MWLSThread").useThread(a.threadKey);return d("Int64Hooks").useMemoInt64(function(){return function(b,g,h){if(n&&m!==null){var i=d("MAWExternalId").generateExternalId(),r=function(a){return m(b,g,a,i).then(function(a){return[a]})};if(d("MAWMessageSendReporterV2").isMessageSendReporterV2Enabled())c("promiseDone")(d("MAWMessageSendReporterV2").MAWMessageSendReporterV2({composerEntrypoint:"MAWSendOrRemoveReaction",externalId:i,lsSource:p,messageTypeParamsArgs:{isReaction:!0},thread:q},r,k));else{var s=d("sendToSentQPLLogger").markSendToSentStartWithAnnotation(q,{isReaction:!0},c("LSMessagingThreadAttributionType").UNKNOWN,void 0,void 0,i);c("promiseDone")(r(s))}d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_SEND_REACTION,key:"post-cutover_msg"})}else{e&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_SEND_REACTION,key:"pre-cutover_msg"});o((r=g)!=null?r:"")}j.onReady(function(b){return c("promiseDone")(b.log(k,a.messageId,a.threadKey,f,h,void 0,void 0,void 0,a.senderId,void 0,l))})}},[n,m,e,o,k,p,q,a.messageId,a.threadKey,a.senderId,f,l])}g.useSendOrRemoveReaction=a}),98);
__d("MDSScrollableArea.react",["CometScrollableArea.react","MDSScrollableAreaStyles","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(8),e,f;b[0]!==a?(f=a.xstyle,e=babelHelpers.objectWithoutPropertiesLoose(a,["xstyle"]),b[0]=a,b[1]=e,b[2]=f):(e=b[1],f=b[2]);b[3]!==f?(a=[c("MDSScrollableAreaStyles").unthemed,f],b[3]=f,b[4]=a):a=b[4];b[5]!==e||b[6]!==a?(f=i.jsx(c("CometScrollableArea.react"),babelHelpers["extends"]({forceBrowserDefault:!0,xstyle:a},e)),b[5]=e,b[6]=a,b[7]=f):f=b[7];return f}g["default"]=a}),98);
__d("MWCMIsSubthreadContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext;c.useMemo;var k=e({isSubthread:!1});function a(){return j(k)}function b(a){var b=d("react-compiler-runtime").c(5),c=a.children;a=a.isSubthread;var e;b[0]!==a?(e={isSubthread:a},b[0]=a,b[1]=e):e=b[1];a=e;e=a;b[2]!==c||b[3]!==e?(a=i.jsx(k.Provider,{value:e,children:c}),b[2]=c,b[3]=e,b[4]=a):a=b[4];return a}g.useIsSubthreadContext=a;g.MWCMIsSubthreadContextProvider=b}),98);
__d("MWChatComposerMentionsViewItem.react",["CometImageFromIXValue.react","CometSearchMentionsBaseViewItem.react","FDSIcon.react","FDSProfilePhoto.react","FDSTextPairing.react","MWXSvgIcon","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(18),e,f;b[0]!==a?(e=a.entry,f=babelHelpers.objectWithoutPropertiesLoose(a,["entry"]),b[0]=a,b[1]=e,b[2]=f):(e=b[1],f=b[2]);a=e;var g=a.handle,h=a.key,j=a.label;a=a.rawData;var k=a.icon,l=a.image,m=a.photoURI;a=a.subtitle;var n;if(m!=null){var o;b[3]!==m?(o=i.jsx(c("FDSProfilePhoto.react"),{size:28,source:{uri:m}}),b[3]=m,b[4]=o):o=b[4];n=o}else if(k!=null){b[5]!==k?(m=k instanceof d("MWXSvgIcon").MWXSvgIcon?i.jsx(c("FDSIcon.react"),{color:"primary",disabled:!1,icon:k.originalComponent,size:28}):i.jsx(c("FDSIcon.react"),{color:"primary",disabled:!1,icon:k}),b[5]=k,b[6]=m):m=b[6];n=m}else if(l!=null){b[7]!==l?(o=i.jsx(c("CometImageFromIXValue.react"),{source:l}),b[7]=l,b[8]=o):o=b[8];n=o}m="mention("+((k=g)!=null?k:h)+")";b[9]!==j||b[10]!==a?(l=i.jsx(c("FDSTextPairing.react"),{body:j,bodyLineLimit:1,level:3,meta:a,metaLineLimit:1}),b[9]=j,b[10]=a,b[11]=l):l=b[11];b[12]!==e||b[13]!==n||b[14]!==f||b[15]!==m||b[16]!==l?(o=i.jsx(c("CometSearchMentionsBaseViewItem.react"),babelHelpers["extends"]({},f,{entry:e,itemStartContent:n,testid:void 0,children:l})),b[12]=e,b[13]=n,b[14]=f,b[15]=m,b[16]=l,b[17]=o):o=b[17];return o}g["default"]=a}),98);
__d("MWChatComposerMentionsUtils",["remove-accents"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b.length===0)return!0;var d=c("remove-accents")(b).toLowerCase();b=c("remove-accents")(a).toLowerCase();return b.split(" ").some(function(a){return a.startsWith(d)})||b.startsWith(d)}g.doesParticipantNameMatch=a}),98);
__d("MWChatComposerTypeaheadUtil",["fbt","ix","I64","LSContactBlockedByViewerStatus","LSIntEnum","LSMessagingThreadTypeUtil","MWChatComposerMentionsUtils","MWXIconGroup","gkx"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l=h._(/*BTDS*/"Meta AI").toString();e=h._(/*BTDS*/"\u0110\u1eb7t c\u00e2u h\u1ecfi").toString();var m=h._(/*BTDS*/"m\u1ecdi ng\u01b0\u1eddi").toString(),n=c("gkx")("20836"),o={decorType:"regular",handle:l,key:"0",label:l,rawData:{image:i("405460"),subtitle:e},type:"entry"};function a(a,b,e,f,g,i,p,q){var r=a.query,s=q!=null&&d("LSMessagingThreadTypeUtil").isArmadilloSecure(q)&&d("LSMessagingThreadTypeUtil").isGroup(q);q=q!=null&&!d("LSMessagingThreadTypeUtil").isArmadilloSecure(q)&&d("LSMessagingThreadTypeUtil").isGroup(q);var t=s&&c("gkx")("7846");q=q&&c("gkx")("11021");var u=[],v=[];g===!0&&d("MWChatComposerMentionsUtils").doesParticipantNameMatch(l,r)&&u.push(o);if(g===!0?i:!0){b.forEach(function(a){var b=a.actualName,e=a.blockedByViewerStatus,f=a.contactId,g=a.nickname,h=a.profilePictureUrl;a=a.secondaryName;if(e!=null&&!(j||(j=d("I64"))).equal(e,(k||(k=d("LSIntEnum"))).ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED)))return;e=null;a!=null&&d("MWChatComposerMentionsUtils").doesParticipantNameMatch(a,r)?e="secondaryName":d("MWChatComposerMentionsUtils").doesParticipantNameMatch(b,r)?e="name":g!=null&&d("MWChatComposerMentionsUtils").doesParticipantNameMatch(g,r)&&(e="nickname");if(e!=null&&h!=null){var i=a;if(s){var l;i=(l=g)!=null?l:b}else if(i==null){i=(l=a)!=null?l:e==="nickname"?(l=g)!=null?l:b:b}u.push({decorType:"regular",handle:i,key:f+" "+e,label:b,rawData:{photoURI:h,source:e,subtitle:(l=a)!=null?l:g},type:"entry"})}});if(d("MWChatComposerMentionsUtils").doesParticipantNameMatch(m,r)&&(n||t||q)){g=h._(/*BTDS*/"Nh\u1eafc \u0111\u1ebfn m\u1ecdi ng\u01b0\u1eddi trong cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y").toString();v.push({decorType:"regular",handle:m,key:""+e,label:m,rawData:{icon:c("MWXIconGroup"),source:"all",subtitle:g},type:"entry"})}if(n){i=h._(/*BTDS*/"t\u1ea1i \u0111\u00e2y").toString();if(d("MWChatComposerMentionsUtils").doesParticipantNameMatch(i,r)){b=h._(/*BTDS*/"Nh\u1eafc \u0111\u1ebfn t\u1ea5t c\u1ea3 nh\u1eefng ng\u01b0\u1eddi \u0111ang ho\u1ea1t \u0111\u1ed9ng trong \u0111o\u1ea1n chat n\u00e0y").toString();v.push({decorType:"regular",handle:i,key:e+"-active",label:i,rawData:{icon:c("MWXIconGroup"),source:"all",subtitle:b},type:"entry"})}}}g=t||q?[].concat(u.slice(0,p),v):[].concat(u,v).slice(0,p);g.length<p&&f&&f(r,p-g.length);return{entries:g,params:a}}function b(a){switch(a){case l:return"ai";case m:return"t";default:return"p"}}g.aiBotMentionsEntry=o;g.fetchCacheComposerMentionsTypeahead=a;g.commandToRangeType=b}),226);
__d("MessengerLexicalEntityTextNode",["Lexical","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var d=a.prototype;d.getEntity=function(){throw c("unrecoverableViolation")("CometMessengerLexicalEntityTextNode does not implement getEntity","messenger_comet")};return a}(d("Lexical").TextNode);function a(a){return a instanceof h}g.MessengerLexicalEntityTextNode=h;g.isMessengerLexicalEntityTextNode=a}),98);
__d("MessengerLexicalActorNode",["MWChatComposerTypeaheadUtil","MessengerLexicalEntityTextNode"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=a.replace(" name","");a=a.replace(" nickname","");a=a.replace(" secondaryName","");return a}var i=function(b){babelHelpers.inheritsLoose(a,b);a.getType=function(){return"actor"};a.clone=function(b){return new a({id:b.__contactID,prefix:b.__prefix,text:l(b.__text,b.__prefix)},b.__key)};a.importJSON=function(a){return j({id:a.id,prefix:a.prefix,text:a.text})};var c=a.prototype;c.exportJSON=function(){return babelHelpers["extends"]({},b.prototype.exportJSON.call(this),{id:this.__contactID,prefix:this.__prefix,text:l(this.__text,this.__prefix),type:"actor"})};function a(a,c){var d=a.id,e=a.prefix;e=e===void 0?"@":e;a=a.text;a=b.call(this,k(a,e),c)||this;a.__contactID=h(d);a.__prefix=e;return a}c.createDOM=function(a){a=b.prototype.createDOM.call(this,a);a.className="xv78j7m xt0e3qv x3jgonx";a.spellcheck=!1;return a};c.getEntity=function(){return{id:this.__contactID,isWeak:!1}};c.getRangeType=function(){return d("MWChatComposerTypeaheadUtil").commandToRangeType(l(this.__text,this.__prefix))};return a}(d("MessengerLexicalEntityTextNode").MessengerLexicalEntityTextNode);function j(a,b){b===void 0&&(b="segmented");return new i(a).setMode(b).toggleDirectionless()}function a(a){return a instanceof i}function k(a,b){return a.startsWith(b)?a:""+b+a}function l(a,b){return a.startsWith(b)?a.slice(b.length):a}g.MessengerLexicalActorNode=i;g.$createMessengerLexicalActorNode=j;g.$isMessengerLexicalActorNode=a}),98);
__d("messengerMentionsLexicalCreateNodeStrategy",["MessengerLexicalActorNode","cometBaseMentionsLexicalCreateNodeStrategy","cometMentionsDataEntryText"],(function(a,b,c,d,e,f,g){"use strict";a=c("cometBaseMentionsLexicalCreateNodeStrategy")(function(a){return d("MessengerLexicalActorNode").$createMessengerLexicalActorNode({id:a.key,text:c("cometMentionsDataEntryText")(a)})});b=a;g["default"]=b}),98);
__d("useCommunityMembers",["I64","Int64Hooks","LSClearCommunityMembersAndRangeStoredProcedure","LSFactory","LSIntEnum","LSIssueCommunityMemberListFetchStoredProcedure","LSVec","MWCMThreadTypes.react","ReQL","ReQLSuspense","promiseDone","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;(k||d("react")).useCallback;function a(a,b,e){var g=d("react-compiler-runtime").c(6),k=(h||(h=c("useReStore")))(),l,m;g[0]!==a||g[1]!==k||g[2]!==b||g[3]!==e?(l=function(){var g=async function(){await k.runInTransaction(function(f){return c("LSIssueCommunityMemberListFetchStoredProcedure")(c("LSFactory")(f),{communityId:a,fetchAdminsOnly:!1,fetchFriendMembersOnly:!1,maxName:"",maxTimestampMs:(i||(i=d("I64"))).zero,nextPageCursor:"",requestId:b,roles:c("LSVec").ofArray([(j||(j=d("LSIntEnum"))).ofNumber(0)]),source:j.ofNumber(13),threadKey:(f=e)!=null?f:void 0,threadRoles:c("LSVec").ofArray([])})},"readwrite",void 0,void 0,f.id+":44")};c("promiseDone")(g())},m=[a,k,b,e],g[0]=a,g[1]=k,g[2]=b,g[3]=e,g[4]=l,g[5]=m):(l=g[4],m=g[5]);d("Int64Hooks").useEffectInt64(l,m)}function b(a,b,e){var g=d("react-compiler-runtime").c(10),i=(h||(h=c("useReStore")))(),j;g[0]!==a||g[1]!==i.tables.community_members_ranges_v2__generated||g[2]!==e||g[3]!==b?(j=function(){return d("ReQL").fromTableAscending(i.tables.community_members_ranges_v2__generated).getKeyRange(a).filter(function(a){if(a.requestId!==b)return!1;return e!=null?a.isAdmin===e:!0})},g[0]=a,g[1]=i.tables.community_members_ranges_v2__generated,g[2]=e,g[3]=b,g[4]=j):j=g[4];var k;g[5]!==a||g[6]!==i||g[7]!==e||g[8]!==b?(k=[i,a,e,b],g[5]=a,g[6]=i,g[7]=e,g[8]=b,g[9]=k):k=g[9];return d("ReQLSuspense").useFirst(j,k,f.id+":76")}function e(a){var b=d("react-compiler-runtime").c(3),e=a===void 0?7:a,g=(h||(h=c("useReStore")))();b[0]!==g||b[1]!==e?(a=function(a){return g.runInTransaction(function(b){return c("LSClearCommunityMembersAndRangeStoredProcedure")(c("LSFactory")(b),{requestId:a,source:(j||(j=d("LSIntEnum"))).ofNumber(e)})},"readwrite",void 0,void 0,f.id+":98")},b[0]=g,b[1]=e,b[2]=a):a=b[2];return a}function l(a){var b=d("react-compiler-runtime").c(12),e=a.communityIdOrThreadKey,g=a.thread,k=a.showAdmodsOnly,l=a.showHostsOnly,m=a.source,n=a.requestId,o=k===void 0?!1:k,p=l===void 0?!1:l;b[0]!==m?(a=m===void 0?(i||(i=d("I64"))).of_int32(7):m,b[0]=m,b[1]=a):a=b[1];var q=a,r=(h||(h=c("useReStore")))(),s=g.threadKey,t=g.threadType;b[2]!==e||b[3]!==r||b[4]!==n||b[5]!==o||b[6]!==p||b[7]!==q||b[8]!==s||b[9]!==t?(k=function(){var a=c("LSVec").ofArray(o?[(j||(j=d("LSIntEnum"))).ofNumber(1),(j||(j=d("LSIntEnum"))).ofNumber(2)]:p?[(j||(j=d("LSIntEnum"))).ofNumber(3)]:[(j||(j=d("LSIntEnum"))).ofNumber(0)]),b=d("MWCMThreadTypes.react").isBroadcastThread(t)?[(j||(j=d("LSIntEnum"))).ofNumber(0)]:[],g=async function(){await r.runInTransaction(function(f){return c("LSIssueCommunityMemberListFetchStoredProcedure")(c("LSFactory")(f),{communityId:e,fetchAdminsOnly:!1,fetchFriendMembersOnly:!1,maxName:"",maxTimestampMs:(i||(i=d("I64"))).zero,nextPageCursor:"",requestId:n,roles:a,source:q,threadKey:(i||(i=d("I64"))).equal(q,(i||(i=d("I64"))).of_int32(0))?void 0:s,threadRoles:c("LSVec").ofArray(b)})},"readwrite",void 0,void 0,f.id+":149")};c("promiseDone")(g())},l=[r,e,s,t,o,q,n,p],b[2]=e,b[3]=r,b[4]=n,b[5]=o,b[6]=p,b[7]=q,b[8]=s,b[9]=t,b[10]=k,b[11]=l):(k=b[10],l=b[11]);d("Int64Hooks").useEffectInt64(k,l)}g.useFetchBannedMemberList=a;g.useCommunityMembersRanges=b;g.useClearMemberList=e;g.useFetchCommunityMembers=l}),98);
__d("createCometAtSignComposerMentionsMatchStrategyWithInstagramHandleSupport",["createCometMentionMatchStrategy"],(function(a,b,c,d,e,f,g){"use strict";var h=["@","\\uff20"].join(""),i=",\\+\\*\\?\\$\\@\\|#{}\\(\\)\\^\\-\\[\\]\\\\/!%'\"~=<>:;",j="(?:\\.[ |$]|[ ]['\"]|['\"][ |$]| |["+i+"]|)";function a(a){var b=a.disallowedTerms;a=a.minMatchLength;return c("createCometMentionMatchStrategy")({disallowedChars:i,disallowedTerms:b,minMatchLength:a,name:"CometAtSignComposerMentionsMatchStrategyWithInstagramHandleSupport("+a.toString()+")",triggers:h,validJoins:j})}g["default"]=a}),98);
__d("useMWCMMentionsDataSourceResolverConfig",["I64","Int64Hooks","LSFactory","LSIssueCommunityMemberListFetchStoredProcedure","LSPlatformWaitForTaskCompletion","LSVec","ReQL","ReQLSuspense","createCometAtSignComposerMentionsMatchStrategyWithInstagramHandleSupport","pageID","react","react-compiler-runtime","useAsyncReStore","useCometMentionsDataSourceResolverConfig"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(h||d("react")).useMemo;function a(a,b){var e=d("react-compiler-runtime").c(12),g=c("useAsyncReStore")(),h,k;e[0]!==a||e[1]!==g||e[2]!==b?(h=async function(e){var h=await g;await c("LSPlatformWaitForTaskCompletion")(h,function(f){return c("LSIssueCommunityMemberListFetchStoredProcedure")(c("LSFactory")(f),{communityId:a,fetchAdminsOnly:!1,fetchFriendMembersOnly:!1,maxName:"",maxTimestampMs:(i||(i=d("I64"))).zero,nextPageCursor:"",requestId:c("pageID"),roles:c("LSVec").ofArray([i.of_int32(0)]),searchText:e,source:i.of_int32(8),threadKey:b,threadRoles:c("LSVec").ofArray([])})},"fetch mentions");var k=await d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(h.tables.community_members.index("communitySource")).getKeyRange(a,(i||(i=d("I64"))).of_int32(8),c("pageID")).filter(j).take(6).map(function(b){var c,e;c=(c=d("ReQLSuspense").first(d("ReQL").fromTableAscending(h.tables.contextual_profile_v1).getKeyRange(b.contactId,a),f.id+":91"))==null?void 0:c.profileName;return{key:(i||(i=d("I64"))).to_string(b.contactId),label:(e=c)!=null?e:b.name,rawData:{photoURI:b.profilePictureUrl,source:"all",subtitle:c!=null?b.name:b.subtitle},type:"entry"}}));return k},k=[g,b,a],e[0]=a,e[1]=g,e[2]=b,e[3]=h,e[4]=k):(h=e[3],k=e[4]);var l=d("Int64Hooks").useCallbackInt64(h,k);e[5]===Symbol.for("react.memo_cache_sentinel")?(h=new Map(),e[5]=h):h=e[5];var m=h;if(e[6]!==l){e[8]===Symbol.for("react.memo_cache_sentinel")?(k=function(a){var b;return{entries:(b=m.get(a.query))!=null?b:[],params:a}},e[8]=k):k=e[8];h={bootstrap:function(){},fetchCache:k,fetchNetwork:async function(a){if(a.query==="")return{entries:[],params:a};var b=await l(a.query);m.set(a.query,b);return{entries:b,params:a}}};e[6]=l;e[7]=h}else h=e[7];e[9]===Symbol.for("react.memo_cache_sentinel")?(k=c("createCometAtSignComposerMentionsMatchStrategyWithInstagramHandleSupport")({minMatchLength:0}),e[9]=k):k=e[9];e[10]!==h?(k=[{dataSource:h,matchStrategy:k}],e[10]=h,e[11]=k):k=e[11];h=k;e=h;return c("useCometMentionsDataSourceResolverConfig")(e,!1)}function j(a){a=a.isBlocked;return a!==!0}g.default=a}),98);
__d("MWCMMentionsComposerPluginCreatorWithTypeaheadViewForLexical.react",["CometMentionsForLexical.react","CometMentionsLayoutStrategy.react","I64","MWChatComposerMentionsViewItem.react","messengerMentionsLexicalCreateNodeStrategy","pageID","promiseDone","react","react-compiler-runtime","useCometTypeaheadViewListStrategy","useCommunityMembers","useMWCMMentionsDataSourceResolverConfig"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react")),k=h.useEffect,l={view:{minWidth:"x1jzhcrs",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(10),e=a.editor,f=a.folderId;a=a.threadFBID;var g;b[0]!==a?(g=(i||(i=d("I64"))).of_string(a),b[0]=a,b[1]=g):g=b[1];a=c("useMWCMMentionsDataSourceResolverConfig")(f,g);b[2]===Symbol["for"]("react.memo_cache_sentinel")?(f={viewItemStrategyRenderer:c("MWChatComposerMentionsViewItem.react"),viewXStyle:l.view},b[2]=f):f=b[2];g=c("useCometTypeaheadViewListStrategy")(f);var h=d("useCommunityMembers").useClearMemberList(8),m;b[3]!==h?(f=function(){return function(){c("promiseDone")(h(c("pageID")))}},m=[h],b[3]=h,b[4]=f,b[5]=m):(f=b[4],m=b[5]);k(f,m);b[6]!==a||b[7]!==e||b[8]!==g?(f=j.jsx(c("CometMentionsForLexical.react"),{createNodeStrategy:c("messengerMentionsLexicalCreateNodeStrategy"),dataSourceResolverConfig:a,editor:e,layoutStrategyRenderer:c("CometMentionsLayoutStrategy.react"),position:"above",viewStrategyRenderer:g}),b[6]=a,b[7]=e,b[8]=g,b[9]=f):f=b[9];return f}g["default"]=a}),98);
__d("MWCMSubthreadChatTabContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext;c.useMemo;var k=e({pushSubthreadViewPage:null});function a(){return j(k)}function b(a){var b=d("react-compiler-runtime").c(5),c=a.children;a=a.pushSubthreadViewPage;var e;b[0]!==a?(e={pushSubthreadViewPage:a},b[0]=a,b[1]=e):e=b[1];a=e;e=a;b[2]!==c||b[3]!==e?(a=i.jsx(k.Provider,{value:e,children:c}),b[2]=c,b[3]=e,b[4]=a):a=b[4];return a}g.useSubthreadChatTabContext=a;g.MWCMSubthreadChatTabContextProvider=b}),98);
__d("MWCMSubthreadsInboxFocusContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext;c.useMemo;var k=c.useState,l=e({isSubthreadFocused:!1,setIsSubthreadFocused:function(){}});function a(){return j(l)}function b(a){var b=d("react-compiler-runtime").c(5);a=a.children;var c=k(!1),e=c[0];c=c[1];b[0]!==e?(c={isSubthreadFocused:e,setIsSubthreadFocused:c},b[0]=e,b[1]=c):c=b[1];e=c;c=e;b[2]!==a||b[3]!==c?(e=i.jsx(l.Provider,{value:c,children:a}),b[2]=a,b[3]=c,b[4]=e):e=b[4];return e}g.useIsSubthreadFocusedContext=a;g.MWCMIsSubthreadFocusedContextProvider=b}),98);
__d("MWChatAppendMentionsNodeToReply",["I64","LSContactTypeExact","LSIntEnum","Lexical","LexicalText","MWChatComposerTypeaheadUtil","MWPReplyContext.react","MessengerLexicalActorNode","ReQL","ReQLSuspense","cometMentionsDataEntryText","react","react-compiler-runtime","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useContext,m=b.useEffect;function n(a,b){a.update(function(){var e=d("Lexical").$getSelection();if(!d("Lexical").$isRangeSelection(e)||!e.isCollapsed())return;var f=e.anchor;f=f.getNode();var g=c("cometMentionsDataEntryText")(b),h=d("Lexical").$getRoot().getAllTextNodes().some(function(a){return d("MessengerLexicalActorNode").$isMessengerLexicalActorNode(a)&&a.getTextContent().includes(g)});if(h===!0)return;h=d("MessengerLexicalActorNode").$createMessengerLexicalActorNode({id:b.key,text:g});var i=d("LexicalText").$isRootTextContentEmpty(a.isComposing());i?e.insertNodes([h]):f.insertBefore(h);h.selectNext(0,0)})}function a(a,b,e){var g=d("react-compiler-runtime").c(18),k=l(d("MWPReplyContext.react").MWPReplyContext),o=k.reply,p=c("usePrevious")(o),q=(h||(h=c("useReStore")))(),r;g[0]!==q||g[1]!==o||g[2]!==b?(k=function(){return o!=null?d("ReQL").fromTableAscending(q.tables.messages).getKeyRange(b,o.timestampMs,o.messageId):d("ReQL").empty()},r=[o,b,q],g[0]=q,g[1]=o,g[2]=b,g[3]=k,g[4]=r):(k=g[3],r=g[4]);var s=d("ReQLSuspense").useFirst(k,r,f.id+":91");g[5]!==q||g[6]!==s?(k=function(){return s!=null?d("ReQL").fromTableAscending(q.tables.contacts).getKeyRange(s.senderId):d("ReQL").empty()},r=[q,s],g[5]=q,g[6]=s,g[7]=k,g[8]=r):(k=g[7],r=g[8]);k=d("ReQLSuspense").useFirst(k,r,f.id+":102");g[9]!==k?(r=k!=null?(i||(i=d("I64"))).equal(k.contactTypeExact,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactTypeExact").GENERATIVE_AI_BOT)):!1,g[9]=k,g[10]=r):r=g[10];k=r;var t=k&&(s==null?void 0:s.botResponseId)!=null;g[11]!==a||g[12]!==t||g[13]!==p||g[14]!==o||g[15]!==e?(r=function(){var b=p==null&&o!=null;b&&t&&e===!0&&n(a,d("MWChatComposerTypeaheadUtil").aiBotMentionsEntry)},k=[a,o,p,t,e],g[11]=a,g[12]=t,g[13]=p,g[14]=o,g[15]=e,g[16]=r,g[17]=k):(r=g[16],k=g[17]);m(r,k)}g.insertMentionNodeToFront=n;g.useMWChatAppendMentionsNodeToReply=a}),98);
__d("MWChatComposerMentionsTypeaheadDataSource",["CurrentUser","MWChatComposerTypeaheadUtil","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i=6;a=function(){function a(a,b,d,e,f,g){this.$1=[];this.$1=Array.from(a.values()).filter(function(a){return a.contactId!==c("CurrentUser").getID()});this.$2=b;this.$3=(a=d)!=null?a:null;this.$4=e;this.$5=f;this.$6=g}var e=a.prototype;e.bootstrap=function(){return};e.fetchCache=function(a){return d("MWChatComposerTypeaheadUtil").fetchCacheComposerMentionsTypeahead(a,this.$1,this.$2,this.$3,this.$4,this.$5,i,this.$6)};e.fetchNetwork=function(a){return(h||(h=b("Promise"))).resolve(this.fetchCache(a))};return a}();g["default"]=a}),98);
__d("MWChatForwardDialogQuery$Parameters",["MWChatForwardDialogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("MWChatForwardDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatForwardDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MWChatForwardDialog.entrypoint",["JSResourceForInteraction","MWChatForwardDialogQuery$Parameters","MWXacGating","WebPixelRatio"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){return{queries:{forwardQueryReference:{parameters:b("MWChatForwardDialogQuery$Parameters"),variables:{scale:d("WebPixelRatio").get(),suppress_xac_groups:!d("MWXacGating").isGroupsEnabled()}}}}},root:c("JSResourceForInteraction")("MWChatForwardDialog.react").__setRef("MWChatForwardDialog.entrypoint")};g["default"]=a}),98);
__d("MWXTooltipGroup.react",["cr:824"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:824")}),98);
__d("MWChatPollFacepile.react",["fbt","CometImage.react","FDSDots3HorizontalFilled16Icon","FDSIcon.react","MWXPressable.react","MWXTooltip.react","MWXTooltipGroup.react","intlList","intlSummarizeNumber","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l={large:{height:"x10w6t97",$$css:!0},medium:{height:"x1qx5ct2",$$css:!0},mediumLarge:{height:"xxk0z11",$$css:!0},small:{height:"x1v9usgg",$$css:!0}},m={contact:{borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",$$css:!0},contactGapNegative:{marginStart:"xrzrlj5",$$css:!0},contactGapNormal:{marginStart:"xsgj6o6",$$css:!0},contactLarge:{height:"x10w6t97",width:"x1td3qas",$$css:!0},contactMedium:{height:"x1qx5ct2",width:"xw4jnvo",$$css:!0},contactMediumLarge:{height:"xxk0z11",width:"xvy4d1p",$$css:!0},contactSmall:{height:"x1v9usgg",width:"x6jxa94",$$css:!0},contactWithBorder:{borderTopColor:"x1exxf4d",borderEndColor:"x1y71gwh",borderBottomColor:"x1nb4dca",borderStartColor:"xu1343h",borderTopStyle:"x13fuv20",borderEndStyle:"xu3j5b3",borderBottomStyle:"x1q0q8m5",borderStartStyle:"x26u7qi",borderTopWidth:"x178xt8z",borderEndWidth:"xm81vs4",borderBottomWidth:"xso031l",borderStartWidth:"xy80clv",marginTop:"x1y332i5",$$css:!0},contactWithGap:{borderTopColor:"x1bsybk2",borderEndColor:"x48pi3f",borderBottomColor:"x2lbui5",borderStartColor:"x1x95ywd",borderTopStyle:"x13fuv20",borderEndStyle:"xu3j5b3",borderBottomStyle:"x1q0q8m5",borderStartStyle:"x26u7qi",borderTopWidth:"xamhcws",borderEndWidth:"xol2nv",borderBottomWidth:"xlxy82",borderStartWidth:"x19p7ews",marginTop:"x1198e8h",$$css:!0},overflow:{backgroundColor:"x1vtvx1t",borderTopStartRadius:"x1a2cdl4",borderTopEndRadius:"xnhgr82",borderBottomEndRadius:"x1qt0ttw",borderBottomStartRadius:"xgk8upj",boxSizing:"x9f619",color:"xi81zsa",fontSize:"x1nxh6w3",fontWeight:"xk50ysn",lineHeight:"x1u7k74",marginBottom:"x4ii5y1",marginStart:"xrzrlj5",marginTop:"xr1yuqi",paddingTop:"x1nn3v0j",paddingEnd:"x1sxyh0",paddingBottom:"x1120s5i",paddingStart:"xurb0ha",$$css:!0},overflowForPrompt:{alignItems:"x6s0dn4",backgroundColor:"x1qhmfi1",borderTopStartRadius:"xzolkzo",borderTopEndRadius:"x12go9s9",borderBottomEndRadius:"x1rnf11y",borderBottomStartRadius:"xprq8jg",color:"xzsf02u",display:"x78zum5",justifyContent:"xl56j7k",$$css:!0},photoWrap:{display:"x1rg5ohu",marginBottom:"x4ii5y1",marginTop:"xr1yuqi",position:"x1n2onr6",$$css:!0},root:{display:"x78zum5",$$css:!0},rootReversed:{flexDirection:"x15zctf7",$$css:!0}};function n(a){switch(a){case"small":return m.contactSmall;case"medium":return m.contactMedium;case"mediumLarge":return m.contactMediumLarge;case"large":return m.contactLarge;default:a}}function o(a){var b=d("react-compiler-runtime").c(3),e=a.children;a=a.tooltip;var f;b[0]!==e||b[1]!==a?(f=a!=null?k.jsx(c("MWXTooltip.react"),{align:"middle",label:h._(/*BTDS*/"Xem th\u00eam"),position:"above",tooltip:a,children:e}):e,b[0]=e,b[1]=a,b[2]=f):f=b[2];return f}function a(a){var b=d("react-compiler-runtime").c(42),e=a.contacts,f=a.contactWithBorder,g=a.countOverride,j=a.direction,t=a.gap,u=a.isPrompt,v=a.limit,w=a.onPress,x=a.overflowStyle,y=a.size,z=f===void 0?!0:f;a=j===void 0?"normal":j;var A=t===void 0?"normal":t,B=u===void 0?!1:u,C=v===void 0?2:v,D=x===void 0?"showTotalCount":x;f=g!=null?g:e.length;var E=f>C;if(b[0]!==e||b[1]!==C||b[2]!==f){j=e.slice(0,-C).reverse().filter(s).map(r);t=f-C-j.length;t>0&&j.push(h._(/*BTDS*/"_j{\"*\":\"v\\u00e0 {count} ng\\u01b0\\u1eddi kh\\u00e1c\"}",[h._plural(t),h._param("count",c("intlSummarizeNumber")(t))]));u=j.length===0?void 0:k.jsx("ul",{children:j.map(q)});b[0]=e;b[1]=C;b[2]=f;b[3]=u}else u=b[3];v=u;if(b[4]!==e||b[5]!==C||b[6]!==E||b[7]!==f){x=e.slice(-(E?C:1e3)).reverse();g=x.map(p);t=e.length>0?h._(/*BTDS*/"_j{\"*\":{\"*\":\"{number} l\\u01b0\\u1ee3t b\\u00ecnh ch\\u1ecdn \\u0111\\u1ebfn t\\u1eeb {=names}\"},\"_1\":{\"_1\":\"1 l\\u01b0\\u1ee3t b\\u00ecnh ch\\u1ecdn c\\u1ee7a {=names}\"}}",[h._plural(f,"number"),h._plural(f),h._param("=names",c("intlList")(g))]):h._(/*BTDS*/"0 l\u01b0\u1ee3t b\u00ecnh ch\u1ecdn");b[4]=e;b[5]=C;b[6]=E;b[7]=f;b[8]=t}else t=b[8];j=t;b[9]!==B||b[10]!==C||b[11]!==v||b[12]!==D||b[13]!==E||b[14]!==y||b[15]!==f?(u=E&&D==="showTotalCount"&&k.jsx(o,{tooltip:v,children:k.jsx("div",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(m.overflow,B&&m.overflowForPrompt,B&&l[y]),{children:"+"+c("intlSummarizeNumber")(f-C)}))}),b[9]=B,b[10]=C,b[11]=v,b[12]=D,b[13]=E,b[14]=y,b[15]=f,b[16]=u):u=b[16];if(b[17]!==z||b[18]!==e||b[19]!==A||b[20]!==B||b[21]!==C||b[22]!==D||b[23]!==E||b[24]!==y){b[26]!==z||b[27]!==A||b[28]!==B||b[29]!==C||b[30]!==D||b[31]!==E||b[32]!==y?(x=function(a,b){return k.createElement("div",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(m.photoWrap,A==="normal"?m.contactGapNormal:m.contactGapNegative,n(y)),{key:String(b)}),k.jsx(o,{tooltip:a.name,children:k.jsx(c("CometImage.react"),{src:a.profile_picture_url,xstyle:[m.contact,n(y),z&&!B?m.contactWithBorder:!1,B?m.contactWithGap:!1]})}),E&&D==="overlayLastPhoto"&&b===C-1?k.jsx("div",babelHelpers["extends"]({className:"x6s0dn4 xdit8p8 x14yjl9h xudhj91 x18nykt9 xww2gxu x1ey2m1c x78zum5 xds687c x17qophe xl56j7k x1us6l5c x6ikm8r x10wlt62 x10l6tqk x13vifvy x1vjfegm"},{children:k.jsx(c("FDSIcon.react"),{color:"white",icon:c("FDSDots3HorizontalFilled16Icon")})})):null)},b[26]=z,b[27]=A,b[28]=B,b[29]=C,b[30]=D,b[31]=E,b[32]=y,b[33]=x):x=b[33];g=e.slice(-(E?C:1e3)).reverse().map(x);b[17]=z;b[18]=e;b[19]=A;b[20]=B;b[21]=C;b[22]=D;b[23]=E;b[24]=y;b[25]=g}else g=b[25];b[34]!==g||b[35]!==u?(t=k.jsxs(c("MWXTooltipGroup.react"),{children:[u,g]}),b[34]=g,b[35]=u,b[36]=t):t=b[36];v=t;b[37]!==a||b[38]!==v||b[39]!==j||b[40]!==w?(f=w!=null?k.jsx(c("MWXPressable.react"),{label:j,onPress:w,overlayDisabled:!0,xstyle:[m.root,a==="reversed"?m.rootReversed:!1],children:v}):k.jsx("div",babelHelpers["extends"]({"aria-label":j},(i||(i=c("stylex"))).props(m.root,a==="reversed"?m.rootReversed:!1),{children:v})),b[37]=a,b[38]=v,b[39]=j,b[40]=w,b[41]=f):f=b[41];return f}function p(a){return(a=a.name)!=null?a:""}function q(a,b){return k.jsx("li",{children:a},String(b))}q.displayName=q.name+" [from "+f.id+"]";function r(a){a=a.name;if(a!=null)return a;else return""}function s(a){return a.name!=null}g["default"]=a}),226);
__d("MWChatPromptFlyoutFrontCard.react",["fbt","BaseTextArea.react","CometPlaceholder.react","MWChatPollFacepile.react","MWPActor.react","ReQL","ReQLSuspense","react","react-compiler-runtime","useReStore","vulture"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l={textarea:{background:"x11g6tue",borderTopStyle:"x1ejq31n",borderEndStyle:"xd10rxx",borderBottomStyle:"x1sy0etr",borderStartStyle:"x17r0tee",color:"xzsf02u",fontSize:"x6prxxf",fontWeight:"x1xlr1w8",height:"x1m3v4wt",paddingTop:"xyamay9",paddingBottom:"x1l90r2v",paddingStart:"xurb0ha",paddingEnd:"x1sxyh0",paddingLeft:null,paddingRight:null,textAlign:"x2b8uid",width:"xrostsh",$$css:!0}};function m(){var a=d("react-compiler-runtime").c(10);c("vulture")("--I5l4MGyBjEFx_7p5moc1YSO7o=");var b=(i||(i=c("useReStore")))(),e=d("MWPActor.react").useActor(),g;a[0]!==b.tables.contacts||a[1]!==e?(g=function(){return d("ReQL").fromTableAscending(b.tables.contacts).getKeyRange(e).map(n)},a[0]=b.tables.contacts,a[1]=e,a[2]=g):g=a[2];var h;a[3]!==b||a[4]!==e?(h=[b,e],a[3]=b,a[4]=e,a[5]=h):h=a[5];g=d("ReQLSuspense").useFirst(g,h,f.id+":72");a[6]!==g?(h=g!=null?[{profile_picture_url:g}]:[],a[6]=g,a[7]=h):h=a[7];g=h;a[8]!==g?(h=k.jsx(c("MWChatPollFacepile.react"),{contacts:g,direction:"reversed",gap:"negative",size:"mediumLarge"}),a[8]=g,a[9]=h):h=a[9];return h}function n(a){return a.profilePictureUrl}function a(a){var b=d("react-compiler-runtime").c(12),e=a.maxLength,f=a.onChange,g=a.showFacepile;a=a.value;g=g===void 0?!1:g;var i;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(i={className:"x9bbmet xfh8nwu xoqspk4 x12v9rci x138vmkv xi1c1fh xdt5ytf x1iyjqo2 x2lah0s x1m3v4wt x1gslohp x12nagc x1n2onr6 xrostsh x1vjfegm"},b[0]=i):i=b[0];var j;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(j=h._(/*BTDS*/"G\u1ee3i \u00fd"),b[1]=j):j=b[1];var n;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(n=h._(/*BTDS*/"B\u1ea1n nh\u1eadp g\u00ec \u0111i"),b[2]=n):n=b[2];b[3]!==e||b[4]!==f||b[5]!==a?(j=k.jsx(c("BaseTextArea.react"),{"aria-label":j,maxLength:e,onChange:f,placeholder:n,suppressFocusRing:!0,unresizable:!0,value:a,xstyle:l.textarea}),b[3]=e,b[4]=f,b[5]=a,b[6]=j):j=b[6];b[7]!==g?(n=g?k.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatPromptFlyoutFrontCard",children:k.jsx("div",babelHelpers["extends"]({className:"x1gryazu xkrivgy x1l90r2v"},{children:k.jsx(m,{})}))}):null,b[7]=g,b[8]=n):n=b[8];b[9]!==j||b[10]!==n?(e=k.jsxs("div",babelHelpers["extends"]({},i,{children:[j,n]})),b[9]=j,b[10]=n,b[11]=e):e=b[11];return e}g["default"]=a}),226);
__d("MWChatReactionsActionContainer.react",["JSResourceForInteraction","MWV2MessageRowIsRowFocusedContext.react","MWXLazyPopoverTrigger.react","MWXPopoverLoadingState.react","emptyFunction","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useContext,k=b.useState,l={popoverLoading:{minHeight:"x1wiwyrm",minWidth:"x1q6reyq",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(27),e=a.align,f=a.alwaysShowEmojiPicker,g=a.children,h=a.closeActionsMenu,m=a.disableCustomReactions,n=a.hasReactionsV2,o=a.isBroadcastChannel,p=a.isBroadcastThread,q=a.isSecure,r=a.messageID,s=a.onVisibilityChange,t=a.reactionsPopoverResource,u=a.sendReaction;a=e===void 0?"middle":e;e=f===void 0?!1:f;f=m===void 0?!1:m;m=q===void 0?!1:q;var v=j(d("MWV2MessageRowIsRowFocusedContext.react").context);if(b[0]!==t){q=(q=t)!=null?q:c("JSResourceForInteraction")("MWChatReactionsMenu.react").__setRef("MWChatReactionsActionContainer.react");b[0]=t;b[1]=q}else q=b[1];t=q;q=k(!1);var w=q[0],x=q[1];q=e||w;b[2]!==h||b[3]!==n||b[4]!==u?(e=function(a,b){b=b[0];b=n!==!0&&b===a;u(a,b);return h()},b[2]=h,b[3]=n,b[4]=u,b[5]=e):e=b[5];w=e;b[6]!==v||b[7]!==s?(e=function(a){a||x(!1),s(a),v.setFocused(a)},b[6]=v,b[7]=s,b[8]=e):e=b[8];e=e;a=a==="end_"?"end":a;var y;b[9]===Symbol["for"]("react.memo_cache_sentinel")?(y=i.jsx(c("MWXPopoverLoadingState.react"),{withArrow:!1,xstyle:l.popoverLoading}),b[9]=y):y=b[9];var z;b[10]!==h||b[11]!==f||b[12]!==o||b[13]!==p||b[14]!==m||b[15]!==r||b[16]!==w||b[17]!==q?(z={closeActionsMenu:h,disableCustomReactions:f,isBroadcastChannel:o,isBroadcastThread:p,isSecure:m,messageID:r,onClose:c("emptyFunction"),onSelect:w,setShowEmojiPicker:x,showEmojiPicker:q},b[10]=h,b[11]=f,b[12]=o,b[13]=p,b[14]=m,b[15]=r,b[16]=w,b[17]=q,b[18]=z):z=b[18];f=q?"dialog":"menu";o=q?"below":"above";b[19]!==g||b[20]!==e||b[21]!==t||b[22]!==z||b[23]!==f||b[24]!==o||b[25]!==a?(p=i.jsx(c("MWXLazyPopoverTrigger.react"),{align:a,fallback:y,onVisibilityChange:e,popoverProps:z,popoverResource:t,popoverType:f,position:o,children:g}),b[19]=g,b[20]=e,b[21]=t,b[22]=z,b[23]=f,b[24]=o,b[25]=a,b[26]=p):p=b[26];return p}g["default"]=a}),98);
__d("MWFalcoFeatureEventLogger",["I64","LSMessagingThreadTypeUtil","MessengerWebEventsFalcoEvent","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e,f,g){c("gkx")("24170")&&c("MessengerWebEventsFalcoEvent").log(function(){return{entry_point:a,event_name:b,is_secured:d("LSMessagingThreadTypeUtil").isArmadilloSecure(g),other_user_fbid:e!=null?(h||(h=d("I64"))).to_string(e):null,thread_fbid:(h||(h=d("I64"))).to_string(f)}})}g.logEvent=a}),98);
__d("MWPConversationSearchContext.react",["$InternalEnum","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;f=e.createContext;e.useCallback;e.useMemo;var j=e.useState;e=b("$InternalEnum")({NAVIGATING:1,NAVIGATED:2});var k=f();b=k;function a(a){var b=d("react-compiler-runtime").c(9);a=a.children;var e=j(),f=e[0];e=e[1];var g=j(),h=g[0];g=g[1];var l=j(!1),m=l[0],n=l[1];l=j(!1);var o=l[0],p=l[1];b[0]===Symbol["for"]("react.memo_cache_sentinel")?(l=function(a){p(a),c("gkx")("4741")&&n(a)},b[0]=l):l=b[0];l=l;b[1]!==o||b[2]!==h||b[3]!==f||b[4]!==m?(l={isConversationSearchVisible:o,navigation:h,search:f,setIsConversationSearchVisible:l,setNavigation:g,setSearch:e,setShouldNavigateSidePanelToSearch:n,shouldNavigateSidePanelToSearch:m},b[1]=o,b[2]=h,b[3]=f,b[4]=m,b[5]=l):l=b[5];g=l;e=g;b[6]!==a||b[7]!==e?(o=i.jsx(k.Provider,{value:e,children:a}),b[6]=a,b[7]=e,b[8]=o):o=b[8];return o}g.SearchNavigationState=e;g.context=b;g.MWPConversationSearchContext=a}),98);
__d("MWPConversationSearchLogger",["I64","LSMessagingThreadTypeUtil","LsMessageSearchEndFalcoEvent","LsMessageSearchMsgImpressionFalcoEvent","LsMessageSearchMsgResultChosenFalcoEvent","LsMessageSearchSearchClickedFalcoEvent","LsMessageSearchStartFalcoEvent","LsMessageSearchThreadImpressionFalcoEvent","LsMessageSearchThreadListClickFalcoEvent","coerceMessagingThreadTypeToLSThreadType","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i=null,j=void 0;function k(a,b,d){var e;e=a?(e=j)!=null?e:l():c("uuidv4")();b={instanceId:e,threadKey:b,threadType:d,universalSearchInstanceId:a?e:void 0};i=b;return b}function l(){var a=c("uuidv4")();j=a;return a}function a(){var a=l();c("LsMessageSearchStartFalcoEvent").log(function(){return{entry_surface:2,message_search:{instance_id:a,surface_name:0,universal_search_instance_id:a}}})}function b(a,b){var e=j;if(e==null)return;var f=a.threadKey,g=a.threadType;k(!0,f,g);c("LsMessageSearchThreadListClickFalcoEvent").log(function(){var f;return{message_search:{instance_id:e,msg_match_cnt:(h||(h=d("I64"))).to_string((f=a.matchCount)!=null?f:(h||(h=d("I64"))).zero),secure_msg_match_cnt:b!=null?b.toString():null,universal_search_instance_id:e},thread:{type:c("coerceMessagingThreadTypeToLSThreadType")(g)}}})}function e(a,b){var e=j;if(e==null)return;var f=a.threadType;c("LsMessageSearchThreadImpressionFalcoEvent").log(function(){var g;return{message_search:{instance_id:e,msg_match_cnt:(h||(h=d("I64"))).to_string((g=a.matchCount)!=null?g:(h||(h=d("I64"))).zero),secure_msg_match_cnt:b!=null?b.toString():null,surface_name:0,universal_search_instance_id:e},thread:{type:c("coerceMessagingThreadTypeToLSThreadType")(f)}}})}function m(){var a=i;if(a==null)return;c("LsMessageSearchEndFalcoEvent").log(function(){return{end_action:0,message_search:{instance_id:a.instanceId,universal_search_instance_id:a.universalSearchInstanceId}}});i=void 0}function f(a,b){m();var e=k(!1,a,b),f=d("LSMessagingThreadTypeUtil").isArmadilloSecure(b);c("LsMessageSearchStartFalcoEvent").log(function(){return{entry_surface:0,is_fts:f,message_search:{instance_id:e.instanceId,surface_name:1},thread:{type:c("coerceMessagingThreadTypeToLSThreadType")(b)}}})}function n(){var a=i;if(a==null)return;c("LsMessageSearchSearchClickedFalcoEvent").log(function(){return{message_search:{instance_id:a.instanceId,universal_search_instance_id:a.universalSearchInstanceId},thread:{type:a.threadType!=null?c("coerceMessagingThreadTypeToLSThreadType")(a.threadType):void 0}}})}function o(a){return(a==null?void 0:a.threadType)==null?void 0:d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)?1:0}function p(a,b,e){var f=i;if(f==null)return;c("LsMessageSearchMsgResultChosenFalcoEvent").log(function(){return{click_surface_name:1,message:{message_type:o(e),sent_time:(e==null?void 0:e.messageTimestampMs)!=null?(h||(h=d("I64"))).to_float(e.messageTimestampMs):void 0},message_search:{instance_id:f.instanceId,universal_search_instance_id:f.universalSearchInstanceId},position:b.toString(),prev_or_next:a,thread:{type:f.threadType!=null?c("coerceMessagingThreadTypeToLSThreadType")(f.threadType):void 0}}})}function q(a){var b=i;if(b==null)return;c("LsMessageSearchMsgImpressionFalcoEvent").log(function(){return{message:{message_type:o(a),sent_time:(a==null?void 0:a.messageTimestampMs)!=null?(h||(h=d("I64"))).to_float(a.messageTimestampMs):void 0},message_search:{instance_id:b.instanceId,surface_name:5,universal_search_instance_id:b.universalSearchInstanceId},thread:{type:b.threadType!=null?c("coerceMessagingThreadTypeToLSThreadType")(b.threadType):void 0}}})}q={logMessageSearchEnd:m,logMessageSearchMsgImpression:q,logMessageSearchMsgResultChosen:p,logMessageSearchSearchClicked:n,logMessageSearchStart:f,logUniversalMessageSearch:a,logUniversalMessageSearchThreadClicked:b,logUniversalMessageSearchThreadImpression:e};g["default"]=q}),98);
__d("useMWPClearConversationSearch",["LSClearMessageSearchTableStoredProcedure","LSFactory","LSIntEnum","LSMessageSearchType","MWPConversationSearchContext.react","MWPVisibleMessageContext.react","nullthrows","promiseDone","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=j||d("react");b.useCallback;var k=b.useContext;function a(){var a=d("react-compiler-runtime").c(7),b=k(d("MWPConversationSearchContext.react").context),e;a[0]!==b?(e=c("nullthrows")(b),a[0]=b,a[1]=e):e=a[1];b=e;var g=b.setNavigation,j=b.setSearch;e=d("MWPVisibleMessageContext.react").useMWPVisibleMessageContext();var m=e.setVisibleMessage,n=(h||(h=c("useReStore")))();a[2]!==n||a[3]!==g||a[4]!==j||a[5]!==m?(b=function(a){var b;b=(b=a==null?void 0:a.shouldResetNavigation)!=null?b:!0;var e=(a=a==null?void 0:a.shouldClearThreadSearch)!=null?a:!0;j();b&&g();m(l);c("promiseDone")(n.runInTransaction(async function(a){a=c("LSFactory")(a);await c("LSClearMessageSearchTableStoredProcedure")(a,{type_:(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageSearchType").MESSAGE)});e&&await c("LSClearMessageSearchTableStoredProcedure")(a,{type_:(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageSearchType").THREAD)})},"readwrite",void 0,void 0,f.id+":53"))},a[2]=n,a[3]=g,a[4]=j,a[5]=m,a[6]=b):b=a[6];return b}function l(a){return(a==null?void 0:a.source)==="Search"?null:a}g.default=a}),98);
__d("useMWPCloseConversationSearchSession",["MWPConversationSearchContext.react","MWPConversationSearchLogger","nullthrows","react","react-compiler-runtime","useMWPClearConversationSearch"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useContext;function a(){var a=d("react-compiler-runtime").c(5),b=c("useMWPClearConversationSearch")(),e=i(d("MWPConversationSearchContext.react").context),f;a[0]!==e?(f=c("nullthrows")(e),a[0]=e,a[1]=f):f=a[1];e=f;var g=e.setIsConversationSearchVisible;a[2]!==b||a[3]!==g?(f=function(a){g(!1),b(a),c("MWPConversationSearchLogger").logMessageSearchEnd()},a[2]=b,a[3]=g,a[4]=f):f=a[4];return f}g["default"]=a}),98);
__d("MWInboxInfoPanelContext.react",["Int64Hooks","MWInboxPersistedUIState","MWResponsiveLayoutConstants","MWResponsiveLayoutContext.react","cr:124","emptyFunction","gkx","isMessengerPWA","react","useEmptyFunction","useMWPCloseConversationSearchSession"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h,k=j.createContext,l=j.useCallback,m=j.useContext,n=j.useRef,o=j.useState,p=(j=b("cr:124"))!=null?j:c("useEmptyFunction"),q=k({currentSubthreadView:null,isOnBestPracticesPageRef:{current:!1},isOnMemberRequestsPageRef:{current:!1},navToBestPracticesRef:{current:!1},openMethod:"saved_state",pushBestPracticesPage:c("emptyFunction"),pushMemberRequestsPage:c("emptyFunction"),setCurrentSubthreadView:c("emptyFunction"),setPushBestPracticesPage:c("emptyFunction"),setPushMemberRequestsPage:c("emptyFunction"),setShouldNavToMemberRequests:c("emptyFunction"),setShowSubthreadList:c("emptyFunction"),setSubthreadKey:c("emptyFunction"),setThreadInfoVisible:c("emptyFunction"),shouldNavToMemberRequests:!1,sourceIsSubthreadNav:{current:!1},subthreadKey:null,threadInfoVisible:!c("isMessengerPWA")()});function a(){return m(q)}function e(a){a=a.children;var b=d("MWInboxPersistedUIState").usePersistedUIState(!c("isMessengerPWA")(),"__MWInboxDetail.info__"),e=b[0],f=b[1];b=o("saved_state");var g=b[0],h=b[1],j=n(!1);b=o(null);var k=b[0],r=b[1],s=n(!1),t=j.current,u=n(c("emptyFunction")),v=u.current,w=n(!1),x=n(!1),y=n(!1);b=o(null);var z=b[0],A=b[1],B=c("useMWPCloseConversationSearchSession")();b=l(function(){f(!1),r(null),A(null)},[f]);p(d("MWResponsiveLayoutConstants").MWLayoutPanel.INFO_PANEL,b);b=m(c("MWResponsiveLayoutContext.react"));var C=b.popCard,D=b.pushCard,E=l(function(a){if(c("gkx")("24056")){a=Boolean(a)===!1?C:D;a(d("MWResponsiveLayoutConstants").MWLayoutPanel.INFO_PANEL)}},[D,C]),F=l(function(a){a?(h("callback"),A(null),r(null)):B({shouldClearThreadSearch:!1,shouldResetNavigation:!1}),f(a),E(a)},[f,B,E]),G=l(function(a){f(!1),r(a),E(a)},[f,E]),H=l(function(a){j.current=a},[]),I=l(function(a,b){b===void 0&&(b=!1),a&&(f(!1),B({shouldClearThreadSearch:!1,shouldResetNavigation:!1}),r(null)),A(a?"subthreadList":null),y.current=a&&b,E(a)},[f,E,B]),J=l(function(a){u.current=a},[]),K=l(function(a){u.current=a},[]);b=d("Int64Hooks").useMemoInt64(function(){return{currentSubthreadView:z,isOnBestPracticesPageRef:x,isOnMemberRequestsPageRef:w,navToBestPracticesRef:s,openMethod:g,pushBestPracticesPage:v,pushMemberRequestsPage:v,setCurrentSubthreadView:A,setPushBestPracticesPage:K,setPushMemberRequestsPage:J,setShouldNavToMemberRequests:H,setShowSubthreadList:I,setSubthreadKey:G,setThreadInfoVisible:F,shouldNavToMemberRequests:t,sourceIsSubthreadNav:y,subthreadKey:k,threadInfoVisible:e}},[z,x,g,v,K,J,H,I,G,F,t,k,e,s]);return i.jsx(q.Provider,{value:b,children:a})}e.displayName=e.name+" [from "+f.id+"]";g.useMWInboxInfoPanelContext=a;g.MWInboxInfoPanelProvider=e}),98);
__d("useGetForwardSource",["LSIntEnum","LSMessagingThreadAttributionType","MWLSThreadDisplayContext","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=d("react-compiler-runtime").c(4),b=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();if(b!=null)if(b==="Inbox"){var e;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_FORWARD),a[0]=e):e=a[0];return e}else if(b==="ChatTab"){a[1]===Symbol["for"]("react.memo_cache_sentinel")?(e=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_CHAT_FORWARD),a[1]=e):e=a[1];return e}else{a[2]===Symbol["for"]("react.memo_cache_sentinel")?(b=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW),a[2]=b):b=a[2];return b}else{a[3]===Symbol["for"]("react.memo_cache_sentinel")?(e=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW),a[3]=e):e=a[3];return e}}g["default"]=a}),98);
__d("useLSMessagingInitiatingSource",["LSIntEnum","LSMessagingInitiatingSource","MWLSThreadDisplayContext","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=d("react-compiler-runtime").c(4),b=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();if(b==null)return;else if(b==="Inbox"){var e;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingInitiatingSource").FACEBOOK_INBOX),a[0]=e):e=a[0];return e}else if(b==="FullscreenChat"){a[1]===Symbol["for"]("react.memo_cache_sentinel")?(e=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingInitiatingSource").FACEBOOK_FULLSCREEN),a[1]=e):e=a[1];return e}else if(b==="ChatTab"){a[2]===Symbol["for"]("react.memo_cache_sentinel")?(e=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingInitiatingSource").FACEBOOK_CHAT),a[2]=e):e=a[2];return e}else{a[3]===Symbol["for"]("react.memo_cache_sentinel")?(b=(h||(h=d("LSIntEnum"))).ofNumber(c("LSMessagingInitiatingSource").ROOMS_SIDE_CHAT),a[3]=b):b=a[3];return b}}g["default"]=a}),98);
__d("MessagePowerUp",[],(function(a,b,c,d,e,f){a=Object.freeze({AVATAR_LOVE:1e3,AVATAR_ANGER:1001,AVATAR_LAUGH:1002,AVATAR_CRY:1003,NONE:0,LOVE:1,GIFT_WRAP:2,CELEBRATION:3,FIRE:4,HALLOWEEN:5,NOM_NOM_DASH:6,NEW_YEARS:7,VALENTINES_DAY:8,ANTI_VALENTINES:9});f["default"]=a}),66);
__d("WorkChatMessageType",[],(function(a,b,c,d,e,f){"use strict";a="text";b="gif";c="sticker";d="audio";e="file";f.text=a;f.gif=b;f.sticker=c;f.audio=d;f.file=e}),66);
__d("useMWLSSendStickerMessage",["I64","Int64Hooks","LSFactory","LSIntEnum","LSMailboxType","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSOptimisticSendMessageV2StoredProcedure","LSShape","LSThreadAttributionTypeUtil","MWPActor.react","MessagePowerUp","WorkChatMessageType","promiseDone","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b,e){var g=d("react-compiler-runtime").c(7),k=(j||(j=c("useReStore")))(),l=d("MWPActor.react").useActor(),m,n;g[0]!==l||g[1]!==b||g[2]!==a||g[3]!==e||g[4]!==k?(m=function(g,j,m){c("promiseDone")(k.runInTransaction(function(e){var f;f=d("LSThreadAttributionTypeUtil").getSourceAndResetAttribution(g,(f=a)!=null?f:"unknown");return c("LSOptimisticSendMessageV2StoredProcedure")(c("LSFactory")(e),{extraSendMessageParams:d("LSShape").ofRecord({calculate_denormalizations:!0,initiating_source:b,mark_read:!0,optimistic_attachment_preview:d("LSShape").ofRecord({playable_url:void 0,playable_url_expiration_timestamp_ms:void 0,playable_url_fallback:void 0,playable_url_mime_type:void 0,preview_height:(h||(h=d("I64"))).zero,preview_url:m,preview_url_expiration_timestamp_ms:void 0,preview_url_fallback:void 0,preview_url_mime_type:void 0,preview_width:h.zero}),power_up_style:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagePowerUp").NONE),reply_source_id:void 0,reply_source_type:i.ofNumber(c("LSMessageReplySourceType").MESSAGE),reply_source_type_v2:i.ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE),snippet_has_emoji:!1,source:f,sticker_id:h.of_string(j)}),mailboxType:i.ofNumber(c("LSMailboxType").MESSENGER),senderId:l,threadKey:g,threadType:i.ofNumber(1)})},"readwrite",void 0,void 0,f.id+":49").then(function(a){e==null?void 0:e(d("WorkChatMessageType").sticker,1,a[0])}))},n=[k,l,b,a,e],g[0]=l,g[1]=b,g[2]=a,g[3]=e,g[4]=k,g[5]=m,g[6]=n):(m=g[5],n=g[6]);return d("Int64Hooks").useCallbackInt64(m,n)}g["default"]=a}),98);
__d("MWLSForwardMessage",["I64","Int64Hooks","LSFactory","LSMediaUrlAttachment","LSOptimisticSendAttachmentForwardStoredProcedure","LSOptimisticSendMessageForwardStoredProcedure","MWChatThreadId","MWPActor.react","ODS","Promise","ReQL","promiseDone","react-compiler-runtime","useGetForwardSource","useLSMessagingInitiatingSource","useLSMessagingSource","useMWLSSendStickerMessage","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function a(){var a=d("react-compiler-runtime").c(7),e=(k||(k=c("useReStore")))(),g=d("MWPActor.react").useActor(),o=c("useLSMessagingInitiatingSource")(),p=c("useGetForwardSource")(),q=c("useLSMessagingSource")(),r=c("useMWLSSendStickerMessage")(q,o),s;a[0]!==o||a[1]!==r||a[2]!==g||a[3]!==p||a[4]!==e?(q=function(a,k,q){if(q.type!=="sent")return;q=q.value;var s=q.timestamp,t=q.messageId,u=q.threadId;(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","send");var v=function(){return e.runInTransaction(function(b){return c("LSOptimisticSendMessageForwardStoredProcedure")(c("LSFactory")(b),{forwardedMsgId:t,forwardedMsgThreadKey:u,forwardedMsgTimestampMs:s,initiatingSource:o,senderId:g,source:p,threadKey:a,threadType:k})},"readwrite",void 0,void 0,f.id+":62").then(n)};c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.messages).getKeyRange(u,s,t)).then(function(c){if(c==null)return v();var f=c.stickerId;if(f!=null)return d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.attachments).getKeyRange(u,t)).then(function(c){c=c!=null?d("LSMediaUrlAttachment").previewUrl(c):void 0;r(a,(j||(j=d("I64"))).to_string(f),c);return(h||(h=b("Promise"))).resolve()});else return v()}),m,l)},s=[e,g,o,p,r],a[0]=o,a[1]=r,a[2]=g,a[3]=p,a[4]=e,a[5]=q,a[6]=s):(q=a[5],s=a[6]);return d("Int64Hooks").useCallbackInt64(q,s)}function l(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","failure")}function m(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","success")}function n(){}function e(){var a=d("react-compiler-runtime").c(6),b=(k||(k=c("useReStore")))(),e=d("MWPActor.react").useActor(),g=c("useLSMessagingInitiatingSource")(),h=c("useGetForwardSource")(),l,m;a[0]!==g||a[1]!==e||a[2]!==h||a[3]!==b?(l=function(){return function(a,k,l){(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","send");var m=d("MWChatThreadId").getMessagingThreadType(a),n=d("MWChatThreadId").toThreadKey(a);c("promiseDone")(b.runInTransaction(function(a){return c("LSOptimisticSendAttachmentForwardStoredProcedure")(c("LSFactory")(a),{forwardedAttachmentFbid:(j||(j=d("I64"))).of_string(k),initiatingSource:g,senderId:e,source:h,threadKey:n,threadType:m})},"readwrite",void 0,void 0,f.id+":140"),p,o)}},m=[b,e,g,h],a[0]=g,a[1]=e,a[2]=h,a[3]=b,a[4]=l,a[5]=m):(l=a[4],m=a[5]);return d("Int64Hooks").useMemoInt64(l,m)}function o(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","failure")}function p(){return(i||(i=d("ODS"))).bumpEntityKey(3185,"mw_forward","success")}g.useForwardMessage=a;g.useForwardAttachment=e}),98);
__d("getMessengerPreciseTimestamp",["$InternalEnum","formatDate"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum").Mirrored(["TODAY","WEEK_AGO","CURRENT_YEAR","OTHER_YEAR"]);d=864e5;var i=6*d;function j(a){a=new Date(a);var b=new Date();b=new Date(b.getFullYear(),b.getMonth(),b.getDate());if(b<a)return h.TODAY;if(b.getTime()-i<a.getTime())return h.WEEK_AGO;return b.getFullYear()===a.getFullYear()?h.CURRENT_YEAR:h.OTHER_YEAR}function k(a){a=j(a);switch(a){case h.TODAY:return"g:ia";case h.WEEK_AGO:return"l g:ia";case h.CURRENT_YEAR:return"F jS, g:ia";case h.OTHER_YEAR:return"F j, Y g:i a"}}function a(a,b){return c("formatDate")(new Date(a),k(a),void 0,b)}g["default"]=a}),98);
__d("MWMessageDeliveryStatus",["fbt","I64","LSIntEnum","getFBTSafeGenderFromGenderConst","getMessengerPreciseTimestamp","intlList","intlSummarizeNumber"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function a(a){if(a.length!==1)return{heads:a,type:"MultipleSeenHeads"};a=a[0];return{head:a,type:"SingleSeenHead"}}function b(a,b){return{delivered:b,heads:a,type:"DeliveredAndRead"}}function e(a){return{count:a,type:"SeenCount"}}function k(a){return a.timestamp>0?h._(/*BTDS*/"_j{\"*\":\"{full name} \\u0111\\u00e3 xem l\\u00fac {seen time}\"}",[h._name("full name",a.name,c("getFBTSafeGenderFromGenderConst")(a.gender)),h._param("seen time",c("getMessengerPreciseTimestamp")(a.timestamp))]):h._(/*BTDS*/"_j{\"*\":\"{full name} \\u0111\\u00e3 xem\"}",[h._name("full name",a.name,c("getFBTSafeGenderFromGenderConst")(a.gender))])}function l(a,b){if(a.length===0)return"";if(b)return h._(/*BTDS*/"M\u1ecdi ng\u01b0\u1eddi \u0111\u00e3 xem").toString();b=a.map(function(a){return h._(/*BTDS*/"_j{\"*\":\"{full name}\"}",[h._name("full name",a.name,c("getFBTSafeGenderFromGenderConst")(a.gender))])});a=c("intlList")(b,c("intlList").CONJUNCTIONS.AND,c("intlList").DELIMITERS.COMMA);return h._(/*BTDS*/"{full name} \u0111\u00e3 xem",[h._param("full name",a)]).toString()}function m(a){a=c("intlSummarizeNumber")(a);return h._(/*BTDS*/"{seen count} ng\u01b0\u1eddi \u0111\u00e3 xem",[h._param("seen count",a)]).toString()}var n={delivered:h._(/*BTDS*/"\u0110\u00e3 chuy\u1ec3n"),error:h._(/*BTDS*/"Kh\u00f4ng th\u1ec3 g\u1eedi"),loading:h._(/*BTDS*/"\u0110ang t\u1ea3i..."),retriableError:h._(/*BTDS*/"Nh\u1ea5p \u0111\u1ec3 th\u1eed l\u1ea1i."),sending:h._(/*BTDS*/"\u0110ang g\u1eedi"),sent:h._(/*BTDS*/"\u0110\u00e3 g\u1eedi")};function f(a){switch(a.type){case"Sending":return n.sending;case"Sent":case"Delivered":return n.sent;case"Error":return n.error;case"SingleSeenHead":return k(a.head);case"NoneStatus":case"MultipleSeenHeads":return"";case"DeliveredAndRead":return l(a.heads,a.delivered);case"SeenCount":return m(a.count);case"Loading":return n.loading;case"RetriableError":return n.retriableError;case"ValidationError":return""}}function o(a){switch(a.type){case"Sending":return n.sending;case"Sent":return n.sent;case"Delivered":return n.delivered;case"Error":case"RetriableError":return n.error;case"SingleSeenHead":return k(a.head);case"DeliveredAndRead":return l(a.heads,a.delivered);default:return""}}function p(a){if((i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(1)))return{type:"Sending"};else if((i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(2))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(6)))return{type:"Sent"};else if((i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(4))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(5)))return{type:"Error"};else return{type:"NoneStatus"}}function q(a,b,c){var e=p(a.sendStatusV2);if((i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(4))||(i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(5))||(i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(1)))return e;else if(!c&&(i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(2)))return{type:"NoneStatus"};else if((i||(i=d("I64"))).ge(b,a.timestampMs))return{type:"Delivered"};else return e}function r(a){return["SingleSeenHead","Sending","MultipleSeenHeads","Error","RetriableError"].includes(a.type)}g.seenHead=a;g.deliveredAndRead=b;g.seenCount=e;g.getSingleSeenHead=k;g.getSeenCount=m;g.Titles=n;g.getBroadcastStatusTitle=f;g.getStatusTitle=o;g.getFromSendStatus=p;g.getDeliveryStatusForMessageSentByYou=q;g.isAlwaysShownStatus=r}),226);
__d("MWMessageListLoggingContext",["react","react-compiler-runtime","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));f=h;var j=f.createContext,k=f.useContext,l=f.useRef,m=j({current:""});function a(a){var b=d("react-compiler-runtime").c(2),c=a.children;a=a.flowInstanceId;a=l(a);b[0]!==c?(a=i.jsx(m.Provider,{value:a,children:c}),b[0]=c,b[1]=a):a=b[1];return a}function b(){return k(m)}function e(){var a=k(m);(a.current===null||a.current==="")&&(a.current=c("uuidv4")());return a}g.MWMessageListLoggingContext=a;g.useFlowInstanceIdContext=b;g.useFlowInstanceId=e}),98);
__d("MWPComposerMediaUploadUtil",["FBLogger","I64","LSGetAttachmentType","LSIntEnum","MessagingAttachmentType","ResumableUploadServiceState.enum","URI","cr:6057","cr:7187","emptyFunction","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k="messenger_file",l="messenger_audio",m="messenger_image",n="messenger_video",o="file_type",p="image_type",q="video_type",r="audio_type",s="FILE_ATTACHMENT",t="VOICE_MESSAGE",u="target_id";async function v(a,d,e,f,g,h,i,j,k,l,m){d===void 0&&(d=c("emptyFunction"));f===void 0&&(f=c("emptyFunction"));g===void 0&&(g=!1);var n="/ajax/mercury/upload.php";j===!0&&(n="/ajax/mercury/chatsupportuser/upload.php");var o=await b("cr:6057").load();o=new o({concurrentLimit:3,onUploadFailure:f,onUploadProgress:d,onUploadStart:function(b,c){a&&a(b,c.upload._file.size,c.upload._file.type)},onUploadSuccess:function(a,b){b=b.response.payload.metadata;var d;if(b==null)c("FBLogger")("messenger_web_media").warn("Empty payload"),d={};else{b=b[0];b!=null?d=b:(c("FBLogger")("messenger_web_media").warn("Empty metadata isChatSupportUser: %s",j),d={})}b=d.fbid;var f=d.image_id,g=d.video_id,h=d.audio_id,i=d.gif_id;d=d.file_id;f=(g=(b=(f=(b=(b=b)!=null?b:f)!=null?b:g)!=null?f:h)!=null?b:i)!=null?g:d;typeof f==="number"&&(f=f.toString());x(f);e(a,f);if(f==null)throw c("FBLogger")("messenger_web").mustfixThrow("Unrecognized file upload success payload")},retryLimit:1,uploadEndpoint:n});f={};f.data={chat_support_user_id:j===!0&&k!=null?k:void 0,nonce:j===!0&&m!=null?m:void 0,voice_clip:g?!0:void 0,voice_clip_waveform_data:g?JSON.stringify(l):void 0};o.getAsyncFileUploadRequest(h,i,f).send()}function w(a,e,f,g,i,v){f===void 0&&(f=c("emptyFunction"));if(!b("cr:7187"))return;var w=(j||(j=c("URI"))).getRequestURI().getDomain(),x=/workplace.com/i.test(w)?"workplace.com":/messenger.com/i.test(w)?"messenger.com":"facebook.com";g.forEach(function(g,j){var w=g.attachmentType,y=g.file;g=k;var z=o,A=s;switch(w){case(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE):g=m;z=p;break;case(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO):g=l;z=r;A=t;break;case(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO):g=n;z=q;break;default:break}w=b("cr:7187").create({consumer:g,customHttpHeaders:new Map([[u,v],[z,A]]),serviceDomain:x});w.addListener((g=c("ResumableUploadServiceState.enum")).START,function(){a&&a(i[j],y.size,y.type)});w.addListener(g.SUCCESS,function(a){e(i[j],a.media_id)});w.addListener(g.FAIL,function(a){f(i[j],{response:a})});w.addListener(g.TRANSPORT_FAILURE,function(a){f(i[j],{response:a})});void w.resume(y)})}function x(a){if(a!=null){var b=Number(a),d=b.toString();b>Number.MAX_SAFE_INTEGER&&d!==a&&c("FBLogger")("work_web_messaging","messaging-composer-upload-fbid-out-of-range").warn("FBID for attachment is out of JS Number range and it's not correctly handled on client: %d",a)}}async function a(a,e,f,g,j,k,l,m,n,o,p,q){e===void 0&&(e=c("emptyFunction"));g===void 0&&(g=c("emptyFunction"));j===void 0&&(j=!1);if(b("cr:7187")&&q!=null&&m!==!0){var r=[],s=[],t=[],u=[],x=await Promise.all(k.map(function(a){return d("LSGetAttachmentType").LSGetAttachmentType(a)}));k.forEach(function(a,b){var e=x[b];(i||(i=d("I64"))).equal(e,(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?(r.push({attachmentType:e,file:a}),s.push(l[b])):(t.push(a),u.push(l[b]))});r.length>0&&w(a,f,g,r,s,q);t.length>0&&c("promiseDone")(v(a,e,f,g,j,t,u,m,n,o,p))}else c("promiseDone")(v(a,e,f,g,j,k,l,m,n,o,p))}function e(a,b,e,f){return{action_url:void 0,attachment_fbid:a,attachment_index:(i||(i=d("I64"))).zero,attachment_type:(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO),cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:void 0,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:a,original_file_hash:void 0,playable_duration_ms:i.of_float(e*1e3),playable_url:URL.createObjectURL(b),playable_url_mime_type:b.type,preview_height:void 0,preview_url:void 0,preview_url_mime_type:void 0,preview_width:void 0,sampling_frequency_hz:f==null?void 0:f.sampling_freq,source_text:void 0,subtitle_text:void 0,title_text:void 0,waveform_data:f==null?void 0:(a=f.amplitudes)==null?void 0:a.join(","),xma_layout_type:void 0,xmas_template_type:void 0}}function f(a,b){a=a.map(function(a){return{action_url:void 0,attachment_fbid:a.offlineAttachmentId,attachment_index:(i||(i=d("I64"))).zero,attachment_type:a.attachmentType,cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:a.filename,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:a.offlineAttachmentId,original_file_hash:void 0,playable_duration_ms:void 0,playable_url:a.previewUrl,playable_url_mime_type:a.mimeType,preview_height:a.previewHeight,preview_url:a.previewUrl,preview_url_mime_type:void 0,preview_width:a.previewWidth,source_text:void 0,subtitle_text:void 0,title_text:void 0,xma_layout_type:void 0,xmas_template_type:void 0}});var e=[],f=[];a.forEach(function(a){(i||(i=d("I64"))).equal(a.attachment_type,(h||(h=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))&&!b?f.push(a):e.push([a])});f.length>0&&e.unshift(f);return e.map(function(a){return a.map(function(a,b){return babelHelpers.extends({},a,{attachment_index:(i||(i=d("I64"))).of_int32(b)})})})}g.startUpload=a;g.getAudioAttachment=e;g.createPartitionedAttachments=f}),98);
__d("MWPOpenComposerUtils",["I64","LSRemoveMediaSendJobsStoredProcedure","LSResumeMediaSendJobStoredProcedure","MWConsole"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return a.media_staging.get(b).then(function(c){if(c!=null)return a.media_staging.delete(b);else return Promise.resolve()})}async function b(a,b,c){b=await a.media_staging.get(b);b!=null&&await a.media_staging.put(c(b))}function e(a,b,c,d,e){return a.attachments.get(b,c,d).then(function(f){if(f!=null)return a.attachments.upsert([b,c,d],e(f));else return Promise.resolve()})}function f(a,b,e){return c("LSResumeMediaSendJobStoredProcedure")(a,{dataTraceId:(e=e)!=null?e:void 0,jobId:b,pluginType:(h||(h=d("I64"))).zero}).then(function(d){var e=d[0],f=d[1];f=d[2];if(e)return c("LSRemoveMediaSendJobsStoredProcedure")(a,{offlineThreadingId:b});else return Promise.resolve()})}g.deleteMediaStaging=a;g.updateMediaStaging=b;g.updateAttachment=e;g.resumeSendJob=f}),98);
__d("MWPThreadCapabilitiesContext",["I64","Int64Hooks","LSIntEnum","LSMessageThreadUnsendabilityStatus","LSThreadBitOffset","ThreadStatus","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||(h=d("react"));e=h;f=e.createContext;var l=e.useContext,m=f({blurMediaEnabled:!1,canUnsendMessage:!1,communityMessagingChannelDescriptionCustomization:!1,communityMessagingChannelInvite:!1,disableLinks:!1,editMessageEnabled:!1,feedbackAndReportEnabled:!1,hasLSThreadBitOffset:function(a){return!1},isPaused:!1,localDeleteMessageEnabled:!1,messageForwardEnabled:!1,messageUnsendEnabled:!1,modifyPinnedMessageV2Enabled:!1,reactEnabled:!1,reactionsV2WriteEnabled:!1,replyEnabled:!1,reportMessageToAdminEnabled:!1,rtcVideoCallEnabled:!1,rtcVoiceCallEnabled:!1,seenCountV2Enabled:!1,subThreadCreationEnabled:!1});function a(a){var b=d("react-compiler-runtime").c(17),e=a.children,f=a.customCapabilityCheck,g=a.thread,h=g.capabilities,l=g.capabilities2,n=g.capabilities3,o=g.capabilities4,p=g.capabilities5,q=g.threadType,r;b[0]!==h||b[1]!==l||b[2]!==n||b[3]!==o||b[4]!==p||b[5]!==q?(a=function(a){var b={capabilities:h,capabilities2:l,capabilities3:n,capabilities4:o,capabilities5:p,threadType:q};return d("LSThreadBitOffset").has(a,b)},r=[h,l,n,o,p,q],b[0]=h,b[1]=l,b[2]=n,b[3]=o,b[4]=p,b[5]=q,b[6]=a,b[7]=r):(a=b[6],r=b[7]);var s=d("Int64Hooks").useCallbackInt64(a,r);b[8]!==f||b[9]!==s||b[10]!==g.cannotUnsendReason||b[11]!==g.threadStatus?(a=function(){var a;return{blurMediaEnabled:s(46),canUnsendMessage:g.cannotUnsendReason!=null?(i||(i=d("I64"))).equal(g.cannotUnsendReason,(j||(j=d("LSIntEnum"))).ofNumber(c("LSMessageThreadUnsendabilityStatus").CAN_UNSEND)):!0,communityMessagingChannelDescriptionCustomization:s(135),communityMessagingChannelInvite:s(120),disableLinks:s(45),editMessageEnabled:s(194),feedbackAndReportEnabled:s(17),hasLSThreadBitOffset:(a=s)!=null?a:f,isPaused:g.threadStatus!=null&&((i||(i=d("I64"))).equal(g.threadStatus,(i||(i=d("I64"))).of_int32(c("ThreadStatus").PAUSED))||(i||(i=d("I64"))).equal(g.threadStatus,(i||(i=d("I64"))).of_int32(c("ThreadStatus").PAUSED_AND_UPGRADED_TO_COMMUNITY))),localDeleteMessageEnabled:s(102),messageForwardEnabled:s(103),messageUnsendEnabled:s(122)&&g.cannotUnsendReason!=null?(i||(i=d("I64"))).equal(g.cannotUnsendReason,(j||(j=d("LSIntEnum"))).ofNumber(c("LSMessageThreadUnsendabilityStatus").CAN_UNSEND)):!1,modifyPinnedMessageV2Enabled:s(172),reactEnabled:s(18),reactionsV2WriteEnabled:s(169),replyEnabled:s(42),reportMessageToAdminEnabled:s(93),rtcVideoCallEnabled:s(24),rtcVoiceCallEnabled:s(25),seenCountV2Enabled:s(140),subThreadCreationEnabled:s(167)}},r=[f,s,g.threadStatus,g.cannotUnsendReason],b[8]=f,b[9]=s,b[10]=g.cannotUnsendReason,b[11]=g.threadStatus,b[12]=a,b[13]=r):(a=b[12],r=b[13]);a=d("Int64Hooks").useMemoInt64(a,r);b[14]!==e||b[15]!==a?(r=k.jsx(m.Provider,{value:a,children:e}),b[14]=e,b[15]=a,b[16]=r):r=b[16];return r}function b(){return l(m)}g.Provider=a;g.useMWPThreadCapabilitiesContext=b}),98);
__d("MWXMAAttachmentSharedStackConstants",[],(function(a,b,c,d,e,f){"use strict";a=213;b=160;f.STACK_ITEM_HEIGHT=a;f.STACK_ITEM_WIDTH=b}),66);
__d("RollCallContributionType",[],(function(a,b,c,d,e,f){a=Object.freeze({MEDIA:0,TEXT:1,LINK:2});f["default"]=a}),66);
__d("RollCallPromptType",[],(function(a,b,c,d,e,f){a=Object.freeze({MEDIA:0,TEXT:1,LINK:2});f["default"]=a}),66);
__d("MWPromptCreationUtils",["I64","LSAuthorityLevel","LSFactory","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure","LSMessagingThreadAttributionType","LSOptimisticContributeToTextPromptStoredProcedure","LSOptimisticCreateRollCallStoredProcedure","LSShape","LSVec","MWXMAAttachmentSharedStackConstants","MessagingAttachmentType","OfflineThreadingId","Promise","ReQL","RollCallContributionType","RollCallPromptType","XComposerPhotoUploader"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,e,g,k){return new(j||(j=b("Promise")))(function(b,j){a.runInTransaction(function(a){return c("LSOptimisticCreateRollCallStoredProcedure")(c("LSFactory")(a),{prompt:g,promptType:(h||(h=d("LSIntEnum"))).ofNumber(k),threadKey:e})},"readwrite",void 0,void 0,f.id+":49").then(function(e){var f=e[0],g=d("ReQL").fromTableAscending(a.tables.roll_calls).subscribe(function(a,e){if(e.operation==="add"||e.operation==="put"){a=e.value.offlineThreadingId;var h=(i||(i=d("I64"))).to_int32(e.value.authorityLevel)>=c("LSAuthorityLevel").AUTHORITATIVE;h&&a!=null&&(i||(i=d("I64"))).equal(a,f)&&(g(),b(e.value.rollCallId))}})})["catch"](function(a){j(a)})})}function k(a,b,e,g,h){return a.runInTransaction(function(a){return c("LSOptimisticContributeToTextPromptStoredProcedure")(c("LSFactory")(a),{productAttribution:String(c("LSMessagingThreadAttributionType").ROLLCALL),promptId:(i||(i=d("I64"))).to_string(g),senderId:b,text:(a=h)!=null?a:"",threadKey:e})},"readwrite",void 0,void 0,f.id+":91")}function l(a,b,e,g,j,k,l,m){var n,o=d("OfflineThreadingId").createOfflineThreadingID(),p=(n=m==null?void 0:m.startsWith("video/"))!=null?n:!1;return a.runInTransaction(function(a){return c("LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure")(c("LSFactory")(a),{extraSendMessageParams:d("LSShape").ofRecord({attachments:c("LSVec").ofArray([d("LSShape").ofRecord({attachment_fbid:o,attachment_index:(i||(i=d("I64"))).zero,attachment_type:(h||(h=d("LSIntEnum"))).ofNumber(p?c("MessagingAttachmentType").VIDEO:c("MessagingAttachmentType").IMAGE),has_media:!0,has_xma:!0,offline_attachment_id:o,playable_url:p?l:void 0,preview_height:i.of_float(d("MWXMAAttachmentSharedStackConstants").STACK_ITEM_HEIGHT),preview_url:p?void 0:l,preview_url_mime_type:p?void 0:m,preview_width:i.of_float(d("MWXMAAttachmentSharedStackConstants").STACK_ITEM_WIDTH)})]),contribution_type:h.ofNumber(c("RollCallContributionType").MEDIA),product_fbid:i.to_string(j),product_type:"roll_call",source:h.ofNumber(c("LSMessagingThreadAttributionType").ROLLCALL)}),senderId:b,text:k,threadKey:e,threadType:g})},"readwrite",void 0,void 0,f.id+":114").then(function(a){a=a[0];return a})}function e(a,d,e,f,g,h,i,m,n){switch(i){case c("RollCallPromptType").MEDIA:return l(a,d,e,f,g,h,m,n);case c("RollCallPromptType").TEXT:return k(a,d,e,g,h);default:return(j||(j=b("Promise"))).reject("Unsupported type")}}function m(a,b,e,f){var g=d("OfflineThreadingId").createOfflineThreadingID();a=a;a.uploadID=g;var h=new(c("XComposerPhotoUploader"))({onUploadFailure:function(a,b){},onUploadSuccess:function(a,b){},uploadEndpoint:"/messenger/upload_roll_call/"});h.getAsyncFileUploadRequest([a],[g],{data:{message_otid:e,roll_call_id:(i||(i=d("I64"))).to_string(b),thread_id:f}}).send()}g.createAuthoritiativeRollCall=a;g.createOptimisticRollCallMessage=e;g.startRollCallMediaUpload=m}),98);
__d("MWUnvaultedText",["cr:2472","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;var i=function(a,c){if(b("cr:2472")==null||c==null||c==="")return c;return a?b("cr:2472").unvaultOrThrow(c):b("cr:2472").unvault(c,!0)};function a(a,b){var c=d("react-compiler-runtime").c(3),e;c[0]!==a||c[1]!==b?(e=i(a,b),c[0]=a,c[1]=b,c[2]=e):e=c[2];a=e;b=a;return b}g.getMWUnvaultedText=i;g.useMWUnvaultedText=a}),98);
__d("MWV2MessageRowActionsContext.react",["emptyFunction","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;f=e.createContext;var j=e.useContext;e={current:c("emptyFunction")};var k={current:c("emptyFunction")},l={current:c("emptyFunction")};c={current:c("emptyFunction")};e={forwardMessage:e,openReactionsMenu:k,removeMessage:l,replyToMessage:c};var m=f(e);function a(){return j(m)}function b(a){var b=d("react-compiler-runtime").c(3),c=a.children;a=a.value;var e;b[0]!==c||b[1]!==a?(e=i.jsx(m.Provider,{value:a,children:c}),b[0]=c,b[1]=a,b[2]=e):e=b[2];return e}g.useMessageRowActionsContext=a;g.MWV2MessageRowActionsContextProvider=b}),98);
__d("useMWV2SubmitFeedbackAction",["LSFactory","LSIntEnum","LSSubmitGenAIBotFeedbackStoredProcedure","promiseDone","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(j||d("react")).useCallback;function a(a,b){var e=d("react-compiler-runtime").c(4),g=(h||(h=c("useReStore")))(),j;e[0]!==b||e[1]!==a||e[2]!==g?(j=function(e){c("promiseDone")(g.runInTransaction(function(b){return c("LSSubmitGenAIBotFeedbackStoredProcedure")(c("LSFactory")(b),{botFeedbackKind:(i||(i=d("LSIntEnum"))).ofNumber(e),botResponseId:a||"",feedbackKindType:i.ofNumber(e)})},"readwrite",void 0,void 0,f.id+":30"),b)},e[0]=b,e[1]=a,e[2]=g,e[3]=j):j=e[3];return j}g["default"]=a}),98);
__d("XFBBotFeedbackKind.facebook",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["BOT_FEEDBACK_NEGATIVE","BOT_FEEDBACK_NEGATIVE_ACCURATE","BOT_FEEDBACK_NEGATIVE_CLARITY","BOT_FEEDBACK_NEGATIVE_DOESNT_LOOK_LIKE_THE_PERSON","BOT_FEEDBACK_NEGATIVE_GENERIC","BOT_FEEDBACK_NEGATIVE_HALLUCINATION_INTERNAL_ONLY","BOT_FEEDBACK_NEGATIVE_HELPFUL","BOT_FEEDBACK_NEGATIVE_INTERESTING","BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT","BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING","BOT_FEEDBACK_NEGATIVE_OTHER","BOT_FEEDBACK_NEGATIVE_PERSONALIZED","BOT_FEEDBACK_NEGATIVE_REFUSED","BOT_FEEDBACK_NEGATIVE_SAFE","BOT_FEEDBACK_POSITIVE"]);c=a;f["default"]=c}),66);
__d("useUGCAgentsSubmitFeedbackMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9600826256672927"}),null);
__d("useUGCAgentsSubmitFeedbackMutation.graphql",["useUGCAgentsSubmitFeedbackMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],kind:"ScalarField",name:"xfb_gen_ai_persona_submit_feedback",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"useUGCAgentsSubmitFeedbackMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"useUGCAgentsSubmitFeedbackMutation",selections:c},params:{id:b("useUGCAgentsSubmitFeedbackMutation_facebookRelayOperation"),metadata:{},name:"useUGCAgentsSubmitFeedbackMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("useUGCAgentsSubmitFeedbackMutation",["fbt","BotFeedbackKind","FBLogger","RelayHooks","XFBBotFeedbackKind.facebook","cdsPushToast","objectEntries","react","react-compiler-runtime","useUGCAgentsSubmitFeedbackMutation.graphql"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;(j||d("react")).useCallback;var k=i!==void 0?i:i=b("useUGCAgentsSubmitFeedbackMutation.graphql"),l=function(a){var b=c("objectEntries")(c("BotFeedbackKind")).find(function(b){b[0];b=b[1];return b===a});if(b==null){c("FBLogger")("ugc_personas").mustfix("ugc_personas_could_not_convert_bot_feedback_kind_type");return}b=c("XFBBotFeedbackKind.facebook").cast(b[0]);if(b==null){c("FBLogger")("ugc_personas").mustfix("ugc_personas_could_not_cast_bot_feedback_kind_type");return}return b};function a(a,b){var e=d("react-compiler-runtime").c(4),f=d("RelayHooks").useMutation(k),g=f[0];e[0]!==b||e[1]!==g||e[2]!==a?(f=function(e){a==null?void 0:a.setIsFeedbackSubmitted(!0);e=l(e);if(!e)return;g({onCompleted:function(a){b()},onError:function(b){c("FBLogger")("ugc_personas").event("ugc_personas_submit_feedback_error").catching(b),d("cdsPushToast").pushToast({message:h._(/*BTDS*/"\u0110\u00e3 x\u1ea3y ra l\u1ed7i khi g\u1eedi \u00fd ki\u1ebfn \u0111\u00f3ng g\u00f3p c\u1ee7a b\u1ea1n. H\u00e3y th\u1eed l\u1ea1i sau.")}),a==null?void 0:a.setIsFeedbackSubmitted(!1)},variables:{input:{bot_feedback_kind:e,response_id:(e=a==null?void 0:a.responseId)!=null?e:"",surface:"AI_STUDIO_WEB"}}})},e[0]=b,e[1]=g,e[2]=a,e[3]=f):f=e[3];return f}g["default"]=a}),226);
__d("useGenAiNegativeFeedback",["fbt","JSResourceForInteraction","handleMWV2NoMessageOrTurn","react-compiler-runtime","useGenAiFeedbackSubmittedToast","useMWV2SubmitFeedbackAction","useMWXLazyDialog","useUGCAgentsSubmitFeedbackMutation"],(function(a,b,c,d,e,f,g,h){"use strict";var i=c("JSResourceForInteraction")("MWV2SubmitNegativeFeedbackDialog.react").__setRef("useGenAiNegativeFeedback");function a(a,b){var e=d("react-compiler-runtime").c(8),f=c("useGenAiFeedbackSubmittedToast")(a,b),g="";if(a){var j;g=(j=a.botResponseId)!=null?j:""}else b?g=b.responseId:c("handleMWV2NoMessageOrTurn")();j=c("useMWV2SubmitFeedbackAction")(g,f);g=c("useUGCAgentsSubmitFeedbackMutation")(b,f);var k;a?k=j:b?k=g:c("handleMWV2NoMessageOrTurn")();f=c("useMWXLazyDialog")(i);var l=f[0];e[0]===Symbol["for"]("react.memo_cache_sentinel")?(j=h._(/*BTDS*/"C\u00e2u tr\u1ea3 l\u1eddi t\u1ec7"),e[0]=j):j=e[0];g=j;e[1]!==a||e[2]!==k||e[3]!==l||e[4]!==b?(f=function(){return l({message:a,onSubmit:k,turn:b})},e[1]=a,e[2]=k,e[3]=l,e[4]=b,e[5]=f):f=e[5];j=f;e[6]!==j?(f=[j,g],e[6]=j,e[7]=f):f=e[7];return f}g["default"]=a}),226);
__d("MWV2NegativeFeedbackMenuItem.react",["MWXMenuItem.react","react","react-compiler-runtime","useGenAiNegativeFeedback"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3);a=a.message;a=c("useGenAiNegativeFeedback")(a);var e=a[0];a=a[1];var f;b[0]!==e||b[1]!==a?(f=i.jsx(c("MWXMenuItem.react"),{"aria-label":a,onClick:e,primaryText:a,testid:void 0}),b[0]=e,b[1]=a,b[2]=f):f=b[2];return f}g["default"]=a}),98);
__d("MWV2OneToOneThreadBlockedContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));c=h;e=c.createContext;var j=c.useContext,k=e(!1);function a(){return j(k)}function b(a){var b=d("react-compiler-runtime").c(3),c=a.blocked;a=a.children;var e=k.Provider;b[0]!==c||b[1]!==a?(e=i.jsx(e,{value:c,children:a}),b[0]=c,b[1]=a,b[2]=e):e=b[2];return e}g.useIsBlocked=a;g.MWV2OneToOneThreadBlockedContext=b}),98);
__d("MWV2OnlyGlobalRemoveMessageDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{}},root:c("JSResourceForInteraction")("MWV2OnlyGlobalRemoveMessageDialog.react").__setRef("MWV2OnlyGlobalRemoveMessageDialog.entrypoint")};g["default"]=a}),98);
__d("useGenAiPositiveFeedback",["fbt","BotFeedbackKind","MWMessageListLoggingContext","MessengerWebUXLogger","handleMWV2NoMessageOrTurn","react","useGenAiFeedbackSubmittedToast","useMWV2SubmitFeedbackAction","useUGCAgentsSubmitFeedbackMutation"],(function(a,b,c,d,e,f,g,h){"use strict";var i;b=i||d("react");var j=b.useCallback,k=b.useMemo;function a(a,b){var e="";if(a){var f;e=(f=a.botResponseId)!=null?f:""}else b?e=b.responseId:c("handleMWV2NoMessageOrTurn")();f=c("useGenAiFeedbackSubmittedToast")(a,b);var g=c("useMWV2SubmitFeedbackAction")(e,f);f=c("useUGCAgentsSubmitFeedbackMutation")(b,f);var i;a?i=g:b?i=f:c("handleMWV2NoMessageOrTurn")();var l=d("MWMessageListLoggingContext").useFlowInstanceId(),m=k(function(){return{extraData:{botResponseId:e},flowInstanceId:l.current}},[e,l]),n=c("MessengerWebUXLogger").useInteractionLogger();a=j(function(){i(c("BotFeedbackKind").BOT_FEEDBACK_POSITIVE),n==null?void 0:n(babelHelpers["extends"]({eventName:"submit_positive_feedback"},m))},[i,n,m]);g=h._(/*BTDS*/"C\u00e2u tr\u1ea3 l\u1eddi t\u1ed1t");return[a,g]}g["default"]=a}),226);
__d("MWV2PositiveFeedbackMenuItem.react",["MWXMenuItem.react","react","react-compiler-runtime","useGenAiPositiveFeedback"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3);a=a.message;a=c("useGenAiPositiveFeedback")(a);var e=a[0];a=a[1];var f;b[0]!==e||b[1]!==a?(f=i.jsx(c("MWXMenuItem.react"),{"aria-label":a,onClick:e,primaryText:a,testid:void 0}),b[0]=e,b[1]=a,b[2]=f):f=b[2];return f}g["default"]=a}),98);
__d("MWWorkForeignEntityTypeUtils",["I64","LSContactWorkForeignEntityType","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){if((h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactWorkForeignEntityType").NOT_FOREIGN))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN)))return"NOT_FOREIGN";else if((h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactWorkForeignEntityType").NOT_FOREIGN_LIMITED)))return"LIMITED";else return"FOREIGN"}g.getWorkForeignEntityType=a}),98);
__d("MWXMAUtils",["I64","LSXmaContentType"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Set(["xma_rtc_video","xma_rtc_missed_video","xma_rtc_missed_group_video","xma_rtc_ended_video","xma_rtc_new_video_default","xma_rtc_new_video_from_fb_share","xma_rtc_new_video_from_fb_video_share","xma_rtc_new_video_from_cowatch_share","xma_rtc_cowatch_start_video","xma_rtc_audio","xma_rtc_missed_audio","xma_rtc_missed_group_audio","xma_rtc_ended_audio","xma_rtc_new_audio_default","xma_rtc_new_audio_from_fb_share","xma_rtc_new_audio_from_fb_video_share","xma_rtc_new_audio_from_cowatch_share"]);function a(a){return i.has(a)}function b(a){var b;return(h||(h=d("I64"))).to_int32((b=a)!=null?b:(h||(h=d("I64"))).zero)===c("LSXmaContentType").MSG_LOCATION_SHARING||(h||(h=d("I64"))).to_int32((b=a)!=null?b:(h||(h=d("I64"))).zero)===c("LSXmaContentType").MSG_LOCATION_SHARING_V2}function e(a){var b;return(h||(h=d("I64"))).to_int32((b=a)!=null?b:(h||(h=d("I64"))).zero)===c("LSXmaContentType").MSG_CONTACT||(h||(h=d("I64"))).to_int32((b=a)!=null?b:(h||(h=d("I64"))).zero)===c("LSXmaContentType").MSG_AI_CONTACT}function f(a){return(h||(h=d("I64"))).to_int32((a=a)!=null?a:(h||(h=d("I64"))).zero)===c("LSXmaContentType").FB_POST_MENTION}function j(a){return(h||(h=d("I64"))).to_int32((a=a)!=null?a:(h||(h=d("I64"))).zero)===c("LSXmaContentType").MSG_MEMORIES_SHARE}g.isRTCXMA=a;g.isLocationShareXMA=b;g.isContactShareXMA=e;g.isXMAContentTypeFbPostMention=f;g.isXMAContentTypeMemoriesShare=j}),98);
__d("MWXScrollableArea.react",["MDSScrollableArea.react"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("MDSScrollableArea.react")}),98);
__d("MwbActorExperienceEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("3231");b=d("FalcoLoggerInternal").create("mwb_actor_experience_event",a);e=b;g["default"]=e}),98);
__d("SubthreadCreationStrings.react",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";a=h._(/*BTDS*/"T\u1ea1o \u0111o\u1ea1n chat ph\u1ee5");b=h._(/*BTDS*/"Xem \u0111o\u1ea1n chat ph\u1ee5");g.createSubthreadLabel=a;g.viewSubthreadLabel=b}),226);
__d("getMWOtherUserFBID",["I64","LSMessagingThreadTypeUtil","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a,b,c,e){var f=d("LSMessagingThreadTypeUtil").isOneToOne(e);if(!f)return null;f=d("LSMessagingThreadTypeUtil").isArmadilloSecure(e);if(!f)return c;e=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.participants,["contactId"]).getKeyRange(c).filter(function(a){a=a.contactId;return!(h||(h=d("I64"))).equal(a,b)}).take(1));return e==null?void 0:e.contactId}g.getMWOtherUserFBID=a}),98);
__d("isDeliveryStatusErrorState",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a.type==="Error"||a.type==="RetriableError"}f["default"]=a}),66);
__d("isReceiverFetchSticker",["I64","LSIntEnum","MessagingAttachmentType"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){var b=a.attachmentType;b=(h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER));a=a.receiverFetchId;return b&&a!=null}g["default"]=a}),98);
__d("messengerSecureMentionsLexicalCreateNodeStrategy",["MessengerLexicalActorNode","cometBaseMentionsLexicalCreateNodeStrategy","cometMentionsDataEntryText"],(function(a,b,c,d,e,f,g){"use strict";a=c("cometBaseMentionsLexicalCreateNodeStrategy")(function(a){return d("MessengerLexicalActorNode").$createMessengerLexicalActorNode({id:a.key,text:c("cometMentionsDataEntryText")(a)},"token")});b=a;g["default"]=b}),98);
__d("shouldHideMessagingActions",["I64","LSIntEnum","isDeliveryStatusErrorState"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){return(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(256))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(65536))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(131072))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(262144))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(524288))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(4294967296))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(1048576))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(2097152))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(4194304))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(8388608))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(16777216))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(67108864))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(1073741824))}function a(a,b){return c("isDeliveryStatusErrorState")(b)||j(a)?!0:!1}g["default"]=a}),98);
__d("shouldUseImageGrouping",["I64","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b){var c,e=a.displayedContentTypes,f=a.groupId;c=(h||(h=d("I64"))).to_int32((c=a.groupSize)!=null?c:(h||(h=d("I64"))).zero);return b&&(h||(h=d("I64"))).equal(e,(i||(i=d("LSIntEnum"))).ofNumber(2))&&f!=null&&a.groupIndex!=null&&a.groupSize!=null&&c>1}g["default"]=a}),98);
__d("threadCreationUtils",["I64","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b){return(h||(h=d("I64"))).equal(a.creationStatus,(i||(i=d("LSIntEnum"))).ofNumber(b))}g.creationStatusEquals=a}),98);
__d("useMAWBulkMediaDownloadStatus",["I64","LSAuthorityLevel","LSIntEnum","MAWBridgeSendAndReceive","MAWClientMediaStatusUtils","MAWDbMedia","MAWMediaDownloadStatus","MAWStateContext.react","MessagingAttachmentType","WAHashUtils","cr:17327","cr:17328","cr:17329","cr:17332","isReceiverFetchSticker","promiseDone","react","react-compiler-runtime","useAsyncReStore","useEmptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e=h||d("react");var k=e.useContext,l=e.useEffect;e.useMemo;var m=(f=b("cr:17327"))!=null?f:c("useEmptyFunction"),n=(e=b("cr:17332"))!=null?e:c("useEmptyFunction"),o=(f=b("cr:17328"))!=null?f:c("useEmptyFunction"),p=new Set();function a(a){var b=d("react-compiler-runtime").c(11),e=m(),f=n(),g=o(a);if(b[0]!==a||b[1]!==g||b[2]!==f||b[3]!==e){var h;b[5]!==g||b[6]!==f||b[7]!==e?(h=function(a,b){var h=a.attachment,k=a.mediaRenderQpl,l=a.mediaStatus;a=a.statusKey;var m=c("isReceiverFetchSticker")(h),n=(i||(i=d("I64"))).equal(h.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA));l=d("MAWClientMediaStatusUtils").getStatusDataFromLsdbOrContext({clientMediaStatus:g,mediaDownloadRetryCount:f,mediaDownloadStatusState:e,preloadedMediaStatus:l,statusKey:a});var o=l.hasStatus,p=l.retryCount;l=l.statusData;var q=h.transportKey==="FBBroker"||h.transportKey==="FBLegacyBroker",r=!q&&(i||(i=d("I64"))).to_int32(h.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC;l=r?{mainMediaStatus:c("MAWMediaDownloadStatus").SUCCESS,mainMediaStatusDetails:"optimistic_secure_upload",previewMediaStatus:c("MAWMediaDownloadStatus").SUCCESS,previewMediaStatusDetails:"optimistic_secure_upload"}:l;return{attachmentsData:{attachment:h,hasStatus:o,isOpenThreadAttachment:q,isOptimisticSecureUpload:r,isReceiverFetch:m,isXMA:n,retryCount:p,status:l,statusKey:a},index:b,mediaRenderQpl:k}},b[5]=g,b[6]=f,b[7]=e,b[8]=h):h=b[8];h=a.map(h);b[0]=a;b[1]=g;b[2]=f;b[3]=e;b[4]=h}else h=b[4];a=h;h=a;r(h);b[9]!==h?(a=h.map(q),b[9]=h,b[10]=a):a=b[10];h=a;return h}function q(a){a=a.attachmentsData;return a}function r(a){var e=d("react-compiler-runtime").c(5),f=c("useAsyncReStore")(),g=k(d("MAWStateContext.react").MAWDispatchContext),h,i;e[0]!==a||e[1]!==f||e[2]!==g?(h=function(){a.forEach(function(a){var e=a.attachmentsData,h=a.index,i=a.mediaRenderQpl;a=e.hasStatus;var j=e.isOpenThreadAttachment,k=e.isOptimisticSecureUpload,l=e.isReceiverFetch,m=e.isXMA,n=e.statusKey;if(m||k||j||l||n==null||a||p.has(n))return;p.add(n);var o=isNaN(n);i==null?void 0:i.addPoint("fetch-initial-download-status-"+h+"-start",{string:{fetch_by:o?"plaintext_hash":"media_id"}});e=o?d("MAWBridgeSendAndReceive").sendAndReceive("backend","getMediaDownloadStatusByPlaintextHash",{plaintextHash:d("WAHashUtils").stringToPlaintextHash(n),qplInstanceKey:i==null?void 0:i.getInstanceKey()}):d("MAWBridgeSendAndReceive").sendAndReceive("backend","getMediaDownloadStatusByMediaId",{mediaId:d("MAWDbMedia").convertNumberToMediaId(parseInt(n,10)),qplInstanceKey:i==null?void 0:i.getInstanceKey()});c("promiseDone")(e.then(function(a){i==null?void 0:i.addPoint("fetch-initial-download-status-"+h+"-end",{bool:{has_result:a!=null},string:{fetch_by:o?"plaintext_hash":"media_id",main_media_status:d("MAWClientMediaStatusUtils").mediaDownloadStatusEnumToString(a==null?void 0:a.mainMediaStatus),preview_media_status:d("MAWClientMediaStatusUtils").mediaDownloadStatusEnumToString(a==null?void 0:a.previewMediaStatus)}}),a!=null&&(b("cr:17329")==null?g({tag:"SetMediaDownloadStatusState",value:{key:o?d("WAHashUtils").stringToPlaintextHash(n):d("MAWDbMedia").convertNumberToMediaId(parseInt(n,10)),newMediaDownloadState:a}}):b("cr:17329").call(f,n,a))}))})},i=[g,a,f],e[0]=a,e[1]=f,e[2]=g,e[3]=h,e[4]=i):(h=e[3],i=e[4]);l(h,i)}g["default"]=a}),98);
__d("useMAWBulkMediaDownloadStatusUIStateNonDebounced",["I64","LSIntEnum","LSMediaUrlUtils","MAWLoggerUtils","MAWMediaDownloadStatus","MessagingAttachmentType","WATagsLogger","react","react-compiler-runtime","useMAWBulkMediaDownloadStatus"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["useMAWMediaDownloadStatusUIState: unexpected download status"]);k=function(){return a};return a}(h||d("react")).useMemo;var l=d("WATagsLogger").TAGS([d("MAWLoggerUtils").Tag.MediaDownload]),m=5;function a(a){var b=d("react-compiler-runtime").c(5),e=c("useMAWBulkMediaDownloadStatus")(a);if(b[0]!==e||b[1]!==a){var f;b[3]!==a?(f=function(b,e){var f,g=b.retryCount;b=b.status;f=(f=b)!=null?f:{};var h=f.mainMediaStatus;f=f.previewMediaStatus;e=a[e].attachment;if(e.receiverFetchId!=null&&d("LSMediaUrlUtils").hasValidReceiverFetchPreviewUrl(e.previewUrl,e.previewUrlExpirationTimestampMs))return"downloaded";g=g>=m;var i=b==null||h===c("MAWMediaDownloadStatus").DOWNLOADING||h===c("MAWMediaDownloadStatus").MISSING_FILE||h===c("MAWMediaDownloadStatus").RETRYING||h===c("MAWMediaDownloadStatus").AUTOMATICALLY_RETRYABLE_TIMEOUT_FAILURE,j=h===c("MAWMediaDownloadStatus").SUCCESS,o=h===c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,p=o&&g,q=h===c("MAWMediaDownloadStatus").NOT_MANUAL_RETRYABLE_FAILURE;b=b==null||h===c("MAWMediaDownloadStatus").RETRYING||f===c("MAWMediaDownloadStatus").DOWNLOADING||f===c("MAWMediaDownloadStatus").MISSING_FILE||f===void 0&&i;h=f===c("MAWMediaDownloadStatus").SUCCESS;var r=f===c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE||f===void 0&&o;g=r&&g;f=f===c("MAWMediaDownloadStatus").NOT_MANUAL_RETRYABLE_FAILURE||f===void 0&&q;e=n(e);if(e&&!b){if(h||j){if(q||p)return"non_retryable_error_with_preview";else if(o)return"retryable_error_with_preview";return"downloaded"}else if(f||g)return"non_retryable_error";else if(r)return"retryable_error"}else if(j)return"downloaded";else if(q||p)return"non_retryable_error";else if(o)return"retryable_error";else if(i)return"loading";l.WARN(k());return"loading"},b[3]=a,b[4]=f):f=b[4];f=e.map(f);b[0]=e;b[1]=a;b[2]=f}else f=b[2];e=f;return e}function n(a){if(a==null)return!1;a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}g["default"]=a}),98);
__d("useMAWBulkMediaDownloadStatusUIStateDebounced",["clearTimeout","justknobx","react","react-compiler-runtime","setTimeout","useMAWBulkMediaDownloadStatusUIStateNonDebounced"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useEffect,j=b.useRef,k=b.useState;function a(a){var b=d("react-compiler-runtime").c(4),e=c("useMAWBulkMediaDownloadStatusUIStateNonDebounced")(a);a=m(e);var f=a[0],g=a[1],h;b[0]!==e||b[1]!==g?(a=function(){g(e,!e.some(l))},h=[e,g],b[0]=e,b[1]=g,b[2]=a,b[3]=h):(a=b[2],h=b[3]);i(a,h);return f}function l(a){return a==="loading"||a==="downloaded"}function m(a){var b=d("react-compiler-runtime").c(5),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=c("justknobx")._("3145"),b[0]=e):e=b[0];var f=e;e=k(a);a=e[0];var g=e[1],h=j(null);b[1]===Symbol["for"]("react.memo_cache_sentinel")?(e=function(){c("clearTimeout")(h.current),h.current=null},b[1]=e):e=b[1];var i=e;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(e=function(a,b){i();if(!b){g(a);return}h.current=c("setTimeout")(function(){g(a)},f)},b[2]=e):e=b[2];e=e;b[3]!==a?(e=[a,e,i],b[3]=a,b[4]=e):e=b[4];return e}g["default"]=a}),98);
__d("useMAWBulkMediaDownloadStatusUIState",["useMAWBulkMediaDownloadStatusUIStateDebounced"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("useMAWBulkMediaDownloadStatusUIStateDebounced")(a)}g["default"]=a}),98);
__d("useMAWBulkMediaUIState",["react","react-compiler-runtime","useMAWBulkMediaDownloadStatusUIState","useMAWBulkMediaValidationResult"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;function a(a){var b=d("react-compiler-runtime").c(5),e=c("useMAWBulkMediaDownloadStatusUIState")(a);a=c("useMAWBulkMediaValidationResult")(a);if(b[0]!==a){var f;f=(f=a)!=null?f:[];b[0]=a;b[1]=f}else f=b[1];b[2]!==e||b[3]!==f?(a={buldValidationResult:f,bulkDownloadStatus:e},b[2]=e,b[3]=f,b[4]=a):a=b[4];e=a;f=e;return f}g["default"]=a}),98);
__d("useGetMediaGroupInformation",["I64","MAWMediaDownloadStatusUIStateType","ReQL","ReQLSuspense","gkx","qex","react","react-compiler-runtime","shouldUseImageGrouping","useMAWBulkMediaUIState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(j||d("react")).useMemo;function a(a,b,e){var g,j,m,n=(h||(h=c("useReStore")))(),o=a.groupId,p=a.threadKey;g=(i||(i=d("I64"))).to_int32((g=a.groupIndex)!=null?g:(i||(i=d("I64"))).zero);j=i.to_int32((j=a.groupSize)!=null?j:(i||(i=d("I64"))).zero);var q=c("shouldUseImageGrouping")(a,b);a=q?4:0;q&&j<4&&(a=j);var r=d("ReQLSuspense").useArray(function(){return q&&o!=null?d("ReQL").fromTableDescending(n.tables.messages.index("messageGroupId")).getKeyRange(o).map(function(a){var b;b=(b=d("ReQLSuspense").first(d("ReQL").fromTableDescending(n.tables.attachments).getKeyRange(p,a.messageId),f.id+":107"))!=null?b:null;var e=b!=null&&c("gkx")("13026")?d("ReQLSuspense").first(d("ReQL").fromTableDescending(n.tables.client_media_status).getKeyRange(b.attachmentFbid),f.id+":115"):void 0;return{attachment:b,mediaStatus:e,message:a}}):d("ReQL").empty()},[n,o,p,q],f.id+":99"),s=k(function(){return r.sort(function(a,b){return(i||(i=d("I64"))).to_int32((a=a.message.groupIndex)!=null?a:(i||(i=d("I64"))).zero)-i.to_int32((a=b.message.groupIndex)!=null?a:(i||(i=d("I64"))).zero)})},[r]),t=q&&s.length>=1?(b=s[0])==null?void 0:b.message:null;b=d("ReQLSuspense").useFirst(function(){if(!q||t==null)return d("ReQL").empty();var a;c("qex")._("18")?a=d("ReQL").fromTableAscending(n.tables.messages.index("messageDisplayOrderOfflineThreadingId")).getKeyRange(t.threadKey).bounds({gte:d("ReQL").key(t.primarySortKey,t.offlineThreadingId)}):a=d("ReQL").fromTableAscending(n.tables.messages.index("messageDisplayOrder")).getKeyRange(t.threadKey).bounds({gte:d("ReQL").key(t.primarySortKey)});return a.filter(function(a){return a.groupId!==t.groupId}).filter(function(a){return!a.isAdminMessage})},[n,t,q],f.id+":143");e=l(s,q,e);var u=e.attachmentsToRetryDownload,v=e.mediaDownloadErrorsCount;e=e.mediaDownloadStatuses;if(q!==!0)return null;m=s.length>=1?(i||(i=d("I64"))).to_int32((m=(m=s[0])==null?void 0:(m=m.message)==null?void 0:m.groupIndex)!=null?m:(i||(i=d("I64"))).zero):0;m=g===m;var w=new Array(a),x=function(a){var b=s.findIndex(function(b){return b.message.groupIndex!=null&&(i||(i=d("I64"))).to_int32(b.message.groupIndex)===a});b===-1?w[a]={attachment:null,message:null}:w[a]={attachment:s[b].attachment,message:s[b].message}};for(var y=0;y<a&&y<a;++y)x(y);return{attachmentsToRetryDownload:u,groupId:o,groupIndex:g,groupSize:j,groupsLastMessage:s!=null&&s.length>0?s[s.length-1].message:null,groupsNextMessage:(x=b)!=null?x:null,hasAllMessagesSent:s.every(function(a){return(i||(i=d("I64"))).equal(a.message.sendStatusV2,i.of_int32(2))}),hasMissingMedia:s.some(function(a){return a.attachment==null}),hasMissingMessages:s.length!==j,isFirstMediaMessageInGroup:m,isMediaGroupLastMessage:b==null,mediaDownloadErrorsCount:v,mediaDownloadStatuses:e,messagesAndAttachments:s,messagesAndAttachmentsShownInGroup:w,tileSize:a}}function l(a,b,e){var f=d("react-compiler-runtime").c(19);bb0:{if(!b){f[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=[],f[0]=b):b=f[0];b=b;break bb0}if(f[1]!==e||f[2]!==a){var g;f[4]!==e?(g=function(a){var b=a.attachment;a=a.mediaStatus;return b==null?null:{attachment:b,mediaRenderQpl:e,mediaStatus:a,statusKey:b.attachmentFbid}},f[4]=e,f[5]=g):g=f[5];g=a.map(g).filter(Boolean);f[1]=e;f[2]=a;f[3]=g}else g=f[3];b=g}a=b;g=c("useMAWBulkMediaUIState")(a);b=g.bulkDownloadStatus;f[6]!==b?(g=b!=null?b:[],f[6]=b,f[7]=g):g=f[7];b=g;var h=b;f[8]!==h?(g=h.filter(n),f[8]=h,f[9]=g):g=f[9];b=g;g=b;if(f[10]!==a||f[11]!==h){f[13]!==h?(b=function(a,b){return d("MAWMediaDownloadStatusUIStateType").isRetryableErrorState(h[b])},f[13]=h,f[14]=b):b=f[14];b=a.filter(b).map(m);f[10]=a;f[11]=h;f[12]=b}else b=f[12];a=b;b=a;a=g.length;f[15]!==b||f[16]!==a||f[17]!==h?(g={attachmentsToRetryDownload:b,mediaDownloadErrorsCount:a,mediaDownloadStatuses:h},f[15]=b,f[16]=a,f[17]=h,f[18]=g):g=f[18];return g}function m(a){var b=a.attachment;a=a.mediaStatus;return{attachment:b,mediaStatus:a}}function n(a){return d("MAWMediaDownloadStatusUIStateType").isErrorState(a)}g["default"]=a}),98);
__d("useMWV2LocalRemoveMessage",["I64","LSDict","LSIntEnum","LSTaskType","LSTasks","MWV2LogMessageClick","MessengerWebUXLogger","QPLUserFlow","Random","WebUserFlowLoggingDataContextProvider.react","promiseDone","qpl","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");b.useCallback;var l=b.useContext;function a(){var a=d("react-compiler-runtime").c(4),b=(h||(h=c("useReStore")))(),e=l(d("WebUserFlowLoggingDataContextProvider.react").WebUserFlowLoggingDataContext),g=e.loggingDataRef,k=c("MessengerWebUXLogger").useInteractionLogger();a[0]!==b||a[1]!==k||a[2]!==g?(e=function(a){var e=c("qpl")._(25308285,"2002"),h=Date.now()+(Math.round(d("Random").random()*1e4)+1e4);c("QPLUserFlow").start(e,{annotations:{string:{isEphemeralMessage:a.ephemeralDurationInSec!=null||a.ephemeralExpirationTs!=null?"true":"false",type:"openDeleteMessageForMe"}},instanceKey:h});d("MWV2LogMessageClick").log(b,a,46);c("promiseDone")(b.runInTransaction(function(b){return d("LSTasks").enqueue(b,c("LSTaskType").DeleteMessage,(i||(i=d("I64"))).to_string((j||(j=d("LSIntEnum"))).ofNumber(155)),new(c("LSDict"))([["message_id",a.messageId],["thread_key",a.threadKey]])).then(function(){k==null?void 0:k(babelHelpers["extends"]({},g.current,{eventName:"message_remove_success",eventType:"backend"})),c("QPLUserFlow").endSuccess(e,{instanceKey:h})})["catch"](function(a){return k==null?void 0:k(babelHelpers["extends"]({},g.current,{eventName:"message_remove_failure",eventType:"backend",extraData:babelHelpers["extends"]({},g.current.extraData,{error:a.toString()})}))})},"readwrite",void 0,void 0,f.id+":57"))},a[0]=b,a[1]=k,a[2]=g,a[3]=e):e=a[3];return e}g["default"]=a}),98);
__d("useHandleRemoveLocalMessage",["DeletionType.react","MessengerWebUXLogger","cr:9775","react","react-compiler-runtime","useGetMediaGroupInformation","useIsSecureMessage","useMWV2LocalRemoveMessage","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useCallback;function a(){return j}function j(a,b){}var k=b("cr:9775")||a;function e(a,b,e){var f=d("react-compiler-runtime").c(10),g=(h||(h=c("useReStore")))(),i=c("MessengerWebUXLogger").useInteractionLogger(),j;f[0]!==a?(j={fallbackThreadType:a},f[0]=a,f[1]=j):j=f[1];var l=c("useIsSecureMessage")(g,b,j),m=k(),n=c("useMWV2LocalRemoveMessage")(),o=c("useGetMediaGroupInformation")(b,l);f[2]!==l||f[3]!==n||f[4]!==i||f[5]!==o||f[6]!==b||f[7]!==e||f[8]!==m?(a=function(a){i==null?void 0:i(babelHelpers["extends"]({},a,{eventName:"message_remove_confirm"})),l?m(b,o):n(b),e&&e(c("DeletionType.react").Local)},f[2]=l,f[3]=n,f[4]=i,f[5]=o,f[6]=b,f[7]=e,f[8]=m,f[9]=a):a=f[9];return a}g["default"]=e}),98);
__d("useLogMAWEditMessage",["I64","LSMessagingThreadTypeUtil","LsFalcoEventEntryPoint","LsMessageActionFalcoEvent","MessengerWebUXLogger","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("MessengerWebUXLogger").useInteractionLogger(),e;a[0]!==b?(e=function(a,e,f,g,h){d("LSMessagingThreadTypeUtil").isArmadilloSecure(a)?b==null?void 0:b({eventName:j(h)}):c("LsMessageActionFalcoEvent").log(function(){return{action:{type:k(h)},error:{message:void 0},extra:{is_community_chats:d("LSMessagingThreadTypeUtil").isPublicCMThread(a)?"1":"0"},message:{attachment_type:"",entry_point:d("LsFalcoEventEntryPoint").messageActions,id:f,recipient_id:(i||(i=d("I64"))).to_string(g)},thread:{group_size:i.to_string(i.zero),id:e!=null?(i||(i=d("I64"))).to_string(e):void 0,type:d("LSMessagingThreadTypeUtil").isGroup(a)?2:1}}})},a[0]=b,a[1]=e):e=a[1];return e}function j(a){switch(a){case"EDIT_MESSAGE":return"edit_message";case"EDIT_MESSAGE_CANCEL":return"edit_message_cancel";case"EDIT_MESSAGE_TAP":return"edit_message_tap"}}function k(a){switch(a){case"EDIT_MESSAGE":return 90;case"EDIT_MESSAGE_CANCEL":return 92;case"EDIT_MESSAGE_TAP":return 89}}g["default"]=a}),98);
__d("useOpenSubthreadView",["GroupsCometChatsEngagementLogger","I64","MWCMSubthreadChatTabContext.react","MWCMSubthreadsInboxFocusContext.react","MWInboxInfoPanelContext.react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=d("react-compiler-runtime").c(5),b=d("MWInboxInfoPanelContext.react").useMWInboxInfoPanelContext(),c=b.setCurrentSubthreadView,e=b.setSubthreadKey;b=(b=d("MWCMSubthreadChatTabContext.react").useSubthreadChatTabContext())!=null?b:{};var f=b.pushSubthreadViewPage;b=d("MWCMSubthreadsInboxFocusContext.react").useIsSubthreadFocusedContext();var g=b.setIsSubthreadFocused;a[0]!==f||a[1]!==c||a[2]!==g||a[3]!==e?(b=function(a,b){b=b===void 0?!1:b;d("GroupsCometChatsEngagementLogger").log({action:"tap",client_extras:{is_chat_tab:f!=null?"1":"0",is_subthread:"1"},event:"thread_open",parent_surface:"thread_view",source:b===!0?"subthread_creation":"subthread_xma",surface:"subthread_view",thread_id:(h||(h=d("I64"))).to_string(a)});f!=null?f==null?void 0:f(a):(c("subthreadView"),e(a),g(!0))},a[0]=f,a[1]=c,a[2]=g,a[3]=e,a[4]=b):b=a[4];return b}g["default"]=a}),98);
__d("useMWCMCreateSubthread",["fbt","FBLogger","Int64Hooks","LSCommunityThreadCreationStatus","LSCreateCommunitySubThreadStoredProcedure","LSFactory","LSLocalCreateOptimisticCommunityChatSubThreadStoredProcedure","LSPlatformWaitForTaskCompletion","LSThreadBitOffset","MWLSThread","ReQL","ReQLSuspense","emptyFunction","promiseDone","react","threadCreationUtils","useCommunityFolder","useMWXPushErrorToast","useOpenSubthreadView","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;b=j||d("react");var k=b.useEffect,l=b.useRef,m=b.useState;function a(a){var b=(i||(i=c("useReStore")))(),e=d("MWLSThread").useThreadExn(a.threadKey),g=c("useCommunityFolder")(e),j=l(c("emptyFunction")),n=c("useMWXPushErrorToast")(),o=m(!1),p=o[0],q=o[1],r=c("useOpenSubthreadView")(),s=d("LSThreadBitOffset").has(206,e);k(function(){return function(){j==null?void 0:j.current()}},[]);o=d("Int64Hooks").useCallbackInt64(async function(){if(g==null)return;var d=await b.runInTransaction(function(b){return c("LSLocalCreateOptimisticCommunityChatSubThreadStoredProcedure")(c("LSFactory")(b),{communityId:g.folderId,parentMessageId:a.messageId,parentThreadId:a.threadKey})},"readwrite",void 0,void 0,f.id+":65");d=d[0];r(d,!0)},[b,g,a.messageId,a.threadKey,r]);e=d("Int64Hooks").useCallbackInt64(function(){if(s)return;var e=function(a){a=a[0];if(a==null)return i();var e=d("ReQL").fromTableAscending(b.tables.thread_creation_status).getKeyRange(a);a=d("ReQLSuspense").first(e,f.id+":97");a==null||d("threadCreationUtils").creationStatusEquals(a,c("LSCommunityThreadCreationStatus").PENDING)?g():h(a);function g(){j.current=e.subscribe(function(a,b){if(b.operation==="delete")return;a=b.value;if(d("threadCreationUtils").creationStatusEquals(a,c("LSCommunityThreadCreationStatus").PENDING))return;j.current();h(a)})}function h(a){q(!1);try{var b=a.threadId;if(d("threadCreationUtils").creationStatusEquals(a,c("LSCommunityThreadCreationStatus").FAILURE)||b==null)throw c("FBLogger")("cm_web").warn("sidechat creation failed");r(b,!0)}catch(a){i()}}},i=function(){q(!1),n({title:h._(/*BTDS*/"Kh\u00f4ng t\u1ea1o \u0111\u01b0\u1ee3c \u0111o\u1ea1n chat ph\u1ee5")})};if(g==null)return;q(!0);c("promiseDone")(c("LSPlatformWaitForTaskCompletion")(b,function(b){return c("LSCreateCommunitySubThreadStoredProcedure")(c("LSFactory")(b),{communityId:g.folderId,parentMessageId:a.messageId,parentThreadId:a.threadKey})},"createSocialChannel"),function(a){return e(a)},i)},[b,g,s,a.messageId,a.threadKey,r,n]);return[s?o:e,p]}g.default=a}),226);
__d("useMWChatForward",["MWChatForwardDialog.entrypoint","MessengerWebUXLogger","react","react-compiler-runtime","useMWXEntryPointDialog"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useRef;function a(a){var b=d("react-compiler-runtime").c(11),e=a.dropToggle,f=a.forwardDialogType,g=a.messageID,h=a.onClose,j=a.onSend;a=i(null);var k;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(k={},b[0]=k):k=b[0];k=c("useMWXEntryPointDialog")(c("MWChatForwardDialog.entrypoint"),k);var l=k[0],m=c("MessengerWebUXLogger").useInteractionLogger();b[1]!==e||b[2]!==f||b[3]!==m||b[4]!==g||b[5]!==h||b[6]!==j||b[7]!==l?(k=function(){l({dropToggle:e,forwardDialogType:f,messageID:g,onSend:j},h,m==null?void 0:m("forward_message"))},b[1]=e,b[2]=f,b[3]=m,b[4]=g,b[5]=h,b[6]=j,b[7]=l,b[8]=k):k=b[8];k=k;b[9]!==k?(a={onClick:k,triggerRef:a},b[9]=k,b[10]=a):a=b[10];return a}g["default"]=a}),98);
__d("useMWChatMentionsDataSourceResolverConfig",["I64","LSMessagingThreadTypeUtil","LSThreadBitOffset","MWChatComposerMentionsTypeaheadDataSource","MWLSThread","createCometAtSignComposerMentionsMatchStrategyWithInstagramHandleSupport","react","useCometMentionsDataSourceResolverConfig"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useMemo;function a(a){var b=a.isAiBotMentionsEnabled,e=a.participants,f=a.threadFBID,g=a.triggerParticipantsSearch;a=d("MWLSThread").useThreadExn((i||(i=d("I64"))).of_string(f));var h=a.threadType,k=d("LSMessagingThreadTypeUtil").isGroup(a.threadType)&&d("LSThreadBitOffset").has(43,a);a=j(function(){return[{dataSource:new(c("MWChatComposerMentionsTypeaheadDataSource"))(e,f,g,b,k,h),matchStrategy:c("createCometAtSignComposerMentionsMatchStrategyWithInstagramHandleSupport")({minMatchLength:0})}]},[k,b,e,f,g,h]);return c("useCometMentionsDataSourceResolverConfig")(a,!0)}g["default"]=a}),98);
__d("useMWChatReactionsActionContainerProps.react",["I64","LSMessagingThreadTypeUtil","MAWPSendOrRemoveReaction.react","MWCMThreadTypes.react","MWChatMessageId","react","useIsReactionsV2Enabled"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");var j=b.useCallback,k=b.useMemo;function a(a,b,c,e,f,g){var h=d("LSMessagingThreadTypeUtil").isArmadilloSecure(c),l=(i||(i=d("I64"))).to_string(a.threadKey),m=i.to_string(a.timestampMs),n=k(function(){return d("MWChatMessageId").makeSent(l,a.messageId,m)},[l,a.messageId,m]),o=d("MAWPSendOrRemoveReaction.react").useSendOrRemoveReaction(a,h,"reaction_tray"),p=d("MWCMThreadTypes.react").isBroadcastThread(c);c=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(c);var q=d("useIsReactionsV2Enabled").useIsReactionsV2Enabled(a.threadKey),r=j(function(b,c){e&&e();return o(a.messageId,c?void 0:b,c?"remove_reaction":"reaction")},[e,o,a.messageId]),s=q&&p;return{closeActionsMenu:b,disableCustomReactions:s,hasReactionsV2:q,isBroadcastChannel:c,isBroadcastThread:p,isSecure:h,messageID:n,onVisibilityChange:f,reactionsPopoverResource:g,sendReaction:r}}g["default"]=a}),98);
__d("useMWFalcoFeatureEventLogger",["MWFalcoFeatureEventLogger","MWPActor.react","getMWOtherUserFBID","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useCallback;function a(a,b){var e=d("react-compiler-runtime").c(5),f=(h||(h=c("useReStore")))(),g=d("MWPActor.react").useActor(),i;e[0]!==g||e[1]!==f||e[2]!==a||e[3]!==b?(i=function(c,e){d("getMWOtherUserFBID").getMWOtherUserFBID(f,g,a,b).then(function(f){d("MWFalcoFeatureEventLogger").logEvent(c,e,f,a,b)})["catch"](j)},e[0]=g,e[1]=f,e[2]=a,e[3]=b,e[4]=i):i=e[4];return i}function j(){}g["default"]=a}),98);
__d("useMWIsContactRestricted",["LSContactBitOffset","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("react-compiler-runtime").c(2),c;b[0]!==a?(c=a!=null&&d("LSContactBitOffset").has(66,a),b[0]=a,b[1]=c):c=b[1];a=c;return a}g["default"]=a}),98);
__d("useMWHasForwardAction",["I64","LSAuthorityLevel","LSBitFlag","LSContactBitOffset","LSIntEnum","LSMessagingThreadTypeUtil","MAWMsg","MWCMIsSubthreadContext.react","MWGenAIUtils","MWMessageDeliveryStatus","MWPThreadCapabilitiesContext","MWV2OneToOneThreadBlockedContext.react","MWXMAUtils","MessagingAttachmentType","gkx","isFeatureLimitEnabled","isMWBumpMessage","mwCMIsAnyCMThread","react-compiler-runtime","shouldHideMessagingActions","useIsReadOnlyFeatureLimitedWithThreadType","useMAWMediaStatusUIState","useMWFamilyCenterContext","useMWGetOtherUserContact","useMWIsContactRestricted"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,e,f,g,j){var k=d("react-compiler-runtime").c(75);f=f===void 0?!1:f;j=j===void 0?!1:j;var l=d("MWCMIsSubthreadContext.react").useIsSubthreadContext();l=l.isSubthread;var m;k[0]!==l||k[1]!==a?(m=l&&!d("LSMessagingThreadTypeUtil").isCMSubthread(a),k[0]=l,k[1]=a,k[2]=m):m=k[2];l=m;k[3]!==a?(m=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(a),k[3]=a,k[4]=m):m=k[4];m=m;var n;k[5]!==b.threadKey?(n=d("MWGenAIUtils").isMetaAIThread(b.threadKey),k[5]=b.threadKey,k[6]=n):n=k[6];n=n;var o;k[7]!==a?(o=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a),k[7]=a,k[8]=o):o=k[8];o=o;var p=b.ephemeralDurationInSec,q;k[9]!==p?(q=p!=null?(h||(h=d("I64"))).gt(p,(h||(h=d("I64"))).zero):!1,k[9]=p,k[10]=q):q=k[10];p=q;q=c("useIsReadOnlyFeatureLimitedWithThreadType")(a)&&(!o||c("isFeatureLimitEnabled")());var r;k[11]!==b.displayedContentTypes?(r=(h||(h=d("I64"))).equal(b.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(4096)),k[11]=b.displayedContentTypes,k[12]=r):r=k[12];r=r;var s;k[13]!==b.displayedContentTypes?(s=(h||(h=d("I64"))).equal(b.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(134217728)),k[13]=b.displayedContentTypes,k[14]=s):s=k[14];s=s;var t=d("MWV2OneToOneThreadBlockedContext.react").useIsBlocked(),u;k[15]!==b.displayedContentTypes||k[16]!==b.sendStatusV2?(u=c("shouldHideMessagingActions")(b.displayedContentTypes,d("MWMessageDeliveryStatus").getFromSendStatus(b.sendStatusV2)),k[15]=b.displayedContentTypes,k[16]=b.sendStatusV2,k[17]=u):u=k[17];u=u;var v=c("useMWGetOtherUserContact")(b.threadKey,a,d("LSContactBitOffset").contactCapabilityFields);v=c("useMWIsContactRestricted")(v);var w;k[18]!==b.sendStatusV2||k[19]!==a?(w=c("mwCMIsAnyCMThread")(a)&&(h||(h=d("I64"))).equal(b.sendStatusV2,(i||(i=d("LSIntEnum"))).ofNumber(4)),k[18]=b.sendStatusV2,k[19]=a,k[20]=w):w=k[20];a=w;k[21]!==b.displayedContentTypes?(w=d("LSBitFlag").has((i||(i=d("LSIntEnum"))).ofNumber(2),b.displayedContentTypes),k[21]=b.displayedContentTypes,k[22]=w):w=k[22];w=w;var x;k[23]!==m||k[24]!==b.displayedContentTypes?(x=m&&d("LSBitFlag").has((i||(i=d("LSIntEnum"))).ofNumber(1024),b.displayedContentTypes),k[23]=m,k[24]=b.displayedContentTypes,k[25]=x):x=k[25];x=x;var y;k[26]!==b.replyType?(y=c("isMWBumpMessage")(b.replyType),k[26]=b.replyType,k[27]=y):y=k[27];y=y;var z=d("MWPThreadCapabilitiesContext").useMWPThreadCapabilitiesContext();z=z.messageForwardEnabled;var A=d("useMWFamilyCenterContext").useMWFamilyCenterEnforcementsContext();A=A.familyCenterData;var B;k[28]!==e?(B=(e==null?void 0:e.attachmentType)!=null&&((h||(h=d("I64"))).equal(e.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))||(h||(h=d("I64"))).equal(e.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))),k[28]=e,k[29]=B):B=k[29];B=B;var C;k[30]!==e||k[31]!==o?(C=o&&(e==null?void 0:e.xmaContentType)!=null&&d("MWXMAUtils").isLocationShareXMA(e.xmaContentType),k[30]=e,k[31]=o,k[32]=C):C=k[32];C=C;var D;k[33]!==e||k[34]!==o?(D=o&&(e==null?void 0:e.xmaContentType)!=null&&d("MWXMAUtils").isContactShareXMA(e.xmaContentType),k[33]=e,k[34]=o,k[35]=D):D=k[35];D=D;var E;k[36]!==e||k[37]!==o?(E=o&&(e==null?void 0:e.xmaContentType)!=null&&d("MWXMAUtils").isXMAContentTypeFbPostMention(e.xmaContentType),k[36]=e,k[37]=o,k[38]=E):E=k[38];E=E;var F;k[39]!==e||k[40]!==o?(F=o&&(e==null?void 0:e.xmaContentType)!=null&&d("MWXMAUtils").isXMAContentTypeMemoriesShare(e.xmaContentType),k[39]=e,k[40]=o,k[41]=F):F=k[41];F=F;var G=c("useMAWMediaStatusUIState")(e);G=G.downloadStatus;var H;k[42]!==e||k[43]!==o||k[44]!==G?(H=e!=null&&o&&!(h||(h=d("I64"))).equal(e.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))&&G!=="downloaded",k[42]=e,k[43]=o,k[44]=G,k[45]=H):H=k[45];G=H;k[46]!==e||k[47]!==A||k[48]!==a||k[49]!==t||k[50]!==m||k[51]!==y||k[52]!==p||k[53]!==n||k[54]!==G||k[55]!==q||k[56]!==s||k[57]!==v||k[58]!==D||k[59]!==E||k[60]!==C||k[61]!==F||k[62]!==o||k[63]!==r||k[64]!==l||k[65]!==B||k[66]!==g||k[67]!==b||k[68]!==z||k[69]!==u||k[70]!==f?(H=(o?!p&&!r&&!s:!0)&&!l&&!t&&!v&&!q&&!b.isUnsent&&!a&&!d("MAWMsg").isPlaceholder(b)&&!y&&(z||c("gkx")("13103"))&&(!m||m&&(c("gkx")("461")||c("gkx")("13103")))&&!f&&(h||(h=d("I64"))).gt(b.authorityLevel,(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC))&&(e!=null&&(h||(h=d("I64"))).equal(e.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))&&(e.attachmentCta1Id!=null||e.attachmentCta2Id!=null||e.attachmentCta3Id!=null||e.defaultCtaId!=null)?e.isSharable:!0)&&(g==null||!g.hasMissingMessages&&!g.hasMissingMedia)&&!A.hasActiveMsgrFamilyCenterEnforcement&&!B&&!u&&!G&&!C&&!D&&!E&&!F&&!n,k[46]=e,k[47]=A,k[48]=a,k[49]=t,k[50]=m,k[51]=y,k[52]=p,k[53]=n,k[54]=G,k[55]=q,k[56]=s,k[57]=v,k[58]=D,k[59]=E,k[60]=C,k[61]=F,k[62]=o,k[63]=r,k[64]=l,k[65]=B,k[66]=g,k[67]=b,k[68]=z,k[69]=u,k[70]=f,k[71]=H):H=k[71];e=H;A=(w||c("gkx")("13103")&&x)&&e&&!j;k[72]!==e||k[73]!==A?(a={hasForwardAction:e,shouldShowForwardAction:A},k[72]=e,k[73]=A,k[74]=a):a=k[74];return a}g["default"]=a}),98);
__d("useMWPIsMessagePinned",["ReQL","ReQLSuspense","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||d("react")).useDeferredValue;function a(a){var b=d("react-compiler-runtime").c(8),e=(h||(h=c("useReStore")))(),g,i;b[0]!==e||b[1]!==a?(g=function(){return a!=null?d("ReQL").fromTableAscending(e.tables.msg_pinned_messages_v2).getKeyRange(a.threadKey,a.messageId):d("ReQL").empty()},i=[e,a],b[0]=e,b[1]=a,b[2]=g,b[3]=i):(g=b[2],i=b[3]);g=!!d("ReQLSuspense").useFirst(g,i,f.id+":28");var k;b[4]!==e||b[5]!==a?(i=function(){return a!=null&&!a.isUnsent?d("ReQL").fromTableAscending(e.tables.client_web_pinned_messages).getKeyRange(a.threadKey,a.offlineThreadingId):d("ReQL").empty()},k=[e,a],b[4]=e,b[5]=a,b[6]=i,b[7]=k):(i=b[6],k=b[7]);b=!!d("ReQLSuspense").useFirst(i,k,f.id+":38");return j(g||b)}g["default"]=a}),98);
__d("useMWV2ForwardMessage",["$InternalEnum","CometRelay","FBLogger","I64","Int64Hooks","LSIntEnum","LSMessagingThreadTypeUtil","MAWDbMsg","MAWExternalId","MAWMessageSendReporterV2","MAWThreadId","MAWVault","MAWVerifyThreadCutover","MWChatMessageId","MWChatThreadId","MWLSForwardMessage","MWPActor.react","MWSharedMsgLogUtils","MWSharedS2SBaseAnnotations","MWUnvaultedText","ReQL","ReQLSuspense","WAResultOrError","cr:19816","cr:19893","cr:19894","cr:9759","gkx","promiseDone","react","react-compiler-runtime","sendToSentQPLLogger","useGetForwardSource","useIsSecureMessage","useLSMessagingSource","useReStore","useStringWithSubstitutions"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;(i||d("react")).useMemo;function l(a,b,c){var e;return(e=d("ReQL")).firstAsync(e.mergeJoin(e.fromTableAscending(a.tables.participants).getKeyRange(b),e.fromTableAscending(a.tables.contacts)).filter(function(a){a[0];a=a[1];return!(k||(k=d("I64"))).equal(a.id,c)}))}function m(a,b,c){var e=d("react-compiler-runtime").c(20),g=b.messageId,h=b.threadKey;e[0]!==a.tables.attachments||e[1]!==g||e[2]!==h?(b=function(){return d("ReQL").fromTableAscending(a.tables.attachments).getKeyRange(h,g)},e[0]=a.tables.attachments,e[1]=g,e[2]=h,e[3]=b):b=e[3];var i;e[4]!==a||e[5]!==g||e[6]!==h?(i=[a,g,h],e[4]=a,e[5]=g,e[6]=h,e[7]=i):i=e[7];b=d("ReQLSuspense").useArray(b,i,f.id+":94");e[8]!==c||e[9]!==a.tables.attachments||e[10]!==g||e[11]!==h?(i=function(){return c!=null?d("ReQL").fromTableAscending(a.tables.attachments).getKeyRange(h,g,c):d("ReQL").empty()},e[8]=c,e[9]=a.tables.attachments,e[10]=g,e[11]=h,e[12]=i):i=e[12];var j;e[13]!==c||e[14]!==a||e[15]!==g||e[16]!==h?(j=[c,a,g,h],e[13]=c,e[14]=a,e[15]=g,e[16]=h,e[17]=j):j=e[17];i=d("ReQLSuspense").useFirst(i,j,f.id+":103");j=b.length>0?b[0]:void 0;if(c!=null){i=(i=i)!=null?i:j;e[18]!==i?(j=i!=null?[i]:[],e[18]=i,e[19]=j):j=e[19];return j}return b}function n(){var a=(h||(h=c("useReStore")))();return d("Int64Hooks").useCallbackInt64(async function(e,f,g,h,i,j,k,m,n){var p=d("MWChatThreadId").toThreadKey(i),q=d("MWChatThreadId").getMessagingThreadType(i);i=await d("MAWVerifyThreadCutover").verifyThreadCutover(Promise.resolve(a),p);var r=await Promise.all([d("MAWThreadId").isSecureThreadKey(a.tables,p),d("MAWThreadId").getThread(a.tables,p),l(a,p,g)]),s=r[0],t=r[1];r=r[2];s=s||i;try{if(b("cr:19893")!=null&&!s){d("sendToSentQPLLogger").addSendToSentAnnotations(j,{string:{forward_type:o.SecureToOpen}});m!=null?await Promise.allSettled([m.messagesAndAttachments.map(function(c){return b("cr:19893").forwardMessage(a,p,q,c.message,h,(c=c.attachment)!=null?c:void 0,g,k)})]):await b("cr:19893").forwardMessage(a,p,q,e,h,f[0],g,k,n);d("sendToSentQPLLogger").markSendToSentSuccess(j);return[d("WAResultOrError").makeResult({description:"open message",messageType:"fixMe"})]}i=d("MAWDbMsg").toMsgId(e.messageId);if(i==null)throw c("FBLogger")("messenger_web_sharing").mustfixThrow("Message does not have an id");if(b("cr:19816")!=null){d("sendToSentQPLLogger").addSendToSentAnnotations(j,{string:{forward_type:o.SecureToSecure}});if(m!=null){s=m.messagesAndAttachments.map(function(a){return d("MAWDbMsg").toMsgId(a.message.messageId)}).filter(Boolean);f=await b("cr:19816").forwardMessageBatch(a,p,s,k,j)}else f=await b("cr:19816").forwardMessage(a,p,i,k,j,n!=null?d("MAWVault").vault(n):void 0).then(function(a){return[a]});b("cr:9759")!=null&&t!=null&&await b("cr:9759")(a,t,r,d("LSMessagingThreadTypeUtil").isOneToOne(t.threadType));return f!=null?f:[d("WAResultOrError").makeResult({description:"removal pending rollout of Message Send Reporter V2",messageType:"fixMe"})]}throw c("FBLogger")("messenger_web_sharing").mustfixThrow("We won't reach to this step, if you are in QE, you should use secure forward")}catch(a){d("MAWMessageSendReporterV2").isMessageSendReporterV2Enabled()||d("sendToSentQPLLogger").markSendToSentFail(j,"failed_forwarding_message",a);c("FBLogger")("messenger_web").catching(a).mustfix("MW Fail forwarding a message");throw a}},[a])}var o=b("$InternalEnum")({SecureToOpen:"secure_to_open",OpenToOpen:"open_to_open",SecureToSecure:"secure_to_secure",OpenToSecure:"open_to_secure"});function a(a,e,f,g){var i=d("react-compiler-runtime").c(45),q=(h||(h=c("useReStore")))(),r=m(q,a,f),s;i[0]!==e?(s={fallbackThreadType:e},i[0]=e,i[1]=s):s=i[1];var t=c("useIsSecureMessage")(q,a,s),u=d("MWPActor.react").useActor(),v=!(k||(k=d("I64"))).equal(u,a.senderId),w=d("MWLSForwardMessage").useForwardMessage(),x=d("MWLSForwardMessage").useForwardAttachment(),y=c("useGetForwardSource")();i[2]!==a.messageId||i[3]!==a.threadKey||i[4]!==a.timestampMs?(e=d("MWChatMessageId").makeSent((k||(k=d("I64"))).to_string(a.threadKey),a.messageId,k.to_string(a.timestampMs)),i[2]=a.messageId,i[3]=a.threadKey,i[4]=a.timestampMs,i[5]=e):e=i[5];var z=e,A=d("CometRelay").useRelayEnvironment(),B=n();i[6]!==a.displayedContentTypes?(s=d("MWSharedMsgLogUtils").getMessageTypeFromDisplayedContentType(a.displayedContentTypes),i[6]=a.displayedContentTypes,i[7]=s):s=i[7];var C=s,D=c("useLSMessagingSource")();if(i[8]!==a.mentionIds){e=new Set((s=(e=a.mentionIds)==null?void 0:e.split==null?void 0:e.split(","))!=null?s:[]);i[8]=a.mentionIds;i[9]=e}else e=i[9];s=e;e=s;var E=e.size>0;s=d("MWUnvaultedText").useMWUnvaultedText(!1,a.text);e=(e=d("useStringWithSubstitutions").useStringWithMentionSubstitutionsAndUpdatedRanges(t?s:null,[],e,a.threadKey))!=null?e:{textWithSubstitutions:s};var F=e.textWithSubstitutions;i[10]!==r||i[11]!==q||i[12]!==E||i[13]!==v||i[14]!==D||i[15]!==g||i[16]!==a||i[17]!==C||i[18]!==B||i[19]!==u||i[20]!==y||i[21]!==F?(s=async function(b){var e=d("MWChatThreadId").toThreadKey(b);e=await d("MAWThreadId").getThread(q.tables,e);var f=function(d){return B(a,r,u,v,b,d,y,g,E&&c("gkx")("7846")?F:void 0)};if(d("MAWMessageSendReporterV2").isMessageSendReporterV2Enabled())await d("MAWMessageSendReporterV2").MAWMessageSendReporterV2({composerEntrypoint:"useMWV2ForwardMessage",extraAnnotations:{string:{attachment_type:"forward",message_type:C}},lsSource:D,messageTypeParamsArgs:{isForward:!0,mediaGroupInfo:g},thread:e},f,q);else{e=d("sendToSentQPLLogger").markSendToSentStartWithAnnotation(e,{isForward:!0,mediaGroupInfo:g},(j||(j=d("LSIntEnum"))).unwrapIntEnum(y),{string:{attachment_type:"forward",message_type:C}});await f(e)}},e=[q,u,D,g,y,B,a,r,v,C,F,E],i[10]=r,i[11]=q,i[12]=E,i[13]=v,i[14]=D,i[15]=g,i[16]=a,i[17]=C,i[18]=B,i[19]=u,i[20]=y,i[21]=F,i[22]=s,i[23]=e):(s=i[22],e=i[23]);var G=d("Int64Hooks").useCallbackInt64(s,e);i[24]!==f||i[25]!==r||i[26]!==q||i[27]!==x||i[28]!==w||i[29]!==v||i[30]!==D||i[31]!==g||i[32]!==a||i[33]!==C||i[34]!==z||i[35]!==A||i[36]!==u||i[37]!==y?(s=async function(e){var h=d("MWChatThreadId").toThreadKey(e),i=d("MWChatThreadId").getMessagingThreadType(e),k=await Promise.all([d("MAWThreadId").isSecureThreadKey(q.tables,h),d("MAWThreadId").getThread(q.tables,h),l(q,h,u),d("MAWVerifyThreadCutover").verifyThreadCutover(Promise.resolve(q),h),d("MAWThreadId").getThread(q.tables,h)]),m=k[0],n=k[1],s=k[2],t=k[3],B=k[4];k=m||t;var E=function(a){var b=d("sendToSentQPLLogger").markSendToSentStart();if(B!=null){var e=d("MWSharedS2SBaseAnnotations").getMessageTypeParams({isForward:!0,threadType:B.threadType});c("promiseDone")(d("MWSharedMsgLogUtils").getSendToSentAnnotations(B,e,(j||(j=d("LSIntEnum"))).unwrapIntEnum(y),void 0,a),function(a){a.string=babelHelpers.extends({},a.string,{attachment_type:"forward",message_type:C}),d("sendToSentQPLLogger").addSendToSentAnnotations(b,a)})}d("sendToSentQPLLogger").addSendToSentAnnotations(b,{string:{forward_type:o.OpenToSecure,message_type:C}});return b};if(b("cr:19894")!=null&&k){var F=function(c,d){return function(e){return b("cr:19894").forwardMessage(A,q,h,a,v,d,y,(e=e)!=null?e:void 0,c).then(p)}};if(r.length===0){m=d("MAWExternalId").generateExternalId();if(d("MAWMessageSendReporterV2").isMessageSendReporterV2Enabled())c("promiseDone")(d("MAWMessageSendReporterV2").MAWMessageSendReporterV2({composerEntrypoint:"useMWV2ForwardMessage",externalId:m,extraAnnotations:{string:{attachment_type:"forward",forward_type:o.OpenToSecure,message_type:C}},lsSource:D,messageTypeParamsArgs:{isForward:!0,mediaGroupInfo:g},thread:B},F(m,void 0),q));else{t=E(m);await F(m,void 0)(t);d("sendToSentQPLLogger").markSendToSentSuccess(t)}}else await Promise.all(r.map(async function(a){var b=d("MAWExternalId").generateExternalId();if(d("MAWMessageSendReporterV2").isMessageSendReporterV2Enabled())await d("MAWMessageSendReporterV2").MAWMessageSendReporterV2({composerEntrypoint:"useMWV2ForwardMessage",externalId:b,extraAnnotations:{string:{attachment_type:"forward",forward_type:o.OpenToSecure,message_type:C}},lsSource:D,messageTypeParamsArgs:{isForward:!0,mediaGroupInfo:g},thread:B},F(b,a),q);else{var e=E(b);try{await F(b,a)(e),d("sendToSentQPLLogger").markSendToSentSuccess(e)}catch(a){b=a;d("sendToSentQPLLogger").markSendToSentFail(e,"failed_forwarding_message",b);c("FBLogger")("messenger_web").catching(b).mustfix("MW Fail forwarding a message");throw b}}}));b("cr:9759")!=null&&n!=null&&b("cr:9759")(q,n,s,d("LSMessagingThreadTypeUtil").isOneToOne(n.threadType))}else if(!k){m=E();try{d("sendToSentQPLLogger").addSendToSentAnnotations(m,{string:{forward_type:o.OpenToOpen,message_type:C}});f==null?w(h,i,z):x(e,f);d("sendToSentQPLLogger").markSendToSentSuccess(m);return}catch(a){t=a;d("sendToSentQPLLogger").markSendToSentFail(m,"failed_forwarding_message",t);c("FBLogger")("messenger_web").catching(t).mustfix("MW Fail forwarding a message");throw t}}},e=[q,u,y,f,A,a,v,g,D,r,w,z,x,C],i[24]=f,i[25]=r,i[26]=q,i[27]=x,i[28]=w,i[29]=v,i[30]=D,i[31]=g,i[32]=a,i[33]=C,i[34]=z,i[35]=A,i[36]=u,i[37]=y,i[38]=s,i[39]=e):(s=i[38],e=i[39]);var H=d("Int64Hooks").useCallbackInt64(s,e);i[40]!==H||i[41]!==G||i[42]!==t?(s=function(){return t?G:H},e=[t,G,H],i[40]=H,i[41]=G,i[42]=t,i[43]=e,i[44]=s):(e=i[43],s=i[44]);return d("Int64Hooks").useMemoInt64(s,e)}function p(a){return[a]}g.ForwardType=o;g.useMWV2ForwardMessage=a}),98);
__d("useMWV2MessageForwardAction",["I64","LSBitFlag","LSIntEnum","MWChatMessageId","MWV2LogMessageClick","MWV2MessageRowIsRowFocusedContext.react","gkx","promiseDone","qex","react","react-compiler-runtime","useMWChatForward","useMWV2ForwardMessage","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");b.useCallback;var l=b.useContext;function a(a,b,e){var f=d("react-compiler-runtime").c(20),g=(h||(h=c("useReStore")))(),k=c("gkx")("20836"),p=!k&&a;k=!k&&c("qex")._("564")===!0;p=p?k?"cross_transport":"secure":k?"cross_transport":"open_";f[0]!==b.messageId||f[1]!==b.threadKey||f[2]!==b.timestampMs?(k=d("MWChatMessageId").makeSent((i||(i=d("I64"))).to_string(b.threadKey),b.messageId,i.to_string(b.timestampMs)),f[0]=b.messageId,f[1]=b.threadKey,f[2]=b.timestampMs,f[3]=k):k=f[3];k=k;var q=d("useMWV2ForwardMessage").useMWV2ForwardMessage(b,e);e=l(d("MWV2MessageRowIsRowFocusedContext.react").context);var r=e.setFocused,s=e.setIsDialogOpened;e=b.stickerId;a=!a;e=d("LSBitFlag").has((j||(j=d("LSIntEnum"))).ofNumber(1),b.displayedContentTypes)&&!b.textHasLinks||d("LSBitFlag").has((j||(j=d("LSIntEnum"))).ofNumber(16384),b.displayedContentTypes)||d("LSBitFlag").has((j||(j=d("LSIntEnum"))).ofNumber(2),b.displayedContentTypes)||d("LSBitFlag").has((j||(j=d("LSIntEnum"))).ofNumber(4),b.displayedContentTypes)||d("LSBitFlag").has((j||(j=d("LSIntEnum"))).ofNumber(512),b.displayedContentTypes)||d("LSBitFlag").has((j||(j=d("LSIntEnum"))).ofNumber(1024),b.displayedContentTypes)||e!=null&&(i||(i=d("I64"))).equal(e,(i||(i=d("I64"))).of_string("369239263222822"))||e!=null&&(i||(i=d("I64"))).equal(e,(i||(i=d("I64"))).of_string("369239343222814"))||e!=null&&(i||(i=d("I64"))).equal(e,(i||(i=d("I64"))).of_string("369239383222810"));a=a&&!e;f[4]!==r||f[5]!==s?(e=function(){s(o),r(n)},f[4]=r,f[5]=s,f[6]=e):e=f[6];e=e;var t;f[7]!==q?(t=function(a){return c("promiseDone")(q(a))},f[7]=q,f[8]=t):t=f[8];t=t;var u;f[9]!==p||f[10]!==k||f[11]!==a||f[12]!==e||f[13]!==t?(u={dropToggle:a,forwardDialogType:p,messageID:k,onClose:e,onSend:t},f[9]=p,f[10]=k,f[11]=a,f[12]=e,f[13]=t,f[14]=u):u=f[14];var v=c("useMWChatForward")(u);f[15]!==g||f[16]!==v||f[17]!==b||f[18]!==s?(p=function(){d("MWV2LogMessageClick").log(g,b,44),v!=null&&(s(m),v.onClick())},f[15]=g,f[16]=v,f[17]=b,f[18]=s,f[19]=p):p=f[19];return p}function m(){return!0}function n(){return!0}function o(){return!1}g["default"]=a}),98);
__d("useMWV2ShouldDisableReactions.react",["LSMessagingThreadTypeUtil","ReQL","ReQLSuspense","isFeatureLimitEnabled","react-compiler-runtime","useIsReactionsV2Enabled","useIsReadOnlyFeatureLimitedWithThreadType","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=d("react-compiler-runtime").c(9),g;e[0]!==a?(g=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a),e[0]=a,e[1]=g):g=e[1];g=g;a=c("useIsReadOnlyFeatureLimitedWithThreadType")(a);var i;e[2]!==a||e[3]!==g?(i=(!g||c("isFeatureLimitEnabled")())&&a,e[2]=a,e[3]=g,e[4]=i):i=e[4];a=i;g=d("useIsReactionsV2Enabled").useIsReactionsV2Enabled(b);var j=(h||(h=c("useReStore")))();e[5]!==j.tables.reaction_v2_types?(i=function(){return d("ReQL").fromTableAscending(j.tables.reaction_v2_types)},e[5]=j.tables.reaction_v2_types,e[6]=i):i=e[6];e[7]!==j?(b=[j],e[7]=j,e[8]=b):b=e[8];e=d("ReQLSuspense").useFirst(i,b,f.id+":38")!=null;return a||g&&!e}g["default"]=a}),98);
__d("useSharedNUX",["CometNUXManagerContext","react","react-compiler-runtime","recoverableViolation","useNUXLoggers","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.useEffect,k=b.useState;function a(a){var b=d("react-compiler-runtime").c(9),e;b[0]!==a?(e=function(){return a},b[0]=a,b[1]=e):e=b[1];var f=c("useStable")(e);if(f!==a){c("recoverableViolation")("Error nux changed at runtime from "+((e=f)!=null?e:"null")+" to "+((e=a)!=null?e:"null")+", this is not supported and will lead to erratic behavior, we have continued to use your initially supplied nux","comet_ui")}e=k(!1);var g=e[0],h=e[1];e=i(c("CometNUXManagerContext"));var l=e.registerNUX;e=e.removeNUX;var m,n;b[2]!==f||b[3]!==l?(m=function(){if(f==null)return;return l(f,h,!0)},n=[f,l],b[2]=f,b[3]=l,b[4]=m,b[5]=n):(m=b[4],n=b[5]);j(m,n);m=c("useNUXLoggers")(f,e);b[6]!==g||b[7]!==m?(n=[g,m],b[6]=g,b[7]=m,b[8]=n):n=b[8];return n}g["default"]=a}),98);