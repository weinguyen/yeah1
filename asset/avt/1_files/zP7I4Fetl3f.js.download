;/*FB_PKG_DELIM*/

__d("CometLinkSharingContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b={getWrappedShareUrlID:function(a){return null},shareSheetSurface:null,wrappedShareUrl:""};c=a.createContext(b);e=c;g["default"]=e}),98);
__d("CometMessengerReshareContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b={LSResults:[],addSelectedTarget:function(a){},addSelectedThreadData:function(a){},getXMAFileArgsPromise:function(){return null},getXMAPreviewPromise:function(){return null},removeSelectedTargetID:function(a){},selectedContacts:new Map(),selectedTargets:new Map(),setXMADataPromise:function(a){}};c=a.createContext(b);e=c;g["default"]=e}),98);
__d("CometUnifiedShareSheetGating",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("24315")}function b(){return c("gkx")("24317")}function d(){return c("gkx")("8866")}g.shouldEnableE2EEDebugIndicator=a;g.shouldDisableMessengerListRanking=b;g.shouldEnablePSLoggingIntentFixes=d}),98);
__d("MAWBumpThread",["ODS","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a){a.description;var b=a.lastActivityTs,c=a.lastMessageCtaType,e=a.lastReadTs,f=a.snippet,g=a.snippetSenderContactId,i=a.threadKey;a=a.txn;i=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(i));if(i==null)return(h||(h=d("ODS"))).bumpEntityKey(3185,"armadillo_thread_bump","missing_thread");f=(f=f)!=null?f:i.snippet;g=(g=g)!=null?g:i.snippetSenderContactId;c=babelHelpers.extends({},i,{lastActivityTimestampMs:(b=b)!=null?b:i.lastActivityTimestampMs,lastMessageCtaType:c,lastReadWatermarkTimestampMs:(b=e)!=null?b:i.lastReadWatermarkTimestampMs,snippet:f,snippetSenderContactId:g});await a.threads.put(c)}g.threadMutation_DEPRECATED=a}),98);
__d("MAWCreateOptimisticSecureMessage",["EntMessageReplyType","I64","LSAuthorityLevel","LSIntEnum","LSMessageReplySourceType","LSMessageReplySourceTypeV2","LSMessageSendStatus","LSQuickReplyType","LSReplyMessageAttachmentType","LSReplyMessageStatus","MAWBridgeBuildMsg","MAWMsgReplySnippet","MessagingAttachmentType","QPLUserFlow","ReQL","isMWBumpMessage","qpl","sendToSentQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i;async function j(a,b,e,f){if(e==null)return[void 0,void 0];var g=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages).getKeyRange(b,e.timestampMs,e.messageId));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"get_reply_msg_end",{instanceKey:f});a=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.attachments).getKeyRange(b,e.messageId));c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"get_reply_attachment_end",{instanceKey:f});return[g,a]}async function k(a,b){a=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.contacts).getKeyRange(b));return a==null?void 0:a.firstName}async function l(a,b,e,f){if(b==null)return;var g=c("isMWBumpMessage")(b.replyType)&&b.replyToUserId!=null?b.replyToUserId:b.senderId;a=await k(a,g);return(f=d("MAWMsgReplySnippet").buildLocalizedReplySnippet({isAuthorMe:!0,isBumpMsg:f,isDeletedMsg:b.replyStatus===c("LSReplyMessageStatus").DELETED,recipientName:a,replySenderIsMe:(h||(h=d("I64"))).equal(g,e)}))==null?void 0:f.toString()}function m(a){if(a==null)return;var b=a.attachmentType;return(h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER))?a.previewUrl:void 0}function n(a){if(a!=null){if((h||(h=d("I64"))).equal(a==null?void 0:a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)))return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").PHOTO);if((h||(h=d("I64"))).equal(a==null?void 0:a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER)))return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").STICKER);if((h||(h=d("I64"))).equal(a==null?void 0:a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").VIDEO);if((h||(h=d("I64"))).equal(a==null?void 0:a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").GIF);return(h||(h=d("I64"))).equal(a==null?void 0:a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))||(h||(h=d("I64"))).equal(a==null?void 0:a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))?(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").EPHEMERAL_RAVEN_MESSAGE):(i||(i=d("LSIntEnum"))).ofNumber(c("LSReplyMessageAttachmentType").OTHER)}}async function a(a,b,e,f,g,h,k,o,p,q,r,s,t,u){var v=await d("sendToSentQPLLogger").measureSendToSentPerformance("optimistic_message_get_reply",o,function(){return j(b,h,f,o)}),w=v[0];v=v[1];g=d("MAWBridgeBuildMsg").buildOptimisticMessage(g,w,p,t);p=await d("sendToSentQPLLogger").measureSendToSentPerformance("optimistic_message_reply_snippet",o,function(){return l(a,w,e,u===!0)});t=babelHelpers.extends({},g,{authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),displayedContentTypes:i.ofNumber(s),hasQuickReplies:!1,hotEmojiSize:k,isAdminMessage:!1,isCollapsed:!1,isUnsent:!1,messageId:q,offlineThreadingId:q,primarySortKey:r,quickReplyType:i.ofNumber(c("LSQuickReplyType").NONE),replyAttachmentType:n(v),replyMediaPreviewHeight:v==null?void 0:v.previewHeight,replyMediaPreviewWidth:v==null?void 0:v.previewWidth,replyMediaUrl:m(v),replyMediaUrlMimeType:v==null?void 0:v.playableUrlMimeType,replySnippet:p,replySourceId:f==null?void 0:f.messageId,replySourceType:f!=null?(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceType").MESSAGE):void 0,replySourceTypeV2:f!=null?(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageReplySourceTypeV2").MESSAGE):void 0,replyType:u===!0?(i||(i=d("LSIntEnum"))).ofNumber(c("EntMessageReplyType").BUMP):void 0,senderId:e,sendStatus:i.ofNumber(c("LSMessageSendStatus").SENDING_TO_SERVER),sendStatusV2:i.ofNumber(1),textHasLinks:!1,threadKey:h,timestampMs:r,transportKey:"WhatsApp",viewFlags:i.ofNumber(0)});return t}g.buildOptimisticLsMessage=a}),98);
__d("MAWOptimisticMessageUtils",["I64","LSAuthorityLevel","LSHotEmojiSize","LSIntEnum","MAWAckLevel","MAWAdminMsg","MAWBridgeBuildMsgMentions","MAWBumpThread","MAWLocalizationType","MAWMsgType","MAWThreadUpdateMiddlewareGatingUtil","MessagingAttachmentType","ReQL","WAJids","WATimeUtils","cr:2472"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(){return d("WATimeUtils").millisTime()}async function j(a,b){a=await d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.threads.index("lastActivityTimestampMs")));return a==null||(h||(h=d("I64"))).equal(a.threadKey,b)?null:(h||(h=d("I64"))).add(a.lastActivityTimestampMs,h.one)}async function e(a,e){var f=e.hotEmojiSize,g=e.mentionedJids,l=e.messageText,m=e.senderId;e=e.threadKey;l=b("cr:2472")==null?l:b("cr:2472").unvault(l);f=f!=null&&(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").SMALL))&&l==="\ud83d\udc4d";f=f?"(Y)":k(l,g);l=!d("MAWThreadUpdateMiddlewareGatingUtil").isMAWCacheServiceEnabled();g=l?d("MAWAdminMsg").buildLocalizedString([f],[],d("MAWLocalizationType").CURRENT_USER_SEND_TEXT):void 0;f=await j(a,e);await d("MAWBumpThread").threadMutation_DEPRECATED({description:"MAWOptimisticMessageUtils",lastActivityTs:f,lastReadTs:f,snippet:g,snippetSenderContactId:l?m:void 0,threadKey:e,txn:a})}function k(a,b){b=d("MAWBridgeBuildMsgMentions").buildThreadSnippetWithMentions(a,b,[],d("MAWLocalizationType").CURRENT_USER_SEND_TEXT);var c=b[0];b[1];return(b=c)!=null?b:a}async function f(a,b){var c=b.optimisticMediaAttachment,e=b.senderId;b=b.threadKey;c=o(c.type);if(c!=null){var f=await j(a,b);await d("MAWBumpThread").threadMutation_DEPRECATED({description:"MAWCreateOptimisticSecureMessageWithAttachment",lastActivityTs:f,lastReadTs:f,snippet:c,snippetSenderContactId:e,threadKey:b,txn:a})}}function l(a){var b=a.ephemeralSettings,c=a.externalId,e=a.threadJid;a=a.ts;return{ack:d("MAWAckLevel").ACK.partialOptimistic,altIndex:void 0,author:d("WAJids").AUTHOR_ME,ephemeralSetting:(b=b)!=null?b:void 0,externalId:c,isForwarded:!1,specialTextSize:void 0,threadJid:e,ts:d("WATimeUtils").castMilliSecondsToUnixTime(a)}}function m(a){var b=a.commands,c=a.content,d=a.initiatingSource,e=a.isFirstMsg,f=a.mentionedJids,g=a.optimisticMsg,h=a.quote,i=a.specialTextSize;a=a.threadSource;return{commands:b==null?void 0:b.slice(),content:c,initiatingSource:d,isFirstMsg:e,isForwarded:!1,mentionedJids:f==null?void 0:f.slice(),openMessageOtid:void 0,openMessageParticipantCount:void 0,optimisticMsg:g,participantCount:void 0,quote:h,source:a,specialTextSize:i}}function n(a){var b=a.optimisticMediaAttachment,e=a.threadKey,f=a.timestampMsI64;e={actionUrl:a.actionUrl,attachmentFbid:a.offlineAttachmentId,attachmentIndex:(h||(h=d("I64"))).zero,attachmentType:a.attachmentType,authorityLevel:(i||(i=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").OPTIMISTIC),filename:b==null?void 0:b.filename,hasMedia:!h.equal(a.attachmentType,i.ofNumber(c("MessagingAttachmentType").XMA)),hasXma:h.equal(a.attachmentType,i.ofNumber(c("MessagingAttachmentType").XMA)),isHd:a.isHd,isSharable:!1,messageId:a.messageExternalId,offlineAttachmentId:a.offlineAttachmentId,receiverFetchId:a.contentRef,subtitleText:a.subtitleText,threadKey:e,timestampMs:f,titleText:a.titleText,transportKey:"WhatsApp",xmaContentType:a.xmaContentType};if(b){e=babelHelpers.extends({},e,{filesize:(h||(h=d("I64"))).of_float(b.file.size),previewUrl:b.url});if(b.type==="image"||b.type==="animated_image"||b.type==="video"||b.type==="sticker"){e=babelHelpers.extends({},e,{previewHeight:((f=b.thumbnailSpec)==null?void 0:f.height)?(h||(h=d("I64"))).of_float((a=b.thumbnailSpec)==null?void 0:a.height):void 0,previewWidth:((f=b.thumbnailSpec)==null?void 0:f.width)?(h||(h=d("I64"))).of_float((a=b.thumbnailSpec)==null?void 0:a.width):void 0})}}return e}function o(a){switch(a){case"animated_image":return d("MAWAdminMsg").buildLocalizedString([],[],d("MAWLocalizationType").CURRENT_USER_SEND_GIF);case"image":return d("MAWAdminMsg").buildLocalizedString([],[],d("MAWLocalizationType").CURRENT_USER_SEND_IMAGE);case"video":return d("MAWAdminMsg").buildLocalizedString([],[],d("MAWLocalizationType").CURRENT_USER_SEND_VIDEO);case"audio":return d("MAWAdminMsg").buildLocalizedString([],[],d("MAWLocalizationType").CURRENT_USER_SEND_AUDIO);case"document":return d("MAWAdminMsg").buildLocalizedString([],[],d("MAWLocalizationType").CURRENT_USER_SEND_ATTACHMENT);case"sticker":return d("MAWAdminMsg").buildLocalizedString([],[],d("MAWLocalizationType").CURRENT_USER_SEND_STICKER);default:return null}}function p(a){switch(a){case(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").STICKER):return d("MAWMsgType").MSG_TYPE.STICKER;case(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE):return d("MAWMsgType").MSG_TYPE.IMAGE;case(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE):return d("MAWMsgType").MSG_TYPE.GIF;case(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO):return d("MAWMsgType").MSG_TYPE.VIDEO;case(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").AUDIO):return d("MAWMsgType").MSG_TYPE.PTT;default:return d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE}}function q(a){if(a==null)return;if((h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").SMALL)))return 1;if((h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").MEDIUM)))return 2;if((h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSHotEmojiSize").LARGE)))return 3}g.getOptimisticMessageTimestamp=a;g.getOptimisticThreadBumpTimestamp=j;g.optimisticBumpThread=e;g.optimisticBumpThreadMedia=f;g.buildMAWOptimisticBaseMsg=l;g.buildMAWBaseSendMsgArgs=m;g.buildOptimisticAttachment=n;g.lsAttachmentTypeToMsgType=p;g.getSpecialTextSize=q}),98);
__d("MAWShareAttachmentDeferred",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a=c("JSResourceForInteraction")("MAWShareAttachment").__setRef("MAWShareAttachmentDeferred");b=a;g["default"]=b}),98);
__d("MessengerIntent",["WebStorage","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i="mw_sent_message";function j(){return c("justknobx")._("1630")}function a(){(h||(h=c("WebStorage"))).setItemGuarded(h.getLocalStorage(),i,String(Date.now()))}function b(){var a=(h||(h=c("WebStorage"))).getLocalStorage();return Date.now()-Number(a==null?void 0:a.getItem(i))<j()}g.sentMessage=a;g.hasSentMessagesRecently=b}),98);
__d("MWLSLogSend",["CometHeroLogging","I64","MWChatInteraction","MWSharedS2SBaseAnnotations","MessengerIntent"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e){var f=e.isCommunityEvent,g=e.isMessageRequest,i=e.source;e=e.threadType;var j=c("CometHeroLogging").genHeroInteractionUUIDAndMarkStart(a.getTraceId());d("MWChatInteraction").set(b,j);j={entrypoint:d("MWSharedS2SBaseAnnotations").getEntrypointAnnotation(i),is_community_event:f===!0?"true":"false",is_message_request:g===!0?"true":"false",thread_type:e==null?"unknown":(h||(h=d("I64"))).to_string(e)};Object.entries(j).forEach(function(b){var c=b[0];b=b[1];a.addMetadata(c,String(b))});d("MessengerIntent").sentMessage();return a.onComplete(function(){delete d("MWChatInteraction").interactions[b]})}g.logSentHeroInteraction=a}),98);
__d("UnifiedShareSheetMultiSelectionContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b={AddSeletectTarget:function(a){},RemoveSelectedTarget:function(a){},getXMAFileArgsPromise:function(){return null},getXMAPreviewPromise:function(){return null},selectedContacts:new Map(),selectedTargets:new Map()};c=a.createContext(b);e=c;g["default"]=e}),98);
__d("UnifiedShareSheetSharingOptionsItemButton.react",["CometColumn.react","CometColumnItem.react","CometLinkSharingContext","CometPlaceholder.react","CometPressable.react","FDSSkittleIcon.react","FDSText.react","UnifiedShareSheetHScrollTilesItemPlaceholder.react","cr:8265","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext,k={button:{borderTopStartRadius:"xhk9q7s",borderTopEndRadius:"x1otrzb0",borderBottomEndRadius:"x1i1ezom",borderBottomStartRadius:"x1o6z2jb",height:"xnfxvih",marginTop:"xdj266r",marginEnd:"x11i5rnm",marginBottom:"xat24cr",marginStart:"x1mh8g0r",width:"x19v3vle",$$css:!0}};function a(a){var e=d("react-compiler-runtime").c(22),f,g,h,l;e[0]!==a?(f=a.icon,g=a.onPress,l=a.text,h=babelHelpers.objectWithoutPropertiesLoose(a,["icon","onPress","text"]),e[0]=a,e[1]=f,e[2]=g,e[3]=h,e[4]=l):(f=e[1],g=e[2],h=e[3],l=e[4]);a=j(c("CometLinkSharingContext"));var m=a.shareSheetSurface,n=a.wrappedShareUrl,o=b("cr:8265")();e[5]===Symbol["for"]("react.memo_cache_sentinel")?(a=i.jsx(c("UnifiedShareSheetHScrollTilesItemPlaceholder.react"),{}),e[5]=a):a=e[5];var p;e[6]!==g||e[7]!==m||e[8]!==o||e[9]!==n?(p=function(){g(),o&&n.includes("/share/")&&o({loggingMetrics:{off_platform_sharing:{entry_point:"AGNOSTIC_UNIFIED_SHARE_SHEET_ENTRYPOINT"}},shareSheetSurface:m,wrappedUrl:n})},e[6]=g,e[7]=m,e[8]=o,e[9]=n,e[10]=p):p=e[10];var q;e[11]!==f?(q=i.jsx(c("CometColumnItem.react"),{align:"center",children:i.jsx(c("FDSSkittleIcon.react"),{color:"gray",icon:f,size:60})}),e[11]=f,e[12]=q):q=e[12];e[13]!==l?(f=i.jsx(c("CometColumnItem.react"),{align:"center",children:i.jsx(c("FDSText.react"),{align:"center",numberOfLines:2,type:"body4",children:l})}),e[13]=l,e[14]=f):f=e[14];e[15]!==q||e[16]!==f?(l=i.jsxs(c("CometColumn.react"),{expanding:!0,paddingVertical:8,spacing:12,children:[q,f]}),e[15]=q,e[16]=f,e[17]=l):l=e[17];e[18]!==h||e[19]!==p||e[20]!==l?(q=i.jsx(c("CometPlaceholder.react"),{fallback:a,children:i.jsx(c("CometPressable.react"),babelHelpers["extends"]({onPress:p,xstyle:k.button},h,{children:l}))}),e[18]=h,e[19]=p,e[20]=l,e[21]=q):q=e[21];return q}g["default"]=a}),98);
__d("useMAWCreateOptimisticSecureMessageWithXMAAttachment",["I64","LSIntEnum","MAWAdminMsg","MAWBumpThread","MAWCreateOptimisticSecureMessage","MAWLocalizationType","MAWOptimisticMessageUtils","MAWSendFileMsgTypes","MAWVault","MWPActor.react","MessagingAttachmentType","QPLUserFlow","qpl","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(){var a=d("react-compiler-runtime").c(3),b=c("useAsyncReStore")(),e=d("MWPActor.react").useActor(),g;a[0]!==b||a[1]!==e?(g=function(a){var d=a.actionUrl,g=a.associatedMsgId,h=a.associatedMsgText,i=a.commands,k=a.contentRef,l=a.instanceKey,m=a.isReceiverFetch,n=a.lssTraceApi,o=a.mentionedJids,p=a.messageExternalId,q=a.messageText,r=a.offlineAttachmentId,s=a.onOfflineMsgId,t=a.optimisticMediaAttachment,u=a.reply,v=a.subtitleText,w=a.threadKey,x=a.titleText,y=a.xmaContentType,z=m===void 0?!1:m;return Promise.resolve(b).then(function(a){c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"before_create_optimistic_message_restore_resolved",{instanceKey:l});return a.runInTransaction(function(b){return j({actionUrl:d,associatedMsgId:g,associatedMsgText:h,commands:i,contentRef:k,db:a,instanceKey:l,isReceiverFetch:z,lssTraceApi:n,mentionedJids:o,messageExternalId:p,messageText:q,offlineAttachmentId:r,onOfflineMsgId:s,optimisticMediaAttachment:t,reply:u,senderId:e,subtitleText:v,threadKey:w,titleText:x,txn:b,xmaContentType:y})},"readwrite","ui",void 0,f.id+":95")})},a[0]=b,a[1]=e,a[2]=g):g=a[2];return g}async function j(a){var b,e=a.actionUrl,f=a.associatedMsgId,g=a.associatedMsgText,j=a.commands,k=a.contentRef,l=a.db,m=a.instanceKey,n=a.isReceiverFetch;n=n===void 0?!1:n;var o=a.lssTraceApi,p=a.mentionedJids,q=a.messageExternalId,r=a.messageText,s=a.offlineAttachmentId,t=a.onOfflineMsgId,u=a.optimisticMediaAttachment,v=a.reply,w=a.senderId,x=a.subtitleText,y=a.threadKey,z=a.titleText,A=a.txn;a=a.xmaContentType;t(q);o==null?void 0:o.addMarkerPoint("set_offline_message_external_id_for_ls_message","AppTiming");t=d("MAWOptimisticMessageUtils").getOptimisticMessageTimestamp();o=(h||(h=d("I64"))).of_float(t);n=n?536870912:1024;b=await d("MAWCreateOptimisticSecureMessage").buildOptimisticLsMessage(l,A,w,v,(b=d("MAWVault").unvault(r))!=null?b:"",y,void 0,m,p,q,o,n,j);await A.messages.add(b);n=d("MAWOptimisticMessageUtils").buildOptimisticAttachment({actionUrl:e,attachmentType:(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA),contentRef:k,messageExternalId:q,offlineAttachmentId:s,optimisticMediaAttachment:u,senderId:w,subtitleText:x,threadKey:y,timestampMsI64:o,titleText:z,xmaContentType:a});await A.attachments.add(n);if(f!=null&&g!=null&&g!==""){e=await d("MAWCreateOptimisticSecureMessage").buildOptimisticLsMessage(l,A,w,v,(b=d("MAWVault").unvault(g))!=null?b:"",y,void 0,m,p,f,o,1,j);await A.messages.add(e)}c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"after_create_optimistic_message",{instanceKey:m});c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"optimistic_bump_thread_start",{instanceKey:m});await d("MAWBumpThread").threadMutation_DEPRECATED({description:"useMAWCreateOptimisticSecureMessageWithXMAAttachment",lastActivityTs:o,lastReadTs:o,snippet:d("MAWAdminMsg").buildLocalizedString([d("MAWVault").unvault(r)],[],d("MAWLocalizationType").CURRENT_USER_SEND_TEXT),snippetSenderContactId:w,threadKey:y,txn:A});c("QPLUserFlow").addPoint(c("qpl")._(25313175,"1551"),"optimistic_bump_thread_end",{instanceKey:m});return{messageExternalId:q,offlineAttachmentId:d("MAWSendFileMsgTypes").toOfflineAttachmentIDFromString(s),offlineMsgTimestamp:t}}g.useMAWCreateOptimisticSecureMessageWithXMAAttachment=a}),98);
__d("useMWSendAttachment",["$InternalEnum","CometMessengerReshareContext","CometRelay","FBLogger","JSResourceForInteraction","LSDatabaseSingleton","LSMessagingThreadAttributionType","MAWMIC","MAWMessageSendReporterV2","MAWStateContext.react","MAWVerifyThreadCutoverDeferred","MWLSLogSend","MWVersion","MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred","UnifiedShareSheetMultiSelectionContext","WAResultOrError","cr:19817","isThreadLevelCutoverEnabled","qex","react","sendToSentQPLLogger","useMAWCreateOptimisticSecureMessageWithXMAAttachment"],(function(a,b,c,d,e,f,g){"use strict";var h,i;f=h||d("react");var j=f.useCallback,k=f.useContext,l=b("$InternalEnum").Mirrored(["USS_H_SCROLL","BCF"]);function m(){if(c("qex")._("564")===!0)return!0;else return c("qex")._("121")===!0}var n=c("JSResourceForInteraction")("LSShareAttachment").__setRef("useMWSendAttachment");function a(){var a=d("CometRelay").useRelayEnvironment(),e=d("useMAWCreateOptimisticSecureMessageWithXMAAttachment").useMAWCreateOptimisticSecureMessageWithXMAAttachment(),f=d("MAWStateContext.react").useDispatchOptimisticSendMessage(),g=k(c("UnifiedShareSheetMultiSelectionContext")),h=g.getXMAFileArgsPromise;g=g.getXMAPreviewPromise;var o=k(c("CometMessengerReshareContext")),p=o.getXMAFileArgsPromise;o=o.getXMAPreviewPromise;var q=(g=(g=g())!=null?g:o())!=null?g:null,r=(g=(o=h())!=null?o:p())!=null?g:null;return j(async function(g){var h=g.attachment,j=g.contactWithCapabilityPromises,k=g.lssTraceApi,o=g.offlineMsgId,p=g.reshareTarget,s=g.s2sInstanceKey,t=g.sharingComponent,u=g.source,v=g.thread,w=g.xmaDataPromise,x=g.xmaDataProps;g=g.xmaMsgExternalId;var y=m(),z=y||c("isThreadLevelCutoverEnabled")();d("sendToSentQPLLogger").markSendToSentPoint(s,"update_target_deferred_component_load_start");var A=await c("MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred").load();d("sendToSentQPLLogger").markSendToSentPoint(s,"update_target_deferred_component_load_end");var B=d("MAWMIC").duringMIC();d("sendToSentQPLLogger").addSendToSentAnnotations(s,{bool:{during_mic:B}});d("sendToSentQPLLogger").markSendToSentPoint(s,"update_target_start");B=await A(p,(i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton,a,"sendAttachment",s,j);d("sendToSentQPLLogger").markSendToSentPoint(s,"update_target_end");A=B.targetID!==h.targetID?babelHelpers.extends({},h,{targetID:B.targetID}):h;d("MWLSLogSend").logSentHeroInteraction(k,o,{isMessageRequest:!1,mwVersion:d("MWVersion").v2,source:(j=u)!=null?j:c("LSMessagingThreadAttributionType").UNKNOWN,threadType:v==null?void 0:v.threadType});d("sendToSentQPLLogger").markSendToSentPoint(s,"offline_msg_id_generated");k.addMarkerPoint("offline_msg_id_generated","AppTiming");j=(h=B.isTargetE2E)!=null?h:y;v=!1;d("sendToSentQPLLogger").markSendToSentPoint(s,"verify_thread_cutover_start");k.addMarkerPoint("verify_thread_cutover_start","AppTiming");if(c("MAWVerifyThreadCutoverDeferred")!=null){d("sendToSentQPLLogger").markSendToSentPoint(s,"verify_cutover_deferred_component_load_start");h=await c("MAWVerifyThreadCutoverDeferred").load();y=h.verifyThreadCutoverWithStringInput;d("sendToSentQPLLogger").markSendToSentPoint(s,"verify_cutover_deferred_component_load_end");v=await y((i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton,B.targetID)}d("sendToSentQPLLogger").markSendToSentPoint(s,"verify_thread_cutover_end");if(z&&j||v){if(b("cr:19817")===null){d("MAWMessageSendReporterV2").isMessageSendReporterV2Enabled()||d("sendToSentQPLLogger").markSendToSentFail(s,"MAWShareAttachmentDeferred_null");k.addMarkerPoint("MAWShareAttachmentDeferred_null","AppTiming");throw c("FBLogger")("messenger_web_media").mustfixThrow("Failed to fetch MAWShareAttachmentDeferred")}d("sendToSentQPLLogger").markSendToSentPoint(s,"share_attachment_deferred_component_load_start");h=await b("cr:19817").load();y=h.shareSecureAttachment;d("sendToSentQPLLogger").markSendToSentPoint(s,"share_attachment_deferred_component_load_end");d("sendToSentQPLLogger").markSendToSentPoint(s,"share_secure_attachment_start");z=t===l.USS_H_SCROLL;j=await y(z?void 0:a,A,B,u,s,"useMWSendAttachment",k,z?x:void 0,w,o,g,e,f,q,r);if((j==null?void 0:j.success)===!1)return d("WAResultOrError").makeError(j.error);else{d("sendToSentQPLLogger").markSendToSentPoint(s,"share_secure_attachment_end");return d("WAResultOrError").makeResult({report:(j==null?void 0:j.value)||{description:"removal pending rollout of Message Send Reporter V2",messageType:"fixMe"},target:B})}}else try{v=await n.load();h=v.share;await h(A,s);return d("WAResultOrError").makeResult({report:{description:"open message",messageType:"fixMe"},target:p})}catch(a){throw a}},[e,f,a])}function e(){return o}function o(){b("cr:19817")==null?void 0:b("cr:19817").preload(),c("MAWVerifyThreadCutoverDeferred")==null?void 0:c("MAWVerifyThreadCutoverDeferred").preload(),c("MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred")==null?void 0:c("MaybeUpdateTargetBasedOnODCutoverOrDefaultE2EEDeferred").preload(),n.preload()}g.SharingComponentType=l;g.useMWSendAttachment=a;g.useMWPreloadSendAttachmentComponents=e}),98);
__d("useCometFeedToMessengerReshareV3PushPage",["CometMessengerResharesDialogPlaceholder.react","CometMessengerResharesUpdatedDialog.entrypoint","LSMessagingThreadAttributionType","react","react-compiler-runtime","useMWSendAttachment","usePushPage","useShareLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useRef;function a(a){var b=d("react-compiler-runtime").c(20),e=a.feedLocation,f=a.feedTracking,g=a.onClose,h=a.shareableID,k=a.sharingComponentName,l=a.storyData,m=a.url;b[0]!==m?(a={url:m},b[0]=m,b[1]=a):a=b[1];a=a;var n=j(null);a=c("usePushPage")(c("CometMessengerResharesUpdatedDialog.entrypoint"),a,"button_aggressive");var o=a[0];a=a[1];var p=a.onHoverIn,q=a.onHoverOut;a=a.onPressIn;var r=c("useShareLogger")(),s=r.onOpenBCFButtonClicked;b[2]!==e||b[3]!==f||b[4]!==g||b[5]!==s||b[6]!==o||b[7]!==h||b[8]!==k||b[9]!==l||b[10]!==m?(r=function(){s({entry_point:e,feed_tracking:f,is_anything_shared_in_current_session:!1,shareable_entity_fbid:h,sharing_component_name:k}),o({feedLocation:e,feedTracking:f,isPushPageView:!0,onClose:g,shareableID:h,source:c("LSMessagingThreadAttributionType").FB_FEED_ORGANIC_POST_VIEW_AND_MESSAGE,storyData:l,url:m},{fallback:i.jsx(c("CometMessengerResharesDialogPlaceholder.react"),{isPushPageView:!0,onClose:g})})},b[2]=e,b[3]=f,b[4]=g,b[5]=s,b[6]=o,b[7]=h,b[8]=k,b[9]=l,b[10]=m,b[11]=r):r=b[11];r=r;var t=d("useMWSendAttachment").useMWPreloadSendAttachmentComponents(),u;b[12]!==p||b[13]!==t?(u=function(a){p(a),t()},b[12]=p,b[13]=t,b[14]=u):u=b[14];u=u;b[15]!==r||b[16]!==u||b[17]!==q||b[18]!==a?(n={onClick:r,onHoverIn:u,onHoverOut:q,onPressIn:a,triggerRef:n},b[15]=r,b[16]=u,b[17]=q,b[18]=a,b[19]=n):n=b[19];return n}g["default"]=a}),98);